---
aliases:
  - שטורם-ליוביל
  - מרחב מכפלה פנימית
  - פיתוח לפי פ"ע
  - טור פורייה מוכלל
  - טור פורייה קלאסי
  - פיתוח פורייה
  - משפט דיריכלה
---
# מבוא
ב[[PDE1_004 משוואת הגלים#משוואת הגלים בתחום סופי|משוואת הגלים בתחום סופי]] ראינו דוגמה לבעיית התחלה-שפה הניתנת לפתרון בעזרת שיטת הפרדת משתנים. נרצה כעת לבסס את השיטה מבחינה תאורטית.
נתבונן בבעיה היפרבולית המתארת תנודת מיתר לא הומוגני. המד"ח היא הכללה של משוואת הגלים:
$$
\begin{aligned}
 & u_{tt}-\dfrac{c^{2}}{r(x)}[(p(x)u_{x})_{x}+q(x)u]=0 &  & a<x<b,\, t>0 \\
 & u(x,0)=f(x)  &  & a\leq x\leq b\\
 & u_{t}(x,0)=g(x)  &  & a\leq x\leq b\\
 & \alpha u(a,t)+\beta u_{x}(a,t)=0 &  & t\geq 0 \\
 & \gamma u(b,t)+\delta u_{x}(b,t)=0 &  & t\geq 0
\end{aligned}
$$
כאשר אנו מניחים שמקדמי המד"ח הם פונקציות ממשיות המקיימות:
$$
\begin{aligned}
 & p,p',q,r\in C([a,b]) \\
 & p(x),r(x)>0,\, \forall x \in [a,b]  \\
 & c>0
\end{aligned}
$$
ובנוסף ש:
$$
\alpha,\beta,\gamma,\delta \in \mathbb{R},\, \quad |\alpha|+|\beta|>0,\, \quad |\gamma|+|\delta|>0
$$

כאמור, תנאי שפה אלו כוללים למשל את [[PDE1_001 הקדמה ומשוואות מסדר ראשון#תנאי שפה|תנאי דיריכלה]]:
$$
\alpha=\gamma=1,\, \quad \beta=\delta=0
$$
וגם את תנאי נוימן:
$$
\alpha=\gamma=0,\, \quad \beta=\delta=1
$$

>[!notes] הערה: 
 >הבעיה הכללית שהוצגה כאן היא *מאוד* כללית וניתן להכליל אותה עוד יותר כדי לכלול את בעיית משוואת החום. מסיבה זו יש כאן המון פרמטרים מבלבלים. אל דאגה, הבעיות הנתונות כאן יהיו יותר פשוטות.
 
כזכור, אנו מחפשים פתרונות מופרדים *לא טריוויאליים* של המשוואה החלקית המקיימים את תנאי השפה ובעלי הצורה:
$$
u(x,t)=X(x)T(t)
$$
כאשר $X$ ו-$T$ הן פונקציות של משתנה אחד, $x$ ו-$t$ בהתאמה. נציב את הפתרון הזה במשוואה, נפריד משתנים, ונקבל:
$$
\dfrac{T''}{c^{2}T}=\dfrac{(pX')'+qX}{rX}
$$
אגף שמאל הוא פונקציה של $t$ בלבד ואילו אגף ימין תלוי אך ורק ב-$x$. לכן, קיים קבוע הפרדה $\lambda$ כך ש:
$$
\dfrac{T''}{c^{2}T}=\dfrac{(pX')'+qX}{rX}=-\lambda
$$
כלומר, יש לנו כאן סדרה משוואות דיפרנציאליות רגילות:
$$
\begin{aligned}
 & (pX')'+qX+\lambda rX=0 &  & a<x<b \\
 & T''+\lambda c^{2}T=0 &  & t>0
\end{aligned}
$$
מכיוון ש-$u$ אינו הפתרון הטריוויאלי, כדי שהפתרון $u$ יקיים את תנאי השפה צריך להתקיים:
$$
\begin{gather}
\alpha X(a)+\beta X'(a)=0 \\
\gamma X(a)+\delta X'(b)=0
\end{gather}
$$
כלומר, על הפונקציה $X$ לפתור את הבעיית שפה (שהיא מד"ר):
$$
\begin{aligned} 
 & (pX')'+qX+\lambda rX=0  & a<x<b \\
&\alpha X(a)+\beta X'(a)=0 &  \\
&\gamma X(a)+\delta X'(b)=0 & 
\end{aligned}
$$
וזוהי דוגמה **לבעיית שטורם-ליוביל רגולרית**. לפני שניגש לבעיה זו, מספר סימונים:
- הפונקציה $r(x)$ נקראת **פונקצית המשקל** של הבעיה.
- האופרטור הדיפרנציאלי $L[v]:=(pv')'+qv$ ייקרא **אופרטור מטיפוס שטורם-ליוביל**.
- ערך של $\lambda$ עבורו קיימים פרונות לא טריוואלים לבעיה ייקרא **ערך עצמי** והפתרון ייקרא **פונקציה עצמית** של אותו ע"ע.
- **הריבוי** של ע"ע הוא ממד המרחב הפונקציות העצמיות המתאימות לו. הריבוי של כל ערך עצמי יכל להיות $1$ או $2$. ע"ע עם ריבוי אחד ייקרא ע"ע פשוט.
- פתרון הבעיה משמעו מציאת כל הע"ע והפ"ע של הבעיה.

## בעיית שטורם-ליוביל רגולרית

>[!def] הגדרה: 
 >**בעיית שטורם-ליוביל רגולרית** היא בעיה מהצורה:
 >$$
> \begin{aligned}
>  & (pv')'+qv+\lambda rv=0 & a<x<b \\
>  & \alpha v(a)+\beta v'(a)=0 \\
>  & \gamma v(b)+\delta v'(b)=0
> \end{aligned}
> $$
> כאשר:
>$$
> \begin{aligned}
>  & p,p',q,r\in C([a,b]) \\
>  & p(x),r(x)>0,\, \forall x \in [a,b]
> \end{aligned}
> $$
> ובנוסף ש:
> $$
> \alpha,\beta,\gamma,\delta \in \mathbb{R},\, \quad |\alpha|+|\beta|>0,\, \quad |\gamma|+|\delta|>0
> $$


>[!example] דוגמה: 
>עבור:
>$$
> p=r=1,\, q=0,\, \quad \quad (a,b)=(0,L)
> $$
>וכאשר $\alpha=\gamma=1,\,\beta=\delta=0$, אנו מקבלים את אותם התנאים על הבעיית שטורם ליוביל בתנאי דיריכלה מ[[PDE1_004 משוואת הגלים#משוואת הגלים בתחום סופי|משוואת הגלים בתחום סופי]]:
>$$
> \begin{aligned}
>  & v''+\lambda v=0 &  & 0<x<L \\
>  & v(0)=v(L)=0
> \end{aligned}
> $$
> הע"ע והפ"ע שנקבל הם:
> $$
> \lambda_{n}=\left( \dfrac{n\pi}{L} \right)^{2},\, \quad v_{n}(x)=\sin\left( \dfrac{n\pi}{L}x \right),\, \quad n\in \mathbb{N}
> $$
>אם $\alpha=\gamma=0,\,\beta=\delta=1$, אז יש לנו תנאי נוימן והבעיה הופכת להיות:
>$$
> \begin{aligned}
>  & v''+\lambda v=0 &  & 0<x<L \\
>  & v'(0)=v'(L)=0
> \end{aligned}
> $$
> הע"ע והפ"ע שנקבל הם:
> $$
> \lambda_{n}=\left( \dfrac{n\pi}{L} \right)^{2},\, \quad v_{n}(x)=\cos\left( \dfrac{n\pi}{L}x \right),\, \quad n\in \mathbb{N} \cup \{ 0 \}
> $$


>[!notes] הערה: 
 >כל הערכים העצמיים של בעיית שטורם-ליוביל רגולרית הם פשוטים (מריבוי $1$).

 
## בעיית שטורם-ליוביל מחזורית
>[!def] הגדרה: 
 >**בעיית שטורם-ליוביל מחזורית** היא בעיה מהצורה:
 >$$
> \begin{aligned}
>  & (pv')'+qv+\lambda rv=0 & a<x<b  \\
>  & v(a)=v(b) \\
>  & v'(a)=v'(b) \\
> \end{aligned}
> $$
> כאשר:
>$$
> \begin{aligned}
>  & p,p',q,r\in C([a,b]) \\
>  & p(x),r(x)>0,\, \forall x \in [a,b] 
> \end{aligned}
> $$
> ומקדמי המשוואה $p,q,r$ הם פונקציות מחזוריות עם מחזור $(b-a)$.
 
>[!example] דוגמה: 
>עבור $L>0$:
>$$
> \begin{aligned}
>  & v''+\lambda v=0  & -L<x<L \\
>  & v(-L)=v(L) \\
>  & v'(-L)=v'(L)
> \end{aligned}
> $$
> הע"ע והפ"ע של הבעיה הם:
>$$
> \lambda_{n}=\left( \dfrac{\pi n}{L} \right)^{2},\, \quad v_{n}(x)=A_{n}\cos\left( \dfrac{\pi n}{L}x \right)+B_{n}\sin\left( \dfrac{n\pi}{L}x \right)
> $$
>במקרה זה, הריבוי של $\lambda=0$ הוא $1$ בעוד שהריבוי של שאר הע"ע הוא $2$.

 
# תכונות הפונקציות העצמיות והערכים העצמיים

לפני שנעבור לתכונות מיוחדות של הפונקציות העצמיות והערכים העצמיים של בעיית שטורם-ליוביל, חשוב שנעבור על פעולת המכפלה הפנימית.

## מרחב מכפלה פנימית
ניזכר ב[[CAL2_001 וקטורים#מכפלה סקלרית פנימית|מכפלה סקלרית]] מחדו"א 2. נרחיב את מושג זה לפונקציות:

>[!def] הגדרה: 
 >[[ALG1_005 מרחבים וקטוריים#מרחב וקטורי|מרחב וקטורי]] $V$ ייקרא **מרחב מכפלה פנימית (ממשי)** אם לכל שני וקטורים קיים מספר $\langle u,v \rangle\in \mathbb{R}$ הנקרא **המכפלה הפנימית** של $u$ ו-$v$, באופן שהתכונות הבאות מתקיימות:
 >1. לכל $u,v\in V$ מתקיים $\langle u,v \rangle=\langle v,u \rangle$.
 >2. לכל $u,v,w\in V$ מתקיים $\langle u+v,w \rangle=\langle u,w \rangle+\langle v,w \rangle$.
 >3. לכל $u,v\in V$ ו-$\alpha \in \mathbb{R}$ מתקיים $\langle \alpha u,v \rangle=\alpha \langle u,v \rangle$.
 >4. לכל $u\in V$ מתקיים $\langle u,v \rangle\geq 0$, יתר על כן, $\langle u,v \rangle>0$ לכל $v\neq 0$.
 
 בהקשר של בעייית שטורם-ליוביל מופיע מרחב מכפלה פנימית טבעי.
עבור פונקציות:
>[!def] הגדרה: 
 >תהי $r(x)$ פונקצית משקל (חיובית) ורציפה בקטע $[a,b]$. עבור $u,v\in E(a,b)$ נגדיר **מכפלה פנימית**:
 >$$
> \langle u,v \rangle_{r}=\int _{a}^{b}u(x)v(x)r(x) \, \mathrm{d}x 
> $$

>[!notes] הערה: 
>  אנו נעסוק רק במכפלה הפנימית הזו, ולא במכפלה פנימית בין וקטורים אוקלידיים.

מרחב המכפלה הפנימית המתקבל יסומן $E_r(a,b)$, ועבור $r=1$ נסמן:
$$
{E}_{1} (a,b)=E(a,b)
$$
באותו אופן:
$$
\langle u,v \rangle_{1}=\langle u,v \rangle
$$

>[!notes] הערה: 
 >גם את המונחים *אורתוגונליות ואורתונורמליות* ניתן להרחיב עבור פונקציות. נאמר כי סדרה של פונקציות $\{ u_{n} \}$ היא **סדרה אורתוגונלית** אם לכל $n$ מתקיים $v_{n}\neq 0$ וכן:
 >$$
> \langle v_{n},v_{m} \rangle=0
> $$
 >לכל $n\neq m$.
 >נאמר כי הסדרה היא **אורתונורמלית** אם:
 >$$
> \langle v_{n},v_{m} \rangle=\begin{cases}
> 0 & m\neq n \\
> 1 & m=n
> \end{cases}
> $$

נוכל כעת להמשיך לתכונות הע"ע והפ"ע של בעיית שטורם-ליוביל.
## סימטריות

>[!info] טענה:
>אופרטור שטורם-ליוביל על פונקציות המקיימות תנאי שפה של בעיית שטורם-ליוביל מקיים:
>$$
> \int_{a}^{b} uL[v]-vL[u] \, \mathrm{d}x =0
> $$

**הוכחה:**
נתבונן באופרטור שטורם ליוביל:
$$
L[u]=(p(x)u')'+q(x)u
$$
ונתבונן בביטוי $uL[v]-vL[u]$ עבור $u,v\in C^{2}([a,b])$. לפי [[CAL1_005 נגזרות#כללי גזירה|נגזרת של מכפלה]]:
$$
\begin{aligned}
uL[v]-vL[u]&=u(pv')'+uqv-v(p u')'-vqu) \\
&=(upv)'-u'pv'-(vpu')'+u'pv'
\end{aligned}
$$
קיבלנו את **זהות לגראנז'**:
$$
uL[v]-vL[u]=[p(uv'-vu')]'
$$
נבצע אינטגרציה על הזהות ונקבל את **נוסחת גרין**:
$$
\int_{a}^{b} uL[v]-vL[u] \, \mathrm{d}x =p(uv'-vu')\bigg|_{a}^{b} 
$$

נניח עתה כי $u$ ו-$v$ מקיימות תנאי השפה של בעיית שטורם ליוביל. קל לראות כי:
$$
\int_{a}^{b}uL[v]-vL[u]  \, \mathrm{d}x=0 
$$

$\blacksquare$

---
הפירוש האלגברי של נוסחה זו הוא שהאופרטור $L$ המוגדר על פונקציות שמקיימות את תנאי השפה של בעיית שטורם ליוביל, הוא סימטרי ביחס למכפלה הפנימית:
$$
\langle u,v \rangle=\int_{a}^{b} u(x)v(x)  \, \mathrm{d}x 
$$

ולכן:
$$
\langle L(u),v \rangle=\langle u,L(v) \rangle
$$

## אורתוגונליות

>[!info] טענה: 
>עבור בעיית שטורם-ליוביל רגולרית או מחזורית, אם $u,v$ פ"ע של אותה הבעיה השייכות לע"ע שונים אז הן אורתוגונליות:
 >$$
> \langle u,v \rangle =0
> $$
 
 **הוכחה:**
 יהיו $v_{n},v_{m}$ פונקציות עצמיות השייכות לערכים העצמיים $\lambda_{n}\neq\lambda_{m}$ בהתאמה. כלומר:
 $$
\begin{aligned}
 & -L[v_{n}]=\lambda_{n}rv_{n} \\
 & -L[v_{m}]=\lambda_{m}rv_{m}
\end{aligned}
$$

ובנוסף $v_{n},v_{m}$ מקיימות את תנאי השפה של בעיית שטורם-ליוביל.
נכפול את שתי הפונקציות ב-$v_{m}$ ו-$v_{n}$ בהתאמה. נבצע אינטגרציה ואז נפחית את המשוואות. נקבל את הסלט הבא:
$$
-\int_{a}^{b} v_{m}L[v_{n}]-v_{n}L[v_{m}] \, \mathrm{d}x=(\lambda_{n}-\lambda _{m})\int_{a}^{b}v_{n}v_{m}r  \, \mathrm{d}x  
$$
הואיל ו-$v_{n},v_{m}$ מקיימות את תנאי השפה של הבעיה, נוכל להשתמש ב[[#סימטריות]] ולקבל:
$$
(\lambda_{n}-\lambda_{m})\int_{a}^{b} v_{n}v_{m}r \, \mathrm{d}x =0
$$
אבל $\lambda_{n}\neq\lambda_{m}$, ולכן $\langle v_{n},v_{_{m}} \rangle_{r}=0$.
$\blacksquare$

---
 
 ב[[ALG1_010 וקטורים עצמיים וערכים עצמיים#ו"ע של ע"ע שונים הם בת"ל|אלגברה לינארית]] היה לנו קל יותר להבין את המשמעות של וקטורים אורתוגונליים - הם פשוט וקטורים שניצבים זה לזה. כאן, אין משמעות גאומטרית אורתוגונליות של פונקציות. למרות זאת, היא מראה לנו מתי הן בת"ל.


## הע"ע והפ"ע ממשיים 
ישנן עוד טענות שאנו יכולים להסיק עבור ע"ע ופ"ע של בעיית שטורם-ליוביל, שאותן אין לי כוח להוכיח:
>[!info] טענה: 
 >עבור בעיית שטורם-ליוביל רגולרית או מחזורית:
 >1. כל הע"ע והפ"ע הם ממשיים.
 >2. כל הע"ע של בעיית שטורם-ליוביל רגולרית הם פשוטים.
 >3. אוסף הע"ע של הבעיה מהווה סדרה מונוטונית עולה המתכנסת לאינסוף.

## שלמות מערכת הפונקציות
בהמשך אנו נרצה לפתח את $f(x)$ (מהתנאי התחלה שלנו) לסדרת פונקציות $\{ f_{n} \}^{\infty_{}}_{n=0}$ כך שנוכל לבנות את הפתרון שלנו. כדי לעשות זאת, עלינו לספק מספר טענות.

>[!info] טענה: 
 >תהי $\{ v_{n} \}^{\infty}_{n=0}$ סדרה אורתונורמלית של כל הפונקציות העצמיות לבעיית שטורם-ליוביל בקטע $[a,b]$.
 >1. תהי $f$ גזירה למקוטעין בקטע $[a,b]$. אז לכל $x \in[a,b]$ הפיתוח של $f$ לפי הפונקציות העצמיות $\{ v_{n} \}^{\infty}_{n=0}$ מתכנס לממוצע הקפיצה של $f$, כלומר לערך $[f(x_{+})+f(x_{-})]/2$. טענה זו נקראת גם **משפט דיריכלה**.
 >2. אם פונקציה רציפה וגזירה למקוטעין ומקיימת את שני תנאי השפה של בעיית שטורם-ליוביל הנתונה, אז הפיתוח של $f$ לפי הפונקציות העצמיות $\{ v_{n} \}^{\infty}_{n=0}$ מתכנס במידה שווה בקטע $[a,b]$.
 
 >[!Question]- מה זה התכנסות במידה שווה?
 >
 >נשים לב ש-$f$ הוא לא סתם פונקציה, הוא פונקציה שמורכבת מסכום של *אינסוף* פונקציות. התכנסות במידה שווה היא תכונה שאומרת שסדרת פונקציות ממשיות $\{ f_{n} \}^{\infty}_{n=0}$ מתכנסת לערך סופי, שהוא הערך של $f$. זוהי לא הגדרה מדויקת, אבל הרעיון מאחוריה הוא שהתכונה הזאת מבטיחה שתכונות אחרות כמו רציפות ואינטגרביליות עובורת מפונקציות הסדרה $f_{n}$ לפונקציה הגבול $f$.


# פיתוח לפי פונקציות עצמיות

נתבונן בבעיית שטורם-ליוביל שמתקבלת מהפרדת המשתנים:
$$
\begin{aligned}
 & L[v]+\lambda rv=0  & a<x<b \\
 & \alpha v(a)+\beta v'(a)=0 \\
 & \gamma v(b)+\delta v'(b)=0
\end{aligned}
$$

תהי $\{ v_{n} \}^{\infty}_{n=0}$ הסדרה האורתוגונלית של הפונקציות העצמיות המתאימה לסדרת הערכת העצמיים $\{ \lambda_{n} \}^{\infty}_{n=0}$. נרצה לבנות את פתרון הבעיה מפונקציות עצמיות אלו. כדי לעשות זאת, נראה קודם איך אנחנו מציגים את הפונקציה $f$ כטור של הפונקציות העצמיות (כאשר $f$ היא תנאי התחלה של הבעיה). לשם הדיון, נניח שיש כזו הצגה עבור סדרת קובעים כלשהי $f_{n}$:
$$
f(x)=\sum_{n=0}^{\infty}A_{n}v_{n}(x) 
$$

נכפיל את שני האגפים באחת הפונקציות העצמיות $v_{m}$. נעשה אינטגרציה ונקבל:
$$
\int_{a}^{b} f(x)v_{m} \, \mathrm{d}x=\int_{a}^{b} \sum_{n=1}^{\infty } A_{n}v_{n}v_{m} \, \mathrm{d}x  
$$
מאחר ואנו מניחים ש-$f$  היא פונקציה רציפה וגזירה למקוטעין המקיימת את תנאי השפה של הבעיה, אז הפיתוח לפי הסדרה $\{ v_{n} \}^{\infty}_{n=0}$ של $f$ מתכנסת במידה שווה. לכן, נוכל להפוך את סדר הסכימה והאינטגרציה:
$$
\int_{a}^{b} f(x)v_{m} \, \mathrm{d}x =\sum_{n=1}^{\infty }A_{n}\int_{a}^{b} v_{n}v_{m} \, \mathrm{d}x  
$$
מאורתוגונליות נקבל שכל האיברים בטור מתאפסים אלא אם כן $n=m$, ולכן:
$$
\begin{gather}
\int_{a}^{b} f(x)v_{m} \, \mathrm{d}x =A_{m}\int_{a}^{b} v_{m}^{2} \, \mathrm{d}x   \\[1ex]
\langle f,v_{m} \rangle = A_{m}\langle v_{m},v_{m} \rangle \\[1ex]
A_{m}=\dfrac{\langle f,v_{m} \rangle}{\langle v_{m},v_{m} \rangle}
\end{gather}
$$
קיבלנו כי המקדמים של הפ"ע נתונים ע"י:
$$
\boxed {
A_{n}=\dfrac{\langle f,v_{n} \rangle}{\langle v_{n},v_{n} \rangle}
 }
$$
אמנם מה שהביא אותנו לנוסחה היה דיון לא פורמלי, אבל מסתבר שהטורים עם מקדמים אלו מקרבים את הפונקציה בצורה די טובה, למרות שלא תמיד מתקיים שוויון בין הפונקציה לטור שלה.
הפיתוח הזה נקרא **פיתוח לפי פונקציות עצמיות**, או **פיתוח פורייה**.
הטור:
$$
\boxed {
f(x)=\sum_{n=0}^{\infty}A_{n}v_{n}(x) 
 }
$$
נקרא **טור פורייה מוכלל** של הפונקציה $f$ ביחס לפונקציות העצמיות של הבעיה.
>[!notes] הערה: 
 >נשים לב שבבעיה של המד"ח קיבלנו תנאי התחלה ותנאי שפה שעלולים לחפוף בנקודה $(0,0)$:
 >$$
> u(x,0)=f(x),\, \quad u(0,t)=0
> $$
 >אבל יכל להיות שנתון ש-$f(0)\neq 0$ (יענו יש סתירה בין תנאי ההתחלה לתנאי השפה). כלומר, מה שנקבל זה שהטור שפיתחנו $\sum_{n=0}^{\infty}A_{n}v_{n}$ שווה ל-$f$ לכל $x$ שאינו בנקודת שפה.
 >מ[[#שלמות מערכת הפונקציות]] נסיק כי הפתרון $u$ שנבנה תקיים את המד"ח ואת תנאי השפה ואת תנאי ההתחלה חוץ מקצוותיה, כי שם תנאי השפה "מנצחים".
 >הבדלה זו רלוונטית רק אם ישנה סתירה בין תנאי ההתחלה לתנאי השפה.


 --- 
 **תרגיל**: 
 מצא ע"ע ופ"ע של הבעיה:
 $$
\begin{aligned}
 & y''+\lambda y=0 &  & -1<x<1 \\
 & y'(-1)=0 \\
 & y'(1)=0
\end{aligned}
$$
**פתרון**:
נשים לב כי זוהי בעיה רגולרית. הפ"א:
$$
\begin{gather}
r^{2}+\lambda=0 \\
r_{1,2}=\pm \sqrt{ -\lambda }
\end{gather}
$$
נפריד למקרים:
1. אם $\lambda=0$:
	$$
	r_{1,2}=0
	$$
	ולכן הפתרון הכללי יהיה:
	$$
	y(x)={c}_{1} +{c}_{2} x
	$$
	נציב את התנאי ההתחלה:
	$$
	\begin{gather}
	y'(x)={c}_{2} \\
	y'(-1)=0
	\end{gather}\implies {c}_{2} =0
	$$
	ולכן הפתרון הוא:
	$$
	y(x)=c,\, \quad \lambda=0
	$$
2. עבור $\lambda<0$:
	נסמן אז $\lambda=-k^{2}$, כאשר $k>0$. לכן:
	$$
	r_{1,2}=\pm \sqrt{ k^{2} }=\pm \left|k\right|=\pm k
	$$
	ולכן צורת הפתרון הכללי:
	$$
	y(x)={c}_{1} e^{kx}+{c}_{2} e^{-kx}
	$$
	נציב תנאי התחלה:
	$$
	\begin{gather}
	y'(x)=k({c}_{1} e^{kx}-{c}_{2} e^{-kx}) \\
	y'(-1)=k({c}_{1} e^{-k}-{c}_{2} e^{k})=0 \\
	y'(1)=k({c}_{1} e^{k}-{c}_{2} e^{-k})=0
	\end{gather}
	$$
	קיבלנו מערכת משוואות הומוגנית:
	$$
	\begin{cases}
	{c}_{1} e^{-k}-{c}_{2} e^{k}=0 \\
	{c}_{1} e^{k}-{c}_{2} e^{-k}=0
	\end{cases}
	$$
	נשים לב כי הדטרמיננטה של המערכת הזאת מקיימת:
	$$
	\begin{vmatrix}
	e^{-k} & -e^{k} \\
	e^{k} & -e^{-k}
	\end{vmatrix}=e^{-2k}+e^{2k}\underset{ k\neq 0 }{ \neq } 0
	$$
	כלומר, קיבלנו שהדטרמיננטה לא מתאפסת, ולכן הפתרון היחיד הוא הפתרון הטריוויאלי:
	$$
	{c}_{1} ={c}_{2}=0
	$$
	לפיכך:
	$$
	y(x)=0
	$$
	אבל זהו הפתרון הטריוויאלי שבו אנו לא מעוניינים. נסיק כי אין ע"ע עבור $\lambda<0$.
3. אם $\lambda>0$:
	נסמן $\lambda=k^{2}$ כאשר $k>0$. לכן:
	$$
	r_{1,2}=\pm \sqrt{ -k^{2} }=\pm ki
	$$
	לכן הפתרון הכללי יהיה מהצורה:
	$$
	y(x)={c}_{1} \cos(kx)+{c}_{2} \sin(kx)
	$$
	הנגזרת:
	$$
	y'(x)=k[-{c}_{1} \sin(kx)+{c}_{2} \cos(kx)]
	$$
	נציב את תנאי ההתחלה:
	$$
	\begin{aligned}
	 & y'(-1)=k[-{c}_{1} \sin(k)+{c}_{2} \cos(k)]=0 \\
	 & y'(1)=k[-{c}_{1} \sin(k)+{c}_{2} \cos(k)]=0
	\end{aligned}
	$$
	קיבלנו שוב מערכת משוואות:
	$$
	\begin{cases}
	{c}_{1} \sin k+{c}_{2} \cos k=0 \\
-{c}_{1} \sin k+{c}_{2} \cos k=0
	\end{cases}
	$$
	נשים לב לדטרמיננטה:
	$$
	\begin{vmatrix}
	\sin k & \cos k \\
-\sin k & \cos k
	\end{vmatrix}=2\sin k\cos k=\sin 2k
	$$
	קיבלנו ביטוי שמתאפס אינסוף פעמים. הוא ייתאפס כאשר:
	$$
	\begin{gather}
	\sin 2k=0 \\
	2k=n\pi \\
	k=\dfrac{n\pi}{2}
	\end{gather}
	$$
	רק עבור $k$ אלו יש פתרון לא טריוויאלי למערכת משוואות. נציב זאת במערכת משוואות:
	$$
	\begin{cases}
	{c}_{1} \sin\left( \dfrac{n\pi}{2}\right)+{c}_{2} \cos\left( \dfrac{n\pi}{2} \right) =0 \\[1ex]
-{c}_{1} \sin\left( \dfrac{n\pi}{2}\right)+{c}_{2} \cos\left( \dfrac{n\pi}{2} \right) =0
	\end{cases}
	$$
	עבור $n$ זוגי, הפתרון יהיה:
	$$
	{c}_{2} =0,\, \forall {c}_{1} \neq 0
	$$
	ולכן הפ"ע והע"ע:
	$$
	\boxed {
	\begin{aligned}
	 & y_{n}(x)=c_{n}\cos \left( \dfrac{n\pi}{2}x \right)  &  & n=2,4,\dots \\
	 &\lambda_{n}=\left( \dfrac{n\pi}{2} \right)^{2} &  & n=2,4,\dots
	\end{aligned}
	 }
	$$
	עבור $n$ אי זוגי, הפתרון יהיה:
	$$
	{c}_{1} =0,\, \forall {c}_{2} \neq 0
	$$
	ולכן הפ"ע:
	$$
	\boxed {
	\begin{aligned}
	 & y_{n}(x)=c_{n}\sin \left( \dfrac{n\pi}{2}x \right)  &  & n=1,3,5,\dots \\
	 &\lambda_{n}=\left( \dfrac{n\pi}{2} \right)^{2} &  & n=1,3,5,\dots 
	\end{aligned}
	 }
	$$

נוודא את התכונות שלנו, כאשר נשים לב כי המכפלה הפנימית המתאימה למקרה שלנו היא:
$$
\langle u,v \rangle=\int_{a}^{b} u(x)v(x) \, \mathrm{d}x 
$$
כי $r(x)=1$.
1. סדרת הערכים העצמיים אכן מהווה סדרה מונוטונית עולה השואפת לאינסוף.
2. אכן עבור כל $n\neq m$:
	$$
	\langle y_{n},y_{m} \rangle=0
	$$


 --- 
 **תרגיל**: 
 מצא ע"ע ופ"ע של:
 $$
\begin{aligned}
 & x^{2}y''+3xy'+\lambda y=0  &  & 1<x<e\\
 & y(1)=0 \\
 & y(e)=0
\end{aligned}
$$
**פתרון**:
נזכור ממד"ר את [[DEQ1_007 משוואות לא הומוגניות#משוואת אויילר|משוואת אויילר]]. נקבל כי הפ"א יהיה מהצורה:
$$
r(r-1)+ar+b=0
$$
כאשר נבצע את ההצבה $x=e^{t}$.
 במקרה שלנו:
 $$
\begin{gather}
r(r-1)+3r+\lambda=0 \\
r^{2}+2r+\lambda=0 \\
r^{2}+2r+1+\lambda-1=0 \\
(r+1)^{2}=1-\lambda \\
r_{1,2}=-1\pm \sqrt{ 1-\lambda }
\end{gather}
$$
נפרק למקרים:
1. אם $\lambda=1$, אז:
	$$
	r_{1,2}=-1
	$$
	ולכן הפתרון הכללי שלנו יהיה מהצורה:
	$$
	y(x)={c}_{1} x^{-1}+{c}_{2} \ln x^{-1}
	$$
	נציב תנאי התחלה:
	$$
	\begin{aligned}
	 & 0=y(1)={c}_{1}  \\
	 & 0=y(e)={c}_{2} \ln e\cdot e^{-1}
	\end{aligned}\implies \begin{aligned}
	 & {c}_{1} =0 \\
	 & {c}_{2} =0
	\end{aligned}
	$$
	קיבלנו את הפתרון הטרויוויאלי, שאנו לא מעוניינים בו.
2. אם $1-\lambda>0$:
	נסמן $1-\lambda=k^{2}$, כאשר $k>0$, ונקבל:
	$$
	r_{1,2}=-1\pm k
	$$
	ולכן הפתרון הכללי:
	$$
	\begin{gather}
	y(t)={c}_{1} e^{{r}_{1} t}+{c}_{2} e^{{r}_{2} t} \\
	y(x)={c}_{1} x^{{r}_{1} }+{c}_{2} x^{{r}_{2} } \\
	y(x)={c}_{1} x^{-1+k}+{c}_{2} e^{-1-k}
	\end{gather}
	$$
	נציב את התנאי התחלה:
	$$
	\begin{cases}
	 {c}_{1} +{c}_{2} =0 \\
	 {c}_{1} e^{-1+k}+{c}_{2} e^{-1-k}=0
	\end{cases}
	$$
	נחשב את הדטרמיננטה של המערכת משוואות הזו:
	$$
	\begin{vmatrix}
	 1 & 1 \\
	e^{k} & e^{-k}
	\end{vmatrix}\underset{ k\neq 0 }{ \neq } 0
	$$
	נסיק כי ישנו פתרון יחיד למערכת משווואת, ומאחר וזוהי מערכת הומוגנית, זהו הפתרון הטריוויאלי. במקרה זה, נקבל כי:
	$$
	y(x)=0
	$$
	שזהו פתרון שאנו לא מעוניינים בו.
3. אם $1-\lambda<0$:
	נסמן $1-\lambda=-k^{2}$, כאשר $k>0$, ונקבל:
	$$
	r_{1,2}=-1\pm ki
	$$
	ולכן הפתרון הכללי שלנו:
	$$
	y(x)={c}_{1} x^{-1}\cos(k\ln x)+{c}_{2} x^{-1}\sin(k\ln x)
	$$
	נציב תנאי התחלה:
	$$
	\begin{aligned}
	 & 0=y(1)={c}_{1}  \\
	 & 0=y(e)={c}_{2} e^{-1}\sin(k\ln e)
	\end{aligned}\implies \begin{aligned}
	 & {c}_{1} =0 \\
	\end{aligned}
	$$
	עבור ${c}_{2}$, קיבלנו שהוא לא תמיד מתאפס, ודווקא נתעניין במקרים אלו. ${c}_{2}$ לא ייתאפס כאשר הגורם האחר במכפלה כן ייתאפס:
	$$
	\begin{gather}
	\sin (k)=0 \\
	k=n\pi,\,\quad n = 1,2,\dots 
	\end{gather}
	$$
	לכן הע"ע והפ"ע:
	$$
	\boxed {
	\begin{aligned}
	 & y_{n}(x)=c_{n}x^{-1}\sin(n\pi \ln x)  & n=1,2,\dots \\
	 & \lambda_{n}(x)=1+(n\pi)^{2} & n=1,2,\dots 
	\end{aligned}
	 }
	$$
	נשים לב כי הבעיה לא הגיע בצורת שטורם-ליוביל סטנדרטית. כלומר, לא בצורה:
	$$
	py''+p'y'+qy+\lambda ry=0
	$$
	(נזכיר, בבעיה שלנו נתון $x^{2}y''+3xy'+\lambda y=0$). למה? כי:
	$$
	p=x^{2}\implies p'=2x\neq 3x
	$$
	לכן, אם אנו רוצים להפוך אותה לצורה סטנדרטית, נכפול בפונקציית עזר $\mu$:
	$$
	x^{2}\mu y''+3x\mu y'+\lambda\mu y=0
	$$
	וכעת נניח ש:
	$$
	p=x^{2}\mu,\, \quad p'=3x\mu
	$$
	כלומר, מתקיים:
	$$
	p'=2x\mu+x^{2}\mu',\, \quad p'=3x\mu
	$$
	נשווה, ונקבל מד"ר:
	$$
	2x\mu'=x\mu
	$$
	נפתור אותו כדי לקבל:
	$$
	\mu(x)=x
	$$
	לפיכך, נוכל לרשום את המד"ר שלנו בצורה סטנדרטית:
	$$
	x^{3}y''+3x^{2}y'+\lambda xy=0
	$$
	נסיק מכך שפונקציית המשקל שלנו היא $r(x)=x$, כך שהמכפלה הפנימית המתאימה עבור בעיית שטורם-ליוביל זו היא:
	$$
	\langle u,v \rangle=\int_{a}^{b} u(x)v(x)x \, \mathrm{d}x 
	$$



 --- 
 **תרגיל**: 
 פתח עבור התרגיל הקודם את הפונקצייה $f(x)=\dfrac{1}{x}$ לטור פורייה מוכלל (פיתוח לפי פ"ע) בקטע $[1,e]$, אם $f$ היא תנאי ההתחלה של הבעיה.

  **פתרון**:
  נחשב לפי הנוסחה:
  $$
\begin{aligned}
c_{n}=\dfrac{\langle f,y_{n} \rangle}{\langle y_{n},y_{n} \rangle}&
\end{aligned}
$$
נחשב ראשית את המכנה, כאשר באינטגרל נבצע הצבה:
$$
\begin{aligned}
 & t=\ln x \\[1ex]
 & \mathrm{d}t=\dfrac{1}{x}\mathrm{d}x
\end{aligned}
$$
$$
\langle y_{n},y_{n} \rangle=\dfrac{1}{2}\int_{0}^{1} (1-\cos(2n\pi t)) \, \mathrm{d}t=\dfrac{1}{2} 
$$
נציב בנוסחה, כאשר נשתמש באותה ההצבה:
$$
\begin{aligned}
c_{n}=2\cdot \langle f,y_{n} \rangle&=2\int_{1}^{e} x\cdot f(x)\cdot x^{-1}\cdot \sin(n\pi \ln x) \, \mathrm{d}x  \\[1ex]
&=2\int_{1}^{e} \dfrac{1}{x}\cdot \sin(n\pi \ln x) \, \mathrm{d}x \\[1ex]
&=2\int_{0}^{1} \sin(n\pi t) \, \mathrm{d}t \\[1ex]
&=-\dfrac{2}{n\pi}\cos(n\pi t)\bigg|_{0}^{1}  \\[1ex]
&=-\dfrac{2}{n\pi}(\cos(n\pi)-1) \\[1ex]
&=\dfrac{2}{n\pi}(1-(-1)^{n}) \\[1ex]
&=\begin{cases}
0 & n=2k \\[1ex]
\frac{4}{n\pi} & n=2k-1
\end{cases}
\end{aligned}
$$
נציב ב-$f$ ונקבל:
$$
f(x)\sim  \sum_{n=1}^{\infty} \dfrac{2}{n\pi}(1-(-1)^{n})\cdot x^{-1}\cdot \sin(n\pi \ln x) 
$$
או:
$$
f(x)\sim  \sum_{k=1}^{\infty} \dfrac{4}{(2k-1)\pi}\cdot x^{-1}\sin((2k-1)\pi \ln x) 
$$

נרצה לדעת האם מתקיים $\sim$ או באמת שוויון $=$. ניעזר ב[[#שלמות מערכת הפונקציות]], ונבדוק את הנקודות אי רציפות שבתנאי התחלה $f(x)=\dfrac{1}{x}$. מאחר ו-$f$ רציפה לכל $x \in(1,e)$, לפי הטענה, נסיק כי הטור פונקציות שלנו מתכנס ל-$f$ לכל $x \in(1,e)$.
נבדוק כעת האם הטור שלנו מתכנס בקצוות $x=1,x=e$:
$$
\begin{aligned}
 & f(1)=1\neq \sum_{}^{}0=0 \\
 & f(e)=\dfrac{1}{e}\neq \sum_{}^{}0=0 
\end{aligned} 
$$
קיבלנו בשני הקצוות הטור לא מתכנס לפונקציה $f$.


 --- 
 **תרגיל**: 
 נתונה הבעיה המחזורית הבאה:
 $$
\begin{aligned}
 & y''+\lambda\cdot y=0 &  & -L<x<L \\
 & y(-L)=y(L) \\
 & y'(-L)=y'(L)
\end{aligned}
$$

הע"ע של הבעיה הם:
$$
{\lambda}_{0}=0,\, \lambda_{n}=\left( \dfrac{n\pi}{L} \right)^{2},\, \quad n=1,2,\dots 
$$
הפ"ע:
$$
\begin{aligned}
 &  y_{0}(x)=c  &  & 1 \text{ or } \dfrac{1}{2} \\[2ex]
 & y_{n,1}=\cos\left( \dfrac{n\pi x}{L} \right) &  & n=1,2,\dots  \\[2ex]
 & y_{n,2}=\sin\left( \dfrac{n\pi x}{L}  \right)  &  & n=1,2,\dots 
\end{aligned}
$$
כאשר נשים לב שלכל ע"ע $\lambda_{n}$ ישנם שני פ"ע מתאימות, $y_{n,1}$ ו-$y_{n,2}$.
מצא את הפיתוח לפי פונקציות עצמיות של $f(x)$ כללית.

**פתרון**:
נחשב את הפיתוח בנפרד עבור כל סוג של פ"ע:
$$
\begin{aligned}
 & a_{n}=\dfrac{\langle f,y_{n,1} \rangle}{\langle y_{n,1},y_{n,1} \rangle}=\dfrac{1}{L}\cdot \int_{-L}^{L}f(x)\cdot \cos\left( \dfrac{n\pi x}{L} \right)  \, \mathrm{d}x  \\[2ex]
 & b_{n}=\dfrac{\langle f,y_{n,2} \rangle}{\langle y_{n,2},y_{n,2} \rangle}=\dfrac{1}{L}\cdot \int_{-L}^{L }f(x)\cdot \sin\left( \dfrac{n\pi x}{L} \right)  \, \mathrm{d}x 
\end{aligned}
$$

נקבל לפי הנוסחה ש:
$$
f(x)\sim \dfrac{{a}_{0}}{2}+\sum_{n=1}^{\infty}\left[ a_{n}\cos\left( \dfrac{n\pi x}{L} \right)+b_{n}\sin\left( \dfrac{n\pi x}{L} \right) \right] \quad \quad -L<x<L 
$$

טור פורייה זה נקרא **טור פורייה קלאסי**. זהו מקרה פרטי של טור פורייה כללי, בו הפונקציה מחזורית עם מחזור $T=2L$ ובנויה מטור של קוסינוסים וסינוסים.

## פיתוח פורייה קלאסי

### פיתוח פורייה בקטע חצי מחזור

אם נתונה לנו פונקציה $f$ בחצי קטע המחזור שלה, $[0,L]$, נוכל לפתח אותה לטור פורייה של רק סינוסים או טור של רק קוסינוסים.

עבור טור קוסינוסים, נבצע הרחבה זוגית:
$$
\tilde{f}(x)=\begin{cases}
f(x) &  & 0\leq x\leq L \\
f(-x) &  & -L\leq x\leq 0
\end{cases}
$$
עבור טור סינוסים, נבצע הרחבה אי זוגית:
$$
\tilde{f}(x)=\begin{cases}
f(x) &  & 0\leq x\leq L \\
-f(-x) &  & -L\leq x<0
\end{cases}
$$
עבור כל אחד, נפתח טור פורייה קלאסי ב-$[-L,L]$. נקבל עבור טור הקוסינוסים:
$$
\begin{aligned}
&\tilde{f}(x)\sim \dfrac{{a}_{0}}{2}+\sum_{n=1}^{\infty}a_{n}\cdot \cos\left( \dfrac{n\pi x}{L} \right)  &  & n=1,2,\dots  \\
&a_{n}=\dfrac{2}{L}\int_{0}^{L} \tilde{f}(x)\cos\left( \dfrac{n\pi x}{L} \right) \, \mathrm{d}x 
\end{aligned} 
$$


ועבור טור הסינוסים:
$$
\begin{aligned}
 & f(x)\sim \sum_{n=1}^{\infty}b_{n}\cdot \sin\left( \dfrac{n\pi x}{L} \right) &  & n=1,2,\dots  \\
 & b_{n}=\dfrac{2}{L}\int_{0}^{L} \tilde{f}(x)\cdot \sin\left( \dfrac{n\pi x}{L} \right) \, \mathrm{d}x 
\end{aligned}
$$

נתייחס לפיתוח הנ"ל רק עבור $x \in[0,L]$ ובכך נקבל פיתוח של $f$ לפי $\sin$ או $\cos$ בהתאם ב-$[0,L]$.

לגבי התכנסות הטורים שפיתחנו, לפי [[#שלמות מערכת הפונקציות]], לכל $x \in(0,L)$, אם $f$ רציפה, אז הטור שלנו מתכנס ל-$f(x)$. אם $f$ לא רציפה, אז הטור שלנו מתכנס לממוצע של הקפיצה של $f$. החלק המעניין הוא בקצוות, שלפי הפיתוח וההרחבות שביצענו, עבור הסינוסים, הממוצע של הקפיצה יהיה $0$. עבור הטור קוסינוסים, הוא מתכנס לערך של $f$, כי ישנה רציפות:

![[PDE1_005 בעיית שטורם ליוביל 2024-03-05 14.09.17.excalidraw.svg]]
%%[[PDE1_005 בעיית שטורם ליוביל 2024-03-05 14.09.17.excalidraw|🖋 Edit in Excalidraw]]%%


### פיתוח פורייה בקטע כללי

אם נתונה לנו פונקציה $f$ מחזורית בקטע כללי $[a,b]$  כך שהמחזור שלה הוא $T=b-a$, הפיתוח פורייה קלאסי שלה הוא:

$$
f(x)\sim \dfrac{{a}_{0}}{2}+\sum_{n=1}^{\infty}\left[ a_{n}\cos\left( \dfrac{2n\pi x}{b-a} \right)+b_{n}\sin\left( \dfrac{2n\pi x}{b-a} \right) \right] 
$$
המקדמים:
$$
\begin{aligned}
 & a_{n}=\dfrac{2}{b-a}\int_{a}^{b} f(x)\cdot \cos\left( \dfrac{2n\pi x}{b-a} \right) \, \mathrm{d}x ,\, \quad n=0,1,2,\dots \\[1ex]
 & b_{n}=\dfrac{2}{b-a}\int_{a}^{b} f(x)\cdot \sin\left( \dfrac{2n\pi x}{b-a} \right) \, \mathrm{d}x ,\, \quad n=1,2,\dots 
\end{aligned}
$$


 --- 
 
 **תרגיל**: 
 עבור $f(x)=\sin x$:
 1. חשב טור פורייה של $f$ ב-$[0,2\pi]$.
	 **פתרון**:
	 נסיק כי:
	 $$
	a=0,\,\quad b=2\pi,\quad\, T=2\pi=b-a
	$$
	נציב ונקבל:
	$$
	f(x)\sim \dfrac{{a}_{0}}{2}+\sum_{n=1}^{\infty}[a_{n}\cdot \cos(nx)+b_{n}\cdot \sin(x)] 
	$$
	מאחר ו-$f(x)=\sin x$, מהשוואת מקדמים נסיק כי:
	$$
	\begin{aligned}
	 & a_{n}=0,\, \quad n=0,1,\dots  \\
	 & b_1=1,\, \quad \forall n\neq 1: b_{n}=0
	\end{aligned}
	$$
	ולכן נוכל לבטל את הסימון $\sim$ ולהחליפו ב-$=$:
	$$
	f(x)=\sin x 
	$$
	כך שקיבלנו כי הפיתוח שלנו הוא גם כן זהותית $\sin x$.
1. חשב טור פורייה של $f$ ב-$[0,\pi]$.
	**פתרון**:
	$$
	f(x)\sim \dfrac{{a}_{0}}{2}+\sum_{n=1}^{\infty}[a_{n}\cdot \cos(2nx)+b_{n}\cdot \sin(2nx)] 
	$$
	נציב בנוסחה כדי לחשב את $a_{n}$:
	$$
	\begin{aligned}
	a_{n}=\dfrac{2}{\pi}\int_{0}^{\pi} \sin x\cdot \cos(2nx) \, \mathrm{d}x 
	\end{aligned}
	$$
	מ[[BMA1_009 זהויות טריגונומטריות#זהויות מכפלה|זהויות מכפלה]] נסיק כי:
	$$
	=\dfrac{2}{\pi}\cdot \dfrac{1}{2}\int_{0}^{\pi} \sin[(1+2n)x]+\sin[(1-2n)x] \, \mathrm{d}x 
	$$
	נמשיך לפתור:
	$$
	=\cdots =\dfrac{4}{\pi(1-(2n)^{2})}
	$$
	כאשר נשים לב כי ${a}_{0}=\dfrac{4}{\pi}$.
	עבור $b_{n}$ נקבל:
	$$
	b_{n}=\dfrac{2}{\pi}\int_{0}^{\pi} \sin x \, \cdot \sin(2nx) \mathrm{d}x
	$$
	נשים לב ש-$\sin x$ היא זוגית סביב $\dfrac{\pi}{2}$ ו-$\sin(2nx)$ היא אי זוגית סביב $\dfrac{\pi}{2}$. לפיכך, מכפלתם אי זוגית סביב $\dfrac{\pi}{2}$ ולכן האינטגרל מתאפס:
	$$
	b_{n}=0
	$$
	נקבל כי הפיתוח הכללי:
	$$
	f(x)\sim \dfrac{2}{\pi}+\sum_{n=1}^{\infty } \dfrac{1}{\pi(1-4n^{2})}\cdot \cos(2nx) 
	$$
	מאחר ו-$f$ רציפה בקצוותיה, נוכל לבטל את הסימן $\sim$ ולהחליפו ב-$=$:
	$$
	f(x)= \dfrac{2}{\pi}+\sum_{n=1}^{\infty } \dfrac{1}{\pi(1-4n^{2})}\cdot \cos(2nx) 
	$$