---
aliases:
  - אינטגרציה נומרית
  - נוסחאות ניוטון-קוטס
  - שיטה פתוחה
  - שיטה סגורה
  - אקסטרפולציית ריצ'רדסון
  - אינטגרציית גאוס
  - אינטגרציית רומברג
  - שיטת הטרפזים
  - שיטת סימפסון
---
# מבוא
נעסוק בפרק זה בפתרון [[CAL1_008 אינטגרל מסוים#האינטגרל המסוים|אינטגרל מסוים]] מהצורה:
$$I_{f}=\int_{a}^{b} f(x) \, \mathrm{d}x $$
עבור קטע סופי $[a,b]$ ופונקציה [[CAL1_008 אינטגרל מסוים#אינטגרביליות והאינטגרל המסוים|אינטגרבילית]] $f$.

# אינטגרציה נומרית בסיסית
בהינתן פונקציה $f$ בקטע הסגור $[a,b]$, אנו יכולים לבחור מספר מספר נקודות ${x}_{0},{x}_{1},\dots,x_{n}\in[a,b]$ ולבנות [[NUM1_007 אינטרפולציה פולינומית#אינטרפולנט והצגתו|אינטרפולנט]] $p_{n}(x)$. לפיכך:
$$\int_{a}^{b} p_{n}(x) \, \mathrm{d}x $$
יהיה קירוב טוב ל:
$$\int_{a}^{b} f(x) \, \mathrm{d}x $$

## פיתוח שיטות בסיסיות
אם נשתמש ב[[NUM1_007 אינטרפולציה פולינומית#אינטרפולציית לגרנג'|אינטרפולציית לגרנג']], נקבל כי:
$$\begin{aligned}
\int_{a}^{b} f(x) \, \mathrm{d}x \approx \int_{a}^{b} p_{n}(x) \, \mathrm{d}x &=\int_{a}^{b} \sum_{i=0}^{n} f(x_{i})L_{i}(x) \, \mathrm{d} x\\
&=\sum_{i=0}^{n}f(x_{i})\int_{a}^{b} L_{i}(x) \, \mathrm{d}x 
\end{aligned}  $$
נקרא לאינטגרל של הפולינום לגרנג' **מקדמי קוטס** ונסמנם:
$$H_{i}=\int_{a}^{b} L_{i}(x) \, \mathrm{d}x $$

לפיכך:
$$\int_{a}^{b} f(x) \, \mathrm{d}x \approx \sum_{i=0}^{n}H_{i}f(x_{i}) $$

למשל, עבור $n=1$ והנקודות בקצוות ${x}_{0}=a$ ו-${x}_{1}=b$. אז הפולינומני לגרנג':
$${L}_{0} (x)=\dfrac{x-b}{a-b},\, \quad {L}_{1} (x)=\dfrac{x-a}{b-a}$$
לכן, נקבל את המקדמים:
$$\begin{aligned}
 & {H}_{0} =\int_{a}^{b}  \dfrac{x-b}{a-b} \, \mathrm{d}x=\dfrac{b-a}{2} \\
 & {H}_{1} =\int_{a}^{b} \dfrac{x-a}{b-a} \, \mathrm{d}x =\dfrac{b-a}{2}
\end{aligned} $$
קיבלנו כאן את **שיטת הטרפזים**:
$$I_{f}\approx I_{\text{trap}}=\dfrac{b-a}{2}[f(a)+f(b)]$$
במקום אינטרפולנט לינארי בקצוות, נוכל גם לקחת אינטרפולנט ריבועי כאשר אנו לוקחים בחשבון גם את אמצע הקטע. כלומר, $n=2$ ו-:
$${x}_{0} =a,\, \quad {x}_{1} =\dfrac{b+a}{2},\, \quad {x}_{2} =b$$
אם נבנה את שלושת פולינימי לגרנג' ונבצע עליהם אינטגרציה אנו נקבל את **שיטת סימפסון**:
$$I_{f}\approx I_{\text{Simp}}=\dfrac{b-a}{6}\left[ f(a)+4f\left( \dfrac{b+a}{2} \right)+f(b) \right]$$

לפעמים מסמנים את המרחק בין הנקודות לשיטת סימפסון ב-$h=\dfrac{b-a}{2}$, ואז שיטת סימפסון הופכת ל:
$$I_{\text{Simp}}=\dfrac{h}{3}({f}_{1}+4{f}_{2}+{f}_{3})$$
ואז קוראים לשיטה זו **שיטת סימפסון $\dfrac{1}{3}$**. אם נפתח את השיטה ל-4 נקודות במרחקים שווים, נקבל:
$$I_{\text{Simp}}=\dfrac{3h}{8}({f}_{1}+3{f}_{2}+3{f}_{3}+{f}_{4})$$
ונקרא לשיטה זו **שיטת סימפסון $\dfrac{3}{8}$**.

![[Screenshot_20240302_151830_Samsung Notes.jpg|book]]
> שטח מתחת לגרף. הגרף בפינה השמאלית למעלה מייצג את השטח האמיתי מתחת לגרף. בפינה הימנית למעלה מוצג השטח לפי שיטת סימפסון, ופינה השמאלית למטה מוצג השטח לפי שיטת הטרפזים. הפינה הימנית למטה מייצגת מה קורה כשלא הבנם מה לעזאזל רוצים ממכם.

<div style="page-break-after: always;"></div>

שיטת הטרפזים ושיטת סימפסון הם סוגים של נוסחאות **ניוטון-קוטס (Newton-Cotes formulas)**. אלו נוסחאות המתבססות על אינטרפולציה פולינומית בנקודות *במרחקים שווים*. נאמר כי אם הנקודות $a,b$ נכללות באינטרפולנט, אז זוהי **שיטה סגורה**. אחרת, זוהי **שיטה פתוחה**.

## שגיאה בשיטות בסיסיות
נרצה לדעת מה השגיאה בשיטות שלנו. השגיאה עבור אינטרפולציה נתונה ע"י חיסור הפונקציה והאינטרפולנט:
$$f(x)-p_{n}(x)$$

לכן, השגיאה באינטגרציה שלנו תהיה האינטגרל על חיסור זה:
$$E(f)=\int_{a}^{b} f(x) \, \mathrm{d}x -\sum_{i=0}^{n} H_{i}f(x_{i}) $$
למשל, עבור שיטת הטרפזים, נקבל כי:
$$E(f)=\int_{a}^{b} f(x) \, \mathrm{d}x-\dfrac{b-a}{2}[f(a)+f(b)] $$

ברור כי לא אנחנו לא באמת יודעים איך לחשב את האינטגרל של $f$, אבל אם אנו יודעים את נגזרות שלו, ניתן להראות כי עבור $\xi \in(a,b)$ מתקיים:
$$\boxed {
E(f)=-\dfrac{f''(\xi)}{12}(b-a)^{3}
 }$$
בהינתן ו-$a$ ו-$b$ קרובים מספיק אחד לשני. ההוכחה לשיעור שגיאה זה הוא סתם ארוך ואין לי כוח להראות אותו. מספיק לדעת שהוא נובע מ[[CAL1_006 פולינום טיילור#משפט טיילור|טיילור]].

עבור שיטת סימפסון ניתן להראות באותה צורה כי:
$$\boxed {
E(f)=-\dfrac{f^{(4)}(\xi)}{90}\left( \dfrac{b-a}{2} \right)^{5}
 }$$

 ---
 
 **תרגיל**: 
חשב את האינטגרל הבא לפי השיטות הבאות. הערך את השגיאה המתקבלת בכל שיטה (תן חסמים), והשווה מול השגיאה בפועל.

1. אנליטי.
2. שיטת הטרפז.

**פתרון**:
1. נחשב פשוט את האינטגרל:
	$$\begin{aligned}
I=\int_{0}^{\pi/2} \sin x \, \mathrm{d}x =-\cos x\bigg|_{0}^{\pi/2} =-\cos \dfrac{\pi}{2}+\cos 0=1
\end{aligned}$$
2. לפי שיטת הטרפז, המרחקים בין הנקודות:
	$$h=b-a=\dfrac{\pi}{2}-0=\dfrac{\pi}{2}$$
	ולכן:
	$$I=\dfrac{h}{2}({f}_{0} +{f}_{1} )=\dfrac{\pi}{4}\left( \sin 0+\sin \dfrac{\pi}{2} \right)=\dfrac{\pi}{4}=0.785398$$
	הערכת השגיאה:
$$E=-\dfrac{1}{12}h^{3}f''(\xi)=-\dfrac{1}{2}\left( \dfrac{\pi}{2} \right)^{3}(-\sin(\xi))$$
	ולכן החסמים:
	$$\begin{aligned}
E&<-\dfrac{1}{12}\left( \dfrac{\pi}{2} \right)^{3}\left( -\sin\left( \dfrac{\pi}{2} \right) \right)=0.32298 \\
E&>-\dfrac{1}{12}\left( \dfrac{\pi}{2} \right)^{3}(-\sin 0)=0
\end{aligned}$$
	השגיאה בפועל היא:
	$$E=1-0.785398=0.214601$$



## ניוטון קוטס משקלי

עד כה השתמשנו בשיטות המניחות כי המרווחים בין נקודות הדגימה חייבים להיות שווים. כעת נרצה להרחיב למקרה היותר כללי:
$$H_{i}= \, \mathrm{d}x \int_{a}^{b} w(x)L_{i}(x) \, \mathrm{d}x $$

  כאשר $w(x)$ הוא פונקציית משקל, ו-$L_{i}$ הם פולינומי לגרנג'. בשיטת הטרפזים וסימפסון פשוט עסקנו במקרה הפרטי בו $w(x)=1$.

 --- 
 
 **תרגיל**: 
 פתח את שיטת ניוטון-קוטס לאינטגרל מהצורה:
 $$\int_{0}^{1} \dfrac{f(x)}{\sqrt{ x }} \, \mathrm{d}x \approx {H}_{0}f(0)+{H}_{1}f(0.5)+{H}_{2}f(1)$$

כלומר, כאשר המשקל הוא $w(x)=\dfrac{1}{\sqrt{ x }}$.
**פתרון**:
נשתמש בשיטת המקדמים החופשיים - נבצע אינטגרל על מרחב הפולינומים מסדר $2$: $\{ 1,x,x^{2} \}$ בכדי לחשב את המשקלים:
$$\begin{aligned}
 & f(x)=1 & &  \implies\int_{0}^{1} \dfrac{1}{\sqrt{ x }} \, \mathrm{d}x \\[1ex]
 &  &  & \quad\quad=2={H}_{0}+{H}_{1}+{H}_{2} \\[3ex]
 & f(x)=x & &  \implies \int_{0}^{1} \dfrac{x}{\sqrt{ x }} \, \mathrm{d}x \\[1ex]
 &  &  &  \quad\quad=\int_{0}^{1} \sqrt{ x } \, \mathrm{d}x = \dfrac{2x^{3/2}}{3}\bigg|_{0}^{1} \\[1ex]
 &  &  &  \quad\quad=\dfrac{2}{3}={H}_{1}\cdot 0.5+{H}_{2}\cdot 1 \\[3ex]
 & f(x)=x^{2} &  & \implies \int_{0}^{1} \dfrac{x^{2}}{\sqrt{ x }} \, \mathrm{d}x  \\[1ex]
 &  &  & \quad\quad=\int_{0}^{1} x^{3/2} \, \mathrm{d}x  \\[1ex]
 &  &  & \quad\quad=\dfrac{2x^{5/2}}{5}\bigg|_{0}^{1} \\[1ex]
 &  &  & \quad\quad=\dfrac{2}{5}={H}_{1}\cdot 0.25+{H}_{2}\cdot 1
\end{aligned}$$
 קיבלנו את מערכת המשוואות:
$$\begin{pmatrix}
1 & 1 & 1  \\
0 & 0.5 & 1 \\
0 & 0.25 & 1
\end{pmatrix}\begin{pmatrix}
H_{0} \\
H_{1} \\
H_{2}
\end{pmatrix}=\begin{pmatrix}
2 \\
2/3 \\
2/5
\end{pmatrix}$$

כאשר נפתור את המערכת:
$${H}_{0}=\dfrac{4}{5},\, \quad {H}_{1}=\dfrac{16}{15},\, \quad {H}_{2}=\dfrac{2}{15}$$
קיבלנו כי:
$$\boxed{\int_{0}^{1} \dfrac{f(x)}{\sqrt{ x }} \, \mathrm{d}x \approx \dfrac{4}{5}f(0)+\dfrac{16}{15}f(0.5)+\dfrac{2}{15}f(1) }$$

 --- 
 
 **תרגיל**:
 פתח אינטגרציה בקטע חצי פתוח, ללא נקודת ה-$0$, עבור הפונקציה הכללית הבאה:
$$\int_{0}^{1} g(x) \, \mathrm{d}x={H}_{0}g\left( \dfrac{1}{3} \right)+{H}_{1}g\left( \dfrac{2}{3} \right)+{H}_{2}g(1) $$

**פתרון**:
נפתח שיטת ניוטון קוטס בקטע פתוח. כדי לחשב את המשקלים נשתמש ב:
$$H_{i}=\int_{a}^{b}L_{i}(x)  \, \mathrm{d}x $$
נחשב את פולינומי לגרנג':
$$\begin{aligned}
 & {L}_{0} =\dfrac{x-\dfrac{2}{3}}{\dfrac{1}{3}-\dfrac{2}{3}}\cdot \dfrac{x-1}{\dfrac{1}{3}-1}=\dfrac{x^{2}-\dfrac{5}{3}x+\dfrac{2}{3}}{\dfrac{2}{9}} \\[2ex]
 & {L}_{1}=\dfrac{x-\dfrac{1}{3}}{\dfrac{2}{3}-\dfrac{1}{3}}\cdot \dfrac{x-1}{\dfrac{2}{3}-1}=\dfrac{x^{2}-\dfrac{4}{3}x+\dfrac{1}{3}}{-\dfrac{1}{9}} \\[2ex]
 & {L}_{2}=\dfrac{x-\dfrac{1}{3}}{1-\dfrac{1}{3}}\cdot \dfrac{x-\dfrac{2}{3}}{1-\dfrac{2}{3}}=\dfrac{x^{2}-x+\dfrac{2}{9}}{\dfrac{2}{9}}
\end{aligned}$$

ולכן המקדמים:
$$\begin{aligned}
 & {H}_{0}=\int_{0}^{1} \dfrac{x^{2}-\dfrac{5}{3}x+\dfrac{2}{3}}{\dfrac{2}{9}} \, \mathrm{d}x=0.75 \\[2ex]
 & {H}_{1}=\int_{0}^{1} \dfrac{x^{2}-\dfrac{4}{3}x+\dfrac{1}{3}}{-\dfrac{1}{9}} \, \mathrm{d}x=0 \\[2ex]
 & {H}_{2}=\int_{0}^{1} \dfrac{x^{2}-x+\dfrac{2}{9}}{\dfrac{2}{9}} \, \mathrm{d}x=0.25  
\end{aligned} $$

קיבלנו כי:
$$\boxed{\int_{0}^{1} g(x) \, \mathrm{d}x \approx 0.75g\left( \dfrac{1}{3} \right)+\dfrac{1}{4}g(1)}$$


 --- 
 
 **תרגיל**: 
 פתור את שני האינטגרלים הבאים בעזרת התרגילים הקודמים:
 $$\begin{gathered}
\int_{0}^{1} \dfrac{f(x)}{\sqrt{ x }} \, \mathrm{d}x,\, \quad f(x)=x^{2}+1 \\[2ex]
\int_{0}^{1} g(x) \, \mathrm{d}x,\, \quad g(x)=\dfrac{(x^{2}+1)}{\sqrt{ x }}
\end{gathered}$$ 

**פתרון**:
נשים לב כי שני האינטגרלים מבחינה אנליטית זהים לחלוטין. נפתור אותו אנליטית:
$$\int_{0}^{1} \dfrac{x^{2}+1}{\sqrt{ x }} \, \mathrm{d}x=\int_{0}^{1} (x^{3/2}+x^{-1/2}) \, \mathrm{d}x =\left[ \dfrac{2}{5}x^{5/2}+2x^{1/2} \right]\bigg|_{0}^{1} =2.4 $$

מבחינה נומרית, עבור הקירוב שקיבלנו בתרגיל הראשון:
$$\begin{aligned}
\int_{0}^{1} \dfrac{f(x)}{\sqrt{ x }}  \, \mathrm{d}x & \approx \dfrac{4}{5}f(0)+ \dfrac{16}{15}f(0.5)+\dfrac{2}{15}f(1) \\[1ex]
&=\dfrac{4}{5}\cdot 1+\dfrac{16}{15}\cdot 1.25+\dfrac{2}{15}\cdot 2 \\[1ex]
&=2.4
\end{aligned} $$

 קיבלנו את התוצאה. כלומר השגיאה שלנו היא $0$ עבור שיטת ניוטון-קוטס המשקלית.

עבור השיטה מהתרגיל השני:
$$\int_{0}^{1}g(x)  \, \mathrm{d}x\approx 0.75\cdot 1.9245+\dfrac{1}{4}\cdot 2=1.9434 $$
כלומר, קיבלנו שגיאה הרבה יותר גדולה עבור השיטה ללא הפונקציית משקל.

# אינטגרציה נומרית מרוכבת (מוכללת)

 
ראינו כי אפילו עבור אינטגרנד חלק, השיטות הבסיסיות עשויות להיות לא מדויקות כאשר מחשבים אינטגרל על קטע ארוך. נוכל לתקן זאת אם נחשב את האינטגרל על חלקים יותר קטנים ונסכום אותם.

עבור פונקציה $f$ בקטע $[a,b]$, נוכל לחלק אותה ל-$r$ תת-קטעים שווים $h=\dfrac{b-a}{r}$. אזי:
$$\int_{a}^{b} f(x) \, \mathrm{d}x =\sum_{i=1}^{r}\int_{a+(i-1)h}^{a+ih} f(x) \, \mathrm{d}x =\sum_{i=1}^{r}\int_{t_{i-1}}^{t_{i}} f(x) \, \mathrm{d}x   $$
כאשר $t=a+ih$. כעת, כל מה שעלינו לעשות הוא לחשב את האינטגרל עבור כל אחד מהתת קטעים לפי השיטות הבסיסיות.

## שיטת הטרפז המרוכבת

שיטת הטרפז עבור הקטע $[t_{i-1},t_{i}]$:
$$\int_{t_{i-1}}^{t} f(x) \, \mathrm{d}x \approx \dfrac{h}{2}[f(t_{i-1})+f(t_{i})]$$

לכן, **שיטת הטרפז המרוכבת** היא:
$$\begin{aligned}
\int_{a}^{b} f(x) \, \mathrm{d}x  & \approx \dfrac{h}{2}\sum_{i=1}^{r}[f(t_{i-1})+f(t_{i})] \\
&=\dfrac{h}{2}[{f}({t}_{0})+2f({t}_{1})+2f({t}_{2})+\dots +2f(t_{r-1})+f(t_{r})] \\
&=\boxed {
\dfrac{h}{2}[f(a)+2f({t}_{1})+2f({t}_{2})+\dots +2f(t_{r-1})+f(b)]
 }
\end{aligned}$$

השגיאה היא הסכום של השגיאות עבור כל קטע:
$$E(f)=\sum_{i=1}^{r}\left( -\dfrac{f(\xi_{i})}{12}h^{3} \right)=\boxed {
-\dfrac{f''(\xi)}{12}(b-a)h^{2}
 } $$
כאשר $t_{i-1}\leq \xi_{i}\leq t_{i}$ ו-$a\leq \xi\leq b$.

![[Screenshot_20240310_131524_OneDrive.jpg|book]]
> שיטת הטרפז המרוכבת עבור $h=0.2$.


## שיטת סימפסון המרוכבת

שיטת סימפסון המרוכבת היא אחד השיטות הכי נפוצות לחישוב אינטגרלים בצורה נומרית.
נגדיר $r$ *זוגי* ונתייחס לתת-קטעים בזוגות, כך שהקטעים שאנו מקבלים הם בעלי אורך $2h$ כל אחד - $[t_{2k-2},\,t_{2k}]$, כאשר $k=1,2,\dots,\dfrac{r}{2}$.
לכל תת-קטע $[t_{2k-2},t_{2k}]$ אנו נבצע אינטרפולציה על האינטגרנד $f(x)$ ע"י פולינום ריבועי, נחשב את האינטגרל שלהם, ונסכום אותם:
$$\int_{t_{2k}-2}^{t_{2k}} f(x) \, \mathrm{d}x \approx \dfrac{2h}{6}[f(t_{2k-2})+f(t_{2k})]$$
נסכום:
$$\boxed {
\int_{a}^{b} f(x) \, \mathrm{d}x \approx \dfrac{h}{3}\left[ f(a)+2\sum_{k=1}^{r/2-1}f(t_{2k-1})+f(b)  \right]
 }$$
באותו אופן כמו שיטת הטרפז, ניתן להראות כי השגיאה של שיטת סימפסון:
$$\boxed {
E(f)=-\dfrac{f'''(\xi)}{180}(b-a)h^{4}
 }$$
 עבור $a\leq \xi\leq b$ כלשהו.

>[!example] דוגמה: 
 >נרצה לחשב את האינטגרל:
 >$$I=\int_{0}^{1} e^{-x^{2}} \, \mathrm{d}x \approx 0.746824133 $$
 >נחלק את הקטע $[0,1]$ לארבעה קטעים שווים. לכן, $t_{i}=ih$ כאשר $i=0,1,2,3,4$ ו-$h=0.25$. שיטות הטרפז וסימפסון המרוכבות יניבו:
 >$$\begin{aligned}
 & I_{\text{trap}}=0.125[e^{0}+2e^{-h^{2}}+2e^{-(2h)^{2}}+2e^{-(3h)^{2}}+e^{-(4h)^{2}}]=0.742984 \\
 & I_{\text{Simp}}=\dfrac{0.25}{3}[e^{0}+4e^{-h^{2}}+2e^{-(2h)^{2}}+4e^{-(3h)^{2}}+e^{-(4h)^{2}}]=0.746855
\end{aligned}$$
כמובן ששיטת סימפסון יותר מדויקת כאן.
>
>![[Screenshot_20240310_133647_OneDrive.jpg|book]]
>>השגיאה של שיטת הטרפזים וסימפסון המרוכבת, ככל שמגדילים את $r$.
>

# אינטגרציית גאוס

 
כל השיטות שהשתמשנו בהם עד כה בעלי הצורה הכללית:
$$\int_{a}^{b} f(x) \, \mathrm{d}x \approx \sum_{j=0}^{n}a_{i}f(x_{j}) $$
כאשר הנקודות $x_{j}$ במרחקים שווים אחד מהשני, כי זה נוח יותר לחשב את האינטרפולציה שלהם. אבל האם אנו יכולים לבחור את הנקודות $x_{j}$ בצורה יותר חכמה?

אז היו כמה חכמים שישבו וחשבו והסיקו שעבור פולינומים, בקטע $[-1,1]$, אם נרצה לבחור $n$ נקודות, כדאי לנו להשתמש **בשורשי פולינמוני לז'נדר**:

$$\begin{array}{c|c|c}
n & x_{j} & a_{j} \\
\hline 2 & \pm 0.577350 & 1 \\
\hline3 & 0  & 8/9\\
 &  \pm 0.774597 &  5/9 \\
\hline4 &\pm 0.339981 & 0.652145 \\
 & \pm 0.861136 & 0.347855 \\
\hline 5 & 0 & 0.568889 \\
 & \pm 0.538469 & 0.478629 \\
 & \pm 0.906180 & 0.236927 
\end{array}$$

עבור שימוש ב-$n$ נקודות אנו נוכל לקבל אינטגרל מדויק עבור פולינומים מסדר $2n-1$, לעומת פולינום מסדר $(n-1)$ בשיטות ניוטון קוטס.

בנוסף, השגיאה התאורטית היא:
$$\boxed {
E=\dfrac{2^{2n+1}(n!)^{4}}{(n+1)[(2n)!]^{3}}f^{(2n)}(\xi)
 }$$
כאשר $1<x<1$.

אבל, נשים לב שאנו חייבים לשנות את תחום האינטגרל ל-$[-1]$. בנוסף, אם אנחנו במעבדה ורוצים לקחת דגימות כדי להשתמש בשיטה זו, נהיה חייבים לבצע את הדגימות עבור ערכים מאוד ספציפיים, שזה לא תמיד כל כך נוח, לעומת שיטות ניוטון קוטס שפשוט לקחנו דגימות במרחקים שווים.

## המרת האינטגרנד לתחום הרצוי

כדי לחשב אינטגרנד הנתון בתחום $[a,b]$ בתחום אחר, במקרה שלנו $[-1]$, אנחנו חייבים לשנות אותו. כלומר, אנו רוצים למצוא פונקציה $T(t)$ כך ש:
$$\int_{a}^{b} f(x) \, \mathrm{d}x =\int_{-1}^{1} f(T(t)) \, \mathrm{d}t $$
(זה אפשרי לפי [[CAL1_008 אינטגרל מסוים#אלגוריתם שיטת ההצבה באינטגרל מסויים|שיטת ההצבה באינטגרל מסויים]]).
אזי, נדרוש ש:
$$T(1)=b,\, \quad T(-1)=a,\, \quad T(t)=x$$
נקבל ש:
$$\boxed {
T(t)=x=\dfrac{(b-a)t+(b+a)}{2},\, \quad \mathrm{d}x=\dfrac{b-a}{2}\mathrm{d}t
 }$$



 ---
  
 **תרגיל**: 
 חשב את האינטגרל הבא
 $$I=\int_{-3}^{5} (x-1)^{4} \, \mathrm{d}x $$
 לפי:
 1. פתרון אנליטי.
 2. בשיטת גאוס עם 2 נקודות. השווה שגיאה תיאורטית ושגיאה בפועל.
 3. בשיטת גאוס עם 3 נקודות. השווה שגיאה תיאורטית ושגיאה בפועל.

**פתרון**:
1. נבצע אינטגרל לא מסוים פשוט:
	$$I=\int_{-3}^{5} (x-1)^{4} \, \mathrm{d}x =\left[ \dfrac{1}{5}(x-1)^{5} \right]\bigg|_{-3}^{5}=409.6$$
2. ראשית, נעביר את תחום האינטגרציה ל-$[-1]$:
	$$\begin{aligned}
 & x=\dfrac{(b-a)t+(b+a)}{2}=\dfrac{(5-(-3))t+(5+)-3}{2}=4t+1 \\[2ex]
 & \mathrm{d}x= \dfrac{5-(-3)}{2}\mathrm{d}t=4\mathrm{d}t \\[2ex]
\end{aligned}$$
	קיבלנו את האינטגרל שלנו בתחום הרצוי:
	$$\int_{-3}^{5} (x-1)^{4}  \, \mathrm{d}x=\int_{-1}^{1} [(4t+1)-1]^{4} \, \mathrm{d}t=\int_{-1}^{1} 4^{5}t^{4} \, \mathrm{d}t$$
	אזי, אם נסמן $g(t)=4^{5}t^{4}$, נוכל לרשום:
	$$\int_{-3}^{5} f(x) \, \mathrm{d}x =\int_{-1}^{1} g(t) \, \mathrm{d}t $$
	עבור $n=2$:
	$${t}_{1,2}\pm 0.577350,\, \quad a_{1,2}=1$$
	נציב בפירוק:
	$$\tilde{I}={a}_{1}g({t}_{1})+{a}_{2}g({t}_{2})=1\cdot(4^{5}\cdot 0.577350^{4})=227.5555556$$
	השגיאה שלנו:
	$$E=I-\tilde{I}=182.044444$$
	נשים לב ש- $g^{(4)}(t)=4^{5}\cdot 4!$ - כלומר, הנגזרת הרביעית היא פונקציה קבועה. נוכל להציב אותו בחסם לשגיאה:
	$$\begin{aligned}
E=\dfrac{2^{2n+1}(n!)^{4}}{(2n+1)[(2n)!]^{3}}g^{(2n)}(\xi)= \dfrac{2^{5}(2!)^{4}}{5[4!]^{3}}\cdot 4^{5}\cdot 24=182.044444
\end{aligned}$$
3. עבור $n=3$:
	$$\begin{aligned}
 & t_{1,2}=\pm 0.774597,\,  &  {a}_{1}=\dfrac{5}{9} \\[1ex]
 & t_{3}=0,\,  & {a}_{3}=\dfrac{8}{9}
\end{aligned}$$
	נציב:
	$$\tilde{I}={a}_{1}f({x}_{1})+{a}_{2}g({t}_{2})+{a}_{3}g({t}_{3})=409.6$$
	נקבל שהשגיאה שלנו התאפסה:
	$$E=I-\tilde{I}=0$$
	מעבר לכך, החסם לשגיאה שלנו הוא גם אפס:
	$$g^{(2\cdot 3)}(t)=g^{(6)}=0$$
	$$E=\dfrac{2^{2n+1}(n!)^{4}}{(2n+1)[(2n)!]^{3}}g^{(2n)}(\xi)=\dfrac{2^{7}(3!)^{4}}{7(6!)^{3}}\cdot 0=0$$
	קיבלנו שהאינטגרל שלנו חושב בצורת מדויקת. נשים לב שהפולינום המקורי הוא פולינום מסדר $4$, והאינטגרל מחושב בצורה מדויקת עבור פולינומים עד דרגה 5.


 
# אינטגרציית רומברג

**אקסטרפולציית ריצ'רדסון** היא שיטה פשוטה לשיפור שיטות נומריות. בהינתן שתי שיטות בעלי אותו סדר שגיאה, ניתן לנצל את הביטוי הראשון בשגיאה של שתיהן כדי לקזז אותו, ובכך להישאר עם שגיאה מסדר גודל יותר קטן.
עבור אינטגרציה נומרית, אנו קוראים לשיטה **אינטגרציית רומברג**.
נדגים זאת על שיטת הטרפזים.

ניזכר כי [[#שיטת הטרפז המרוכבת|שגיאת שיטת הטרפזים]] נתונה ע"י:
$$E(f)=-\dfrac{f''(\xi)}{12}(b-a)h^{2}$$
כאשר $a<\xi<b$.
למעשה, ניתן לפרק את השגיאה הזו לחזקות זוגיות של $h$ (לא נראה הוכחה לכך כאן):
$$E(f;h)=E(f)={K}_{1}h^{2}+{K}_{2}h^{4}+\dots +K_{s}h^{2s}+\mathcal{O}(h^{2s+1})$$
כאשר ${K}_{1}=-\dfrac{f''({\xi}_{1})}{12}(b-a)$, וכנ"ל גם שאר ה-$K$-ים קבועים התלויים בנגזרות גבוהות יותר של $f$, אבל לא ב-$h$.

נראה כי עם מידע זה, נוכל לשפר את שיטת הטרפזים שלנו לסדר שגיאה של $h^{4}$, במקום $h^{2}$. למעשה, נוכל להמשיך ולחזור על אותה פעולה כדי להקטין עוד יותר את השגיאה שלנו, כאשר כל פעם אנחנו מקזזים את השגיאה הקודמת שלנו ואנו נשארים עם שגיאה פי $h^{2}$ יותר קטנה.

נדגים את השלב הראשון. עבור אינטגרל:
$$I_{f}=\int_{a}^{b}f(x)  \, \mathrm{d}x $$
נסמן:
$${h}_{1}=h=b-a,\, \quad {h}_{2}=\dfrac{h}{2}$$
שיטת הטרפזים, פעם על $[a,b]$, ופעם השיטה המרוכבת עם שני קטעים:
$$\begin{aligned}
 & R_{1}=\dfrac{{h}_{1}}{2}(f(a)+f(b)) \\
 & R_{2}=\dfrac{{h}_{2}}{2}(f(a)+2f(a+{h}_{2})+f(b))
\end{aligned}$$
השגיאות המתאימות:
$$\begin{aligned}
 & E_{1}=I_{f}-R_{1}={K}_{1}h^{2}+{K}_{2}h^{4}+{K}_{3}h^{6}+\dots  \\
 & E_{2}=I_{f}-R_{2}={K}_{1}\left( \dfrac{h}{2} \right)^{2}+{K}_{2}\left( \dfrac{h}{2} \right)^{4}+{K}_{3}\left( \dfrac{h}{2} \right)^{6}+\dots
\end{aligned}$$
נשים לב כי:
$$\begin{aligned}
E_{1} & = 4E_{2}+\dfrac{3}{4}{K}_{2}h^{4}+\dfrac{15}{16}{K}_{3}h^{6}+\dots \\[1ex]
 & =4E_{2}+\mathcal{O}(h^{4})
\end{aligned} \tag{1}$$
וגם, מהגדרת השגיאה:
$$\begin{aligned}
 & E_{1}=I_{f}-R_{1} \\
 & E_{2}=I_{f}-R_{2}
\end{aligned}\implies E_{1}-4E_{2}=(4R_{2}-R_{1})-3I_{f} \tag{2}$$
נחסר בין $(1)$ ו-$(2)$ ונקבל כי:
$$I_{f}= \dfrac{4R_{2}-R_{1}}{3}-\dfrac{1}{4}K_{2}h^{4}-\dfrac{5}{16}{K}_{3}h^{6}+\dots $$
קיבלנו כאן את **שיטת רומברג**:
$$I_{f}\approx \boxed {
I_{\text{Rom-trap}}=\dfrac{4R_{2}-R_{1}}{3}
 }$$
נוכל לבצע את אותו האקסטרפולציה גם לשיטת סימפסון ונסיק כי:
$$\boxed {
I_{\text{Rom-Simp}}=\dfrac{16R_{2}-R_{1}}{15}
 }$$

נוכל גם להמשיך ולחזור על הפעולה כדי לקבל דיוק יותר גבוה.
באופן כללי, אקסטרפולציית ריצ'רדסון היא:
$$\boxed {
I_{\text{Richardson}}=\dfrac{2^{n}{R}(h/2)-{R}(h)}{2^{n}-1}
 }$$
 כאשר $n$ הוא סדר השגיאה של השיטה *המוכללת*.