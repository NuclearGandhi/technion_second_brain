---
aliases:
  - מערכת משוואות לא לינארית
  - שיטת ניוטון למערכת משוואות
---
# שיטת ניוטון למערכת משוואות לא לינאריות
נביט במערכת של $n$ משוואות לא לינאריות ב-$n$ נעלמים:
$$\bar{f}(\bar{x})=\bar{0}$$
כאשר:
$$\bar{x}=\begin{pmatrix}
{x}_{1} \\{x}_{2} \\\vdots \\ x_{n}
\end{pmatrix},\, \quad \bar{f}(\bar{x})=\begin{pmatrix}
{f}_{1} (\bar{x})\\{f}_{2} (\bar{x})\\ \vdots \\ f_{n}(\bar{x})
\end{pmatrix}$$

בכתיב אינקדסי:
$$f_{i}({x}_{1} ,{x}_{2} ,\dots ,x_{n})=0,\, \quad i=1,2,\dots ,n$$

זוהי הכללה של המקרה:
$$f(x)=0$$
>[!example] דוגמה: 
> יהיו ${f}_{1}$ ו-${f}_{2}$ שתי פונקציות המקיימות:
> $${f}_{1} ({x}_{1} ,{x}_{2} )={x}_{1} ^{2}-2{x}_{1} -{x}_{2} +1 \quad \quad {f}_{2} ({x}_{1} ,{x}_{2} )={x}_{1} ^{2}+x{s}_{2} ^{2}-1$$
> המשוואה ${f}_{1}({x}_{1},{x}_{2})=0$ מתארת פרבולה, והמשוואה ${f}_{2}({x}_{1},{x}_{2})=0$ מתארת עיגול:
> ![[Screenshot_20240218_135321_OneDrive.jpg|book|300]]
> ישנם שורשים למערכת המשוואות:
> $$\begin{aligned}
&{x}_{1} ^{2}-2x^{2}-{x}_{2} +1=0 \\
&{x}_{1} ^{2}+{x}_{2} ^{2}-1=0
\end{aligned}$$
שורשים אלה הם נקודות החיתוך $\bar{x}^{*(1)}=(1,0)^{T}$ ו-$\bar{x}^{*(2)}=(0,1)^{T}$

נניח של-$\bar{f}$ יש נגזרות לפחות עד סדר שני. כמו במשוואות לא לינאריות במשתנה יחיד, למערכת משוואות לא לינאריות לרוב יש מספר פתרונות. בנוסף, כמו מ[[NUM1_004 שיטות איטרטיביות לפתרון מערכות לינאריות#שיטות איטרציה קבועות ושיטות הרפיה|קודם]], נחפש שיטה איטריבית לפתרון משוואות לא לינאריות.
נתחיל מניחוש ${x}_{0}$, כך שהשיטה תניב סדרה של איטרציות ${x}_{1},{x}_{2},\dots$ שבתקווה תתכנס לפתרון $\bar{x}^{*}$ המקיים $\bar{f}(\bar{x}^{*})=\bar{0}$.

מערכת משוואות לא לינאריות יכולות להיות הרבה יותר מסובכות לפתרון מאשר משוואה לא לינארית אחת במשתנה אחד. בכל זאת, הרבה שיטות כמו [[NUM1_005 משוואות לא לינאריות במשתנה אחד#אלגוריתם שיטת ניוטון|שיטת ניוטון]], ניתנות להכללה למקרה שאנו עוסקים בו.

הבעיה היא ששיטת ניוטון המוכללת תעבוד לנו עבור $\bar{x}_{0}$ מאוד קרוב ל-$\bar{x}^{*}$.

## טור טיילור לפונקציות וקטוריות

כדי להתחיל בהכללה לשיטת ניוטון, נצטרך הכללה לטור טיילור, כאשר נשים לב שאנחנו נעסוק במקרה בו $n=m$:

ניזכר ב[[CAL2_008 טיילור 2.0#משפט טיילור לפונקציה בשני משתנים|טיילור בשני משתנים]]. נוכל להכליל אותו עוד יותר עבור מערכת עם $m$ משוואות ב-$n$ משתנים (פונקציה וקטורית $\mathbb{R}^{n}\to \mathbb{R}^{m}$).
>[!theorem] משפט: 
 >יהי $\bar{x}=({x}_{1},{x}_{2},\dots,x_{n})^{T}$ ו-$\bar{f}({f}_{1},{f}_{2},\dots,f_{m})^{T}$, ונניח כי $\bar{f}(\bar{x})$ בעל נגזרות מסדר שני לפחות. אזי, לוקטור כיוון $\bar{p}=({p}_{1},{p}_{2},\dots,p_{n})^{T}$, הקירוב טיילור לכל פונקציה $f_{i}$ בכל רכיב $x_{j}$ היא:
>$$\bar{f}(\bar{x}+\bar{p})=\bar{f}(\bar{x})+J(\bar{x})\bar{p}+\mathcal{O}(\| \bar{p}\|_{} ^{2})$$
>כאשר $J(\bar{x})$ הוא ה[[CAL2_011 אינטגרל רב ממדי#מטריצת היעקוביאן|יעקוביאן]] של $\bar{f}(\bar{x})$:
>$$J=\begin{pmatrix}
\dfrac{ \partial {f}_{1}  }{ \partial {x}_{1}  }  & \dfrac{ \partial {f}_{1}  }{ \partial {x}_{2}  }  & \dots  & \dfrac{ \partial {f}_{1}  }{ \partial x_{n} }  \\
\dfrac{ \partial {f}_{2}  }{ \partial x_{1} }  & \dfrac{ \partial {f}_{2}  }{ \partial {x}_{2}  }  & \dots  & \dfrac{ \partial f_{2} }{ \partial {x}_{n}  } \\
\vdots  & \vdots  & \ddots  & \vdots  \\
\dfrac{ \partial f_{m} }{ \partial x_{1} }  & \dfrac{ \partial f_{m} }{ \partial {x}_{2}  }  & \dots  & \dfrac{ \partial f_{m} }{ \partial x_{n} }  
\end{pmatrix}$$
לכן, נקבל בכתיב אינדקסי:
$$f_{i}(\bar{x}+\bar{p})=f_{i}(\bar{x})+\sum_{j=1}^{n} \dfrac{ \partial f_{i} }{ \partial x_{i} } p_{j}+\mathcal{O}(\| \bar{p}\|_{} ^{2}),\, \quad i=1,\dots ,m$$

נשים לב שלא רשמנו את הביטוי לשארית החלק מהנגזרת השנייה, ופשוט הסתפקנו בקיצור $\mathcal{O}(\| p\|_{}^{2})$. כמו בשיטת ניוטון למשתנה אחד, אנחנו נתעלם מביטוי זה כי הוא מאוד מסובך, ועדיף כבר שלא נחשב אותו.

כדי לקבל טיפה יותר אינטואיציה לנוסחה שרשמנו, נצייר את $\bar{x}$ ו-$\bar{p}$ על גרף:

![[Pasted image 20240218212416.png|book|300]]
פיתוח טיילור שרשמנו נותן לנו קירוב יחסית די טוב למהו ערך $\bar{f}(\bar{x}+\bar{p})$ בעזרת $\bar{f}(\bar{x})$ וה"נגזרת" של $\bar{f}$ -שהיא היעקוביאן. במילים אחרות, אם אני נמצא על משטח משופע, כמו גבעות גורל, בנקודה $\bar{x}$, טור טיילור נותן קירוב יחסית טוב למיקום שלי אם אני אלך בכיוון $\bar{p}$, והוא כמובן צריך לעשות זאת בעזרת *כל* השיפועים השונים שיש מסביבי - יעני היעקוביאן.


## פיתוח שיטת ניוטון
נחזור למערכת משוואות לא לינאריות:
$$\bar{f}(\bar{x})=\bar{0}$$
נתחיל מניחוש התחלתי $\bar{x}_{0}$. נחשב סדרה של קירובים $\bar{x}_{1},\bar{x}_{2},\dots$ כאשר $\bar{x}_{k+1}$ מחושב ע"י פיתוח טיילור עד הנגזרת הראשונה. לכן, ב-$\bar{x}=\bar{x}_{k}$, אם היינו יודעים $\bar{p}=\bar{p}^{*}=\bar{x}^{*}-\bar{x}_{k}$, אז עבור $\bar{p}^{*}$ מאוד קטן:
$$\bar{0}=\bar{f}(\bar{x}_{k}+\bar{p}^{*})\approx \bar{f}(\bar{x}_{k})+J(\bar{x}_{x})\bar{p}^{*}$$
ברור שאנחנו לא יודעים מהו $\bar{p}^{*}$ כי אנחנו לא יודעים מהו $\bar{x}^{*}$, אבל אנחנו יכולים להשתמש במשוואה שרשמו כדי *להגדיר* את $\bar{p}=\bar{p}_{k}$ כאשר אנחנו דורשים:
$$\bar{f}(\bar{x}_{k})+J(\bar{x}_{k})\bar{p}_{k}=\bar{0}$$

לפיכך, נקבל את האלגוריתם הבא:
### #אלגוריתם: שיטת ניוטון למערכת משוואות לא לינאריות
עבור $k=0,1,\dots$ עד שנגיע להתכנסות:
- נפתור $J(\bar{x}_{k})\bar{p}_{k}=-\bar{f}(\bar{x}_{k})$ כדי למצוא את $\bar{p}_{k}$.
- נציב $\bar{x}_{k+1}=\bar{x}_{k}+\bar{p}_{k}$.

ב-`MATLAB`:
```matlab
% function [x,k] = newtons(f,x,tol,nmax)
%
% This function returns in x a column vector x_k such that
% || x_k - x_{k-1} || < tol (1 + ||x_k||)
% and in k the number of iterations (Jacobian evaluations) required.
% On entry, x contains an initial guess.
% If k equals nmax then no convergence has been reached.
%
% The iterates ||f(x_k)|| are recorded. This option
% can be easily turned off
function [x,k] = newtons(f,x,tol,nmax)
	%Initialize
	x = x(:); % ensure x is a column vector
	fprintf ('k ||f(x_k)|| \n')
	format long g
	
	%Newton
	for k=1:nmax
		[fx,Jx] = feval(f,x);
		fprintf ('%d %e \n',k-1,norm(fx) )
		p = -Jx \ fx;
		x = x + p;
		if norm(p) < tol*(1+norm(x))
			fx = feval(f,x);
			fprintf ('%d %e \n',k,norm(fx) )
			return
		end
	end
	k = nmax;
end
```