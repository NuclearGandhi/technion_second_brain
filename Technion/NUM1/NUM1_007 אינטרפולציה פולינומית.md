---
aliases:
  - אינטרפולנט
  - אינטרפולציה
  - אינטרפולציה פולינומית
  - פונקציית בסיס
  - מטריצת ודנרמונד
  - אינטרפולציית לגראנז'
  - פולינום לגראנז'
  - ערכי נרמול
---

# מבוא

**אינטרפולציה** היא מקרה פרטי של קירוב. היא יודעת לתת לנו ערך שלא מדדנו (למשל מניסוי), בהינתן מדידות קרובות מספיק (כמו ב[[THE1_002 חישוב תכונות מערכת#אינטרפולציה לינארית|בטבלאות קיטור]]. סוג אחר של אינטרפולציה יודעת לבצע קירובים של פונקציות מסובכות, כמו למשל [[CAL1_006 פולינום טיילור#פולינום טיילור|טיילור]].

**אינטרפולציה פולינומית** היא בסיס לאלגוריתמים יותר מסובכים בגזירה, אינטגרציה, פתרון משוואות דיפרנציאליות ותחומים אחרים. לכן, אינטרפולציה פולינומית היא פעולה חשובה שחוזרת שמופיעה המון.

# קירוב כללי ואינטרפולציה

ניתן להבדיל שיטות קירוב לשני סוגי בעיות:
1. **התאמת נתונים**:
	בהינתן קבועה של נקודות $\{ (x_{i},y_{i}) \}^{n}_{i=0}$, מצאו פונקציה *סבירה* $v(x)$ שמתאימה לנקודות אילו. אם הנקודות הנתונות הן נקודות מדויקות (ולא קירובים כלשהם), נדרוש ש-$v(x)$ תהיה **אינטרפולציה** של הנתונים. כלומר, שהפונקציה תעבור בדיוק בנקודות:
	$$v(x_{i})=y_{i},\, \quad i=0,1,\dots ,n$$
	![[Pasted image 20240223224556.png|book|550]]
2. **קירובי פונקציות**:
	עבור פונקציה מסובכת $f(x)$, מצאו פונקציה $v(x)$ שמהווה קירוב ל-$f(x)$. למשל, אם נצטרך למצוא מהר קירוב טוב של הערך $\sin(1.2)$, רק עם מחשבון פרימיטיבי, האם יש פונקציה אחרת שנותנת ערך מספיק קרוב ל-$\sin(1.2)$?

## אינטרפולנט והצגתו

לרוב, נניח צורה לינארית לכל הפונקציות אינטרפולציה $v(x)$. כלומר:
$$v(x)=\sum_{j=0}^{n}c_{j}\phi_{j}(x)={c}_{0} \phi_{0}(x)+\dots +c_{n}\phi_{n}(x) $$

ל-$v(x)$ אנו קוראים **אינטרפולנט**, $\{ c_{j} \}^{n}_{j=0}$ הם מקדמים לא ידועים שנוכל לחשב מנתונים, ול-$\{ \phi_{j}(x) \}^{n}_{j=0}$ נקרא **פונקציות בסיס**.

בנוסף, אנו נניח כי פונקציית בסיס הן [[ALG1_005 מרחבים וקטוריים#תלות לינארית|בלתי תלויות לינארית]]. לפיכך, אם $v(x)\equiv 0$, אז בהכרח $c_{j}=0$ לכל $1\leq j\leq n$.
נשים לב כי אנו מניחים גם שמספר הפונקציות בסיס שווה למספר הנקודות הנתונות, $n+1$. אם ישנם פחות פונקציות בסיס מנקודות נתונות, אנו נבצע את שיטת הריבועים הפחותים שנלמד בהמשך.

ככלל, נוכל לרשום את התנאים על האינטרפולציה בצורת מערכת משוואות לינארית:
$$\left( \begin{array}{}
{\phi}_{0} ({x}_{0} ) & \phi_{1}({x}_{0} ) & {\phi}_{2} ({x}_{0} ) & \dots  & \phi_{n}(x_{0}) \\
{\phi}_{0}({x}_{1} ) & {\phi}_{1} ({x}_{1} ) & {\phi}_{2} ({x}_{1} ) & \dots  & \phi_{n}({x}_{1} ) \\
\vdots  & \vdots  & \vdots  & \ddots  & \vdots  \\
\phi_{0}({x}_{n} ) & {\phi}_{1} (x_{n}) & {\phi}_{2} (x_{n}) & \cdots  & \phi_{n}(x_{n})
\end{array} \right)\begin{pmatrix}
{c}_{0}  \\
{c}_{1}  \\
\vdots  \\
c_{n}
\end{pmatrix}=\begin{pmatrix}
{y}_{0}  \\
{y}_{1}  \\
\vdots  \\
y_{n}
\end{pmatrix}$$

הנה מספר סוגים שונים של אינטרפולנטים:
- אנו נעסוק **באינטרפולציה פולינומית**:
	$$v(x)=\sum_{j=0}^{n}c_{j}x^{j}={c}_{0} +{c}_{1} x^{1}+{c}_{2} x^{2}+\dots +c_{n}x^{n} $$
	כלומר, פונקציות הבסיס שלנו הן:
	$$\phi_{j}(x)=x^{j},\, \quad j=0,1,\dots ,n$$
- עוד סוג הוא **אינטרפולציה טריגונומטרית**:
	$$\phi_{j}(x)=\cos(jx),\, \quad j=0,1,\dots ,n$$

# אינטרפולציה פולינומית
נסמן את האינטרפולנט הפולינומי עד סדר $n$ ב-:
$$p(x)=p_{n}(x)=\sum_{j=0}^{n}c_{j}x^{j}=c_{0}+{c}_{1} x+\dots +c_{n}x^{n} $$
עבור $n+1$ נקודות מידע:
$$({x}_{0} ,{y}_{0} ),\, ({x}_{1} ,{y}_{1} ),\, \dots ,\, (x_{n},y_{n})$$
אנו רוצים למצוא $n+1$ מקדמים ${c}_{0},{c}_{1},\dots,c_{n}$ כך ש:
$$p(x_{i})=y_{i},\, \quad i=0,1,\dots ,n$$
בנוסף, נניח ש:
$$x_{i}\neq x_{j} \quad \text{whenever} \quad i\neq j$$

>[!example] דוגמה: 
 >יהי $n=1$, והנקודות:
 >$$({x}_{0} ,{y}_{0} )=(1,1),\, \quad ({x}_{1} ,{y}_{1} )=(2,3)$$
 >אנו רוצים למצוא פולינום מסדר לכל היותר $1$ מהצורה:
 >$${p}_{1} (x)={c}_{0} +{c}_{1} x$$
 >העובר בין שני הנקודות.
 >לכן, התנאים הם:
 >$$\begin{gather}
{p}_{1} ({x}_{0} )={c}_{0} +1{c}_{1} =1 \\
{p}_{1} ({x}_{1} )={c}_{0} +2{c}_{1} =3
\end{gather}$$
> נוכל בקלות לפתור את המערכת המשוואות הזאת כדי לקבל:
> $$\begin{gather}
{c}_{0} =-1 \\
{c}_{1} =2
\end{gather}$$
>לכן:
>$${p}_{1} (x)=2x-1$$
>![[Pasted image 20240224094150.png|book|450]]
>אם $n=2$, והנקודות הן:
>$$(1,1),\, (2,3),\, (4,3)$$
>שתי הנקודות הראשונות הן אותן נקודות ממקודם. התנאים שלנו על האינטרפולנט:
>$$\begin{aligned}
&{p}_{2} ({x}_{0} )={c}_{0} +1{c}_{1} +1{c}_{2} =1 \\
&{p}_{2} ({x}_{1} )={c}_{0} +2{c}_{1} +4{c}_{2} =3 \\
 & {p}_{2} ({x}_{2} )={c}_{0} +4{c}_{1} +16{c}_{2} =3
\end{aligned}$$
הפתרון למערכת משוואות זו הוא:
$${c}_{0} =-\dfrac{7}{3},\, \quad {c}_{1} =4,\, \quad {c}_{2} =-\dfrac{2}{3}$$
ונקבל:
$${p}_{2} (x)=\dfrac{1}{3}(-2x^{2}+12x-7)$$


## מטריצת ונדרמונד
נרשום את התנאים על האינטרפולנט הפולינומי בצורה מטריציונית:
$$\begin{pmatrix}
1 & {x}_{0}  & {x}_{0} ^{2} & \cdots  &{x}_{0} ^{n} \\
1 & {x}_{1}  & x_{1}^{2} & \cdots  & {x}_{1} ^{n} \\
\vdots  & \vdots  & \vdots  & \ddots  & \vdots  \\
1 & x_{n} & x_{n}^{2} & \cdots  & x_{n}^{n}
\end{pmatrix}\begin{pmatrix}
{c}_{0}  \\
{c}_{1}  \\
\vdots  \\
c_{n}
\end{pmatrix}=\begin{pmatrix}
{y}_{0}  \\
{y}_{1} \\
\vdots  \\
y_{n}
\end{pmatrix}$$
המטריצה נקראת **מטריצת ונדרמונד ($V$)**, ויש לה דטרמיננטה [[ALG1_008 הדטרמיננטה#דטרמיננטת ונדרמונד|מיוחדת]]:
$$\det(V)=\prod_{\begin{gather}
i,j=1 \\
i>j
\end{gather}}^{n}(x_{i}-x_{j})$$
ביטוי זה אומר שהדטרמיננטה של מטריצה זו הוא המכפלה של כל ההפרשים השונים ב-$x_{i}$. לכן, כל עוד $x_{j}\neq x_{i}$ לכל $i\neq j$, מתקיים $\det(V)\neq 0$. מכך נסיק שהמטריצה [[ALG1_009 טרנספורמציות לינאריות#סינגולריות|לא סינגולרית]], יעני הפיכה. לפיכך, מתקיים המשפט הבא:
>[!theorem] משפט: 
 >לכל קבוצת נקודות $\{ (x_{i},y_{i})^{} \}^{n}_{i=0}$ כך ש- $x_{i}\neq x_{j}$ לכל $i\neq j$, ישנו פולינום יחיד $p(x)$ מסדר לכל היותר $n$ שמקיים את תנאי האינטרפולציה:
 >$$p(x_{i})=y_{i},\, \quad i=0,1,\dots ,n$$
 
# אינטרפולציית לגראנז'

נביט באינרפולנט שמקיים את התכונה הנחמדה $c_{j}=y_{j}$. כלומר, המקדמים של הפולינום $p(x)$ מקושרים ישירות לערכי הנקודות $y_{j}$:
$$p(x)=p_{n}(x)\sum_{j=0}^{n}y_{j}\phi_{j}(x) $$

הפונקציות בסיס נתונות ע"י **אינטרפולציית לגראנז'**. באינטרפולציה זו אנו מגדירים את **פולינומי לגראנז'** שהם פולינומים מסדר $n$ המקיימים:

$$L_{j}(x_{i})=\begin{cases}
0 &  & i\neq j \\
1 & &  i=j
\end{cases}$$

כעת נוכל לרשום את האינטרפולנט:
$$p(x)=\sum_{j=0}^{n}y_{j}L_{j}(x) $$
אינטרפולנט זה אין מקיים את התנאים שמוצבים עליו:
$$p(x_{i})=\sum_{j=0}^{n}y_{j}L_{j}(x_{i})=0+\dots +0+y_{i}L_{i}(x_{i})+0+\dots +0\overset{\checkmark }{=}y_{i} $$

>[!example] דוגמה: 
 >ניקח את אותם הנקודות מהדוגמה הקודמת:
 >$$(1,1),\, (2,3),\, (4,3)$$
 >נבנה את פולינומי לגראנז' ${L}_{0},{L}_{1},{L}_{2}$. לפי ההגדרה שלהם, נדרוש ש:
 >$$\begin{gather}
{L}_{0}({x}_{0} )=1 \\
{L}_{0} ({x}_{1} )=0 \\
{L}_{0} ({x}_{2} )=0
\end{gather}$$
>או בקיצור, נדרוש ש-${L}_{0}$ ייתאפס בנקודות $x={x}_{2}=4$ ו-$x={x}_{1}=2$. לכן הוא יהיה מהצורה:
>$${L}_{0}(x)=a(x-2)(x-4)$$
>נוסיף את הדרישה ש-${L}_{0}({x}_{0})=1$. נקבל ש- $a(1-2)(1-4)=1$, כלומר ש- $a=\dfrac{1}{3}$. נציב:
>$${L}_{0}(x)=\dfrac{1}{3}(x-2)(x-4)$$
>באותו אופן נסיק ש:
>$$\begin{aligned}
&{L}_{1}(x)=-\dfrac{1}{2}(x-1)(x-4) \\
&{L}_{2}(x)=\dfrac{1}{6}(x-1)(x-2)
\end{aligned}$$
>אם נסכום את כל הפולינומי לגראנז', נקבל את האינטרפולנט:
>$${p}_{2} (x)=\dfrac{1}{3}(-2x^{2}+12x-7)$$
>![[NUM1_007 אינטרפולציה פולינומית 2024-02-24 11.09.14.excalidraw.svg|book|450]]
>%%[[NUM1_007 אינטרפולציה פולינומית 2024-02-24 11.09.14.excalidraw|🖋 Edit in Excalidraw]]%%

## תכונות פולינומי לגראנז'
במקרה הכללי בו יש $n+1$ נקודות נתונות, הפולינומי לגראנז' קיימים באופן יחיד, כי הם בעצמם אינטרפולציה פולינומית לנתונים מיוחדים. נוכל לרשום את הפולינום בצורה מפורשת:
$$L_{j}(x)=\dfrac{(x-{x}_{0} )\cdots (x-x_{j-1})(x-x_{j+1})\cdots (x-x_{n})}{(x_{j}-x_{0})\cdots (x_{j}-x_{j-1})(x_{j}-x_{j+1})\cdots (x_{j}-x_{n})}=\prod_{\substack{
i=0 \\
i\neq j}
}^{n} \dfrac{(x-x_{i})}{(x_{j}-x_{i})}$$

קל יותר לראות למה זה נכון אם חוזרים על הדוגמה הקודמת ורואים שזה אחד לאחד הפעולות שביצענו.
במונה יש לנו פולינום ממעלה $n$ שמתאפס בכל הנקודות (מהנתונים) שמקיימות $x\neq x_{j}$. במכנה, אנחנו בעצם מנרמלים את הפולינום הזה כך שנקבל $L_{j}(x_{j})=1$
![[Pasted image 20240224113052.png|book|450]]
> פולינום לגראנז' כלשהו עבור $n=5$.

## חישוב האינטרפולנט
נראה כעת איך עלינו לחשב את האינטרפולנט בצורה אפקטיבית. נחשב ונסמן:
$$\rho_{j}=\prod_{i\neq j}(x_{j}-x_{i}),\, \quad w_{j}=\dfrac{1}{\rho_{j}},\, \quad j=0,1,\dots ,n$$
כאשר ל-$w_{j}$ אנו קוראים **ערכי הנרמול**. נשים לב שחישוב זה דורש $n^{2}$ פעולות.

עבור נקודה $x$ שלא נמצאת כחלק מהנתונים, נרצה לחשב את $p(x)$.
נסמן את המונה של $L_{j}(x)$ כפונקציית עזר $\psi(x)$.
$$\psi(x)=(x-{x}_{0} )\cdots (x-x_{n})=\prod_{i=0}^{n}(x-x_{i})$$
>[!Question]- מה עם $i\neq j$? 
>ברור אז ש-$\psi(x)$ הוא לא *בדיוק* המונה של $L_{j}(x)$. אל דאגה, אנחנו מתייחסים לזה. אנו עושים את זה כדי שנוכל להוציא את $\psi(x)$ מסכימה שנראה בהמשך.

אז נוכל לרשום את פולינום לגראנז' בצורה:
$$L_{j}(x)=\dfrac{\psi(x)}{(x-x_{j})}\cdot w_{j}$$
לפיכך, האינטרפולנט נתון ע"י:
$$\begin{aligned}
p(x)&=\sum_{j=0}^{n}y_{j}L_{j}(x) \\
&=\psi(x)\sum_{j=0}^{n} \dfrac{w_{j}y_{j}}{(x-x_{j})} 
\end{aligned}$$
חישוב זה הוא בסיבוכיות $O(n)$.


### #אלגוריתם: אינטרפולציית לגראנז'
1. בהינתן נתונים $\{ (x_{i},y_{i}) \}^{n}_{i=0}$, נחשב את ערכי הנרמול:
	$$w_{j}=\dfrac{1}{\prod_{i\neq j}(x_{j}-x_{i})}$$
	והמכפלות $w_{j}y_{j}$ עבור $j=0,1,\dots,n$.
2. בהינתן נקודה $x$ שאנו רוצים לחשב אותה, והיא לא חלק מהנתונים, נחשב:
	$$p(x)=\psi(x)\sum_{j=0}^{n} \dfrac{w_{j}y_{j}}{(x-x_{j})} $$

# שגיאה באינטרפולציה פולינומית
נרצה לשער מהי השגיאה של $p_{n}(x)$ ביחס לפונקציה האמיתית $f(x)$ שמתארת את הנקודות $\{ ({x}_{i},{y}_{i}) \}^{n}_{i=0}$. נבטא את השגיאה:
$$e_{n}(x)=f(x)-p_{n}(x)$$

ניתן להראות כי השגיאה עבור אינטרפולציה כזאת היא [[CAL1_006 פולינום טיילור#משפט טיילור|שארית לגראנז']]:
>[!theorem] משפט: 
 >אם $p_{n}$ היא אינטרפולציה של $f$ ב-$n+1$ נקודות ${x}_{0},\dots,x_{n}$, ול-$f$ יש $n+1$ נגזרות בקטע $[a,b]$ המכיל את נקודות אילו, אז לכל $x \in[a,b]$ ישנה נקודה $\xi\in(a,b)$ כך ש:
 >$$e_{n}(x)=f(x)-p_{n}(x)= \dfrac{f^{(n+1)}(\xi)}{(n+1)!}\prod_{i=0}^{n}(x-x_{i})$$
 
 נשים לב כי אם המרווח $h$ שווה בין כל הנקודות:
 $$x_{i+1}-x_{i}=h$$
 אז מתקיים:
 $$\begin{aligned}
\left|\prod_{j=0}^{n}(x-x_{j})\right|&=|(x-x_{1})\cdots (x-x_{n})| \\
&\leq |h\cdot 2h\cdots nh| \\[1ex]
&\leq |h|\cdot|2h|\cdots |nh| \\[1ex]
&=n!h^{n}
\end{aligned}$$
ולכן נקבל שהשגיאה שלנו חסומה:
$$|e_{n}(x)|=|f(x)-p_{n}(x)| \leq  \dfrac{h^{n}}{n+1}\left|f^{(n+1)}(\xi)\right|$$

---
**תרגיל**:
חשבו את פולינום האינטרפולציה של לגראנז' מסדר שני ${p}_{2}(x)$ עבור הנתונים:
$$(0,0),\, (2,0.9093),\, (4,-0.7568)$$
הביאו את הפולינום לצורה:
$${p}_{2} (x)={a}_{0} +{a}_{1} x+{a}_{2} x^{2}$$
**פתרון**:
לפי הנוסחה:
$${p}_{2} (x)=\sum_{i=0}^{2}y_{i}L_{i}(x) $$
אז נחשב את פולינומי לגראנז':
$$\begin{aligned}
L_{0}(x)&=\prod_{\begin{gather}
j=0 \\
j\neq 0
\end{gather}}^{2}\left( \dfrac{x-x_{j}}{x_{0}-x_{j}} \right)=\dfrac{x-{x}_{1} }{{x}_{0} -{x}_{1} }\cdot \dfrac{x-{x}_{2} }{{x}_{0} -{x}_{2} } \\
&= \dfrac{x-2}{0-2}\cdot \dfrac{x-4}{0-4}= \dfrac{x^{2}-6x+8}{8} \\
{L}_{1} (x) & = \dfrac{x-{x}_{0} }{{x}_{1} -{x}_{0}}\cdot \dfrac{x-{x}_{2} }{{x}_{1} -{x}_{2}  }=\dfrac{x^{2}-4x}{4} \\
{L}_{2}(x) & =\dfrac{x-{x}_{0} }{{x}_{2} -{x}_{0} }\cdot \dfrac{x-{x}_{1} }{{x}_{2} -{x}_{1} }=\dfrac{x^{2}-2x}{8}
\end{aligned}$$
נקבל כי:
$$\begin{aligned}
{p}_{2} (x)&=0\cdot \left( \dfrac{x^{2}-6x+8}{8} \right) \\
 & \quad \quad+0.9093\left(  \dfrac{x^{2}-4x}{-4} \right)--0.7568\left(  \dfrac{x^{2}-2x}{8} \right) \\
&=\boxed{-0.321925x^{2}+1.0985x }
\end{aligned}$$

---

# אינטרפולציה הפוכה

נרצה לפעמים לעשות את הפעולה ההפוכה מאינטרפולציה. כלומר, במקום למצוא את הערך $y$ עבור $x$ כלשהו, נרצה למצוא את הערך $x$ עבור $y$ מסוים.

למשל, עבור הנקודות:
$$\begin{array}{c|c}
y_{i} & 0.7001 & 0.4016 & 0.1081 & -0.1744 & -0.4375 \\
\hline x_{i} & 0.1 & 0.2 & 0.3 & 0.4 & 0.5 
\end{array}$$
נרצה לדעת עבור איזה $x$ נקבל $y=0$?
כל מה שעלינו לעשות זה להחליף בסימונים בין $x$ ל-$y$ בשיטת האינטרפולציה שלנו. אז עבור אינטפולציית לגראנז':
$${p}_{1} (y)=\sum_{i=0}^{1}x_{}L_{i}(y)={x}_{0} {L}_{0} (y)+{x}_{1} {L}_{1} (y) $$
הפולינומי לגראנז' שלנו (נבחר ${y}_{0}=0.1081$ ו-${y}_{1}=-0.1744$):
$$\begin{aligned}
 & {L}_{0} (y)=\dfrac{y-{y}_{1} }{{y}_{0} -{y}_{1}} =\dfrac{y+0.1744}{0.1081+0.1744}= \dfrac{y+0.1744}{0.2825} \\
 & {L}_{1} (y)= \dfrac{y-{y}_{0} }{{y}_{1} -{y}_{0} }=\dfrac{y-0.1081}{-0.2825}
\end{aligned}$$
לכן:
$${p}_{1} (0)=0.3\cdot \dfrac{0.1744}{-0.2825}+0.4\cdot \dfrac{-0.1081}{-0.2825}=0.3382655$$



