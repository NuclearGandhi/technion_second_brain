---
aliases: גזירה נומרית
---
# מבוא
למרות שאנו מכירים דרכים אנליטיות לחישוב נגזרות מחדו"א 1, ישנם סיבות לחשב אותן נומרית. אחת הסיבות היא אם אנו לא יודעים בוודאות מהו ה-$f$ שאנו רוצים לגזור, או ש-$f$ עצמה היא מסובכת מדי לגזירה אנליטית. אז למשל, גזירה נומרית היא פעולה מאוד נפוצה בחישוב [[../DEQ1/DEQ1_001 מבוא#משוואה דיפרנציאלית|משוואות דיפרנציאליות]]. כדי לקבל נוסחאות עבור גזירה נומרית, ניעזר ב[[../CAL1/CAL1_006 פולינום טיילור#פולינום טיילור|קירוב פולינומי]] של $f$.

# פיתוח שיטות בעזרת טור טיילור
מ[[../CAL1/CAL1_005 נגזרות#נגזרת|חדו"א 1]], הנגזרת של פונקציה $f$ בנקודה ${x}_{0}$ נתונה ע"י:
$$f'({x}_{0})=\lim_{ h \to 0} \dfrac{f({x}_{0}+h)-f({x}_{0})}{h}$$
הגדרה זו משתמשת בערכים של $f$ ליד נקודת הגזירה ${x}_{0}$. אז כדי לקבל נוסחה לחישוב הנגזרת, אנו לרוב נבחר נקודות במרחקים שווים $h$ ליד הנקודה, ונבנה קירוב של $f$ מנקודות אילו.

בהנחה ו-$f$ חלקה מספיק, ככל ש-$h$ קטן, השגיאה שלנו תקטן.

## שיטות בשתי נקודות
כאשר נפתח את $f$ לטור טיילור סביב ${x}_{0}$, נוכל לפתח **שיטות הפרשים** **לפנים** ו**לאחור**. למשל, בנוסחת הפרשים לאחור, נבחר $x={x}_{0}-h$ ונפתח לטיילור:
$$f({x}_{0}-h)=f({x}_{0})-hf'({x}_{0})+\dfrac{h^{2}}{2}f''(\xi),\, \quad {x}_{0}-h\leq \xi\leq {x}_{0}$$
נסדר ונקבל:
$$\boxed {
f'({x}_{0})=\dfrac{f({x}_{0})-f({x}_{0}-h)}{h}+\dfrac{h}{2}f''(\xi)
 }$$
בשיטה **לפנים** אנו נבחר $x={x}_{0}+h$ ונקבל:
$$\boxed{f'({x}_{0})=\dfrac{f({x}_{0}+h)-f({x}_{0})}{h} + \dfrac{h}{2}f''(\xi) }$$
כאשר ${x}_{0}\leq x\leq {x}_{0}+h$
נוכל להשתמש בשיטה לפנים פעמיים כדי לקבל את הנגזרת השנייה:
$$\boxed {
f''({x}_{0})=\dfrac{f({x}_{0}+2h)-2f({x}_{0}+h)+f({x}_{0})}{h^{2}}+\dfrac{h}{2}f'''(\xi)
 }$$
 כאשר ${x}_{0}\leq \xi\leq {x}_{0}+2h$.

## שיטה בשלוש נקודות
**שיטת הפרשים מרכזית** עבור $f'({x}_{0})$ ניתנת כאשר נפתח סביב $x={x}_{0}$ גם ב-$x={x}_{0}+h$ וגם ב-$x={x}_{0}-h$, כך שנקבל:
$$\begin{aligned}
 & f({x}_{0}+h)=f({x}_{0})+hf'({x}_{0})+\dfrac{h^{2}}{2}f''({x}_{0})+\dfrac{h^{3}}{6}f'''({\xi}_{1}) \\[2ex]
 & f({x}_{0}-h)=f({x}_{0})-hf'({x}_{0})+\dfrac{h^{2}}{2}f''({x}_{0})-\dfrac{h^{3}}{6}f'''({\xi}_{2})
\end{aligned}$$
נחסר בין שתי המשוואות, ונקבל:
$$\boxed {
f'({x}_{0})=\dfrac{f({x}_{0}+h)-f({x}_{0}-h)}{2h}-\dfrac{h^{2}}{6}f'''(\xi)
 }$$
כאשר ${x}_{0}-h\leq \xi\leq {x}_{0}+h$.
באותו אופן נוכל לקבל את הנגזרת השנייה מתוך שלוש נקודות:
$$\begin{aligned}
 & f({x}_{0}+h)=f({x}_{0})+hf'({x}_{0})+\dfrac{h^{2}}{2}f''({x}_{0})+\dfrac{h^{3}}{6}f'''({x}_{0})+\dfrac{h^{4}}{24}f^{(4)}({\xi}_{1}) \\[2ex]
 & f({x}_{0}-h)=f({x}_{0})-h'f({x}_{0})+\dfrac{h^{2}}{2}f''({x}_{0})-\dfrac{h^{3}}{6}f'''({x}_{0})+\dfrac{h^{4}}{24}f^{(4)}({\xi}_{2})
\end{aligned}$$
נחסר בין שני המשוואות ונקבל את **שיטת הפרשים מרכזית לנגזרת שנייה**:
$$\boxed{f''({x}_{0}) = \dfrac{f({x}_{0}-h)-2f({x}_{0})+f({x}_{0}+h)}{h^{2}}-\dfrac{h^{2}}{12}f^{(4)}(\xi)}$$

כאשר ${x}_{0}-h\leq \xi\leq {x}_{0}+h$.

>[!example] דוגמה: 
 >הטבלה הבאה מציגה את השגיאה עבור הגזירה הנומרית ($f'({x}_{0})$) של הפונקציה $f(x)=e^{x}$ בנקודה ${x}_{0}=0$, עם מרווחים $h=10^{-k},\,k=1,\dots,5$, בעזרת שיטות עם שתי נקודות, שלוש נקודות, וחמש נקודות (שלא למדנו ולא באמת צריך לדעת).
![[Pasted image 20240317165622.png|book]]
>
>>השגיאה של גזירה נומרית. משמאל לימין, מהעמודה השנייה, שגיאה בשני נקודות, שגיאה בשלוש נקודות, ושגיאה בחמש נקודות. הגרף מוצג בסקאלת log-log.
>
> נוכל גם להציג את התוצאות על גרף:
>![[Pasted image 20240317170141.png|book]]
>>שגיאה אמיתית של שלושת השיטות. שימו לב ששיפוע הגרף מציג לנו את סדר השגיאה ($m\approx1,2,4$).


# אקסטרפולציית ריצ'רדסון
בדומה ל[[NUM1_009 אינטגרציה נומרית#אינטגרציית רומברג|אינטגרציית רומברג]], נוכל לבצע את אקסטרפולציית ריצ'רדסון על שיטות נומריות לחישוב נגזרות כדי לקבל סדר שגיאה יותר גבוה.

נחשב את הנגזרת השנייה של $f$  ב-${x}_{0}$, פעם בעזרת $f(x\pm h)$ ופעם בעזרת $f(x\pm 2h)$:
$$\begin{aligned}
\mathrm{I}: \quad f''({x}_{0})  & = \dfrac{f({x}_{0}-h)-2f({x}_{0})+f({x}_{0}+h)}{h^{2}} \\[1ex]
 & \quad -\dfrac{h^{2}}{12}f^{(4)}({x}_{0})-\dfrac{h^{4}}{360}f^{(6)}({x}_{0})+\mathcal{O}(h^{5}) \\[3ex]
\mathrm{II}: \quad f''({x}_{0})  & = \dfrac{f({x}_{0}-2h)-2f({x}_{0})+f({x}_{0}+2h)}{4h^{2}} \\[1ex]
 & \quad -\dfrac{4h^{2}}{12}f^{(4)}({x}_{0})-\dfrac{16h^{4}}{360}f^{(6)}({x}_{0})+\mathcal{O}(h^{5})
\end{aligned}$$
נכפיל את הנוסחה הראשונה ב-$4$, נחסר את השנייה, ונחלק ב-$3$, כדי לקבל שיטה לחישוב נגזרת שנייה עם שגיאה מסדר $4$:
$$\begin{aligned}
f''({x}_{0}) & = \dfrac{1}{12h^{2}}\Big[(-f({x}_{0}-2h)+16f({x}_{0}-h)-30f({x}_{0})+16f({x}_{0}+h) \\
 & -f({x}_{0}+2h)\Big] + \dfrac{h^{4}}{90}f^{(6)}({x}_{0})+\mathcal{O}(h^{5})
\end{aligned}$$
נרשום בצורה הדומה לשיטות הקודמות:

$$\boxed {
\begin{aligned}
f''({x}_{0}) & = \dfrac{1}{12h^{2}}\Big[(-f({x}_{0}-2h)+16f({x}_{0}-h)-30f({x}_{0})+16f({x}_{0}+h) \\
 & -f({x}_{0}+2h)\Big] + \dfrac{h^{4}}{90}f^{(6)}(\xi)
\end{aligned}
 }$$
כאשר ${x}_{0}-2h\leq \xi\leq {x}_{0}+2h$.