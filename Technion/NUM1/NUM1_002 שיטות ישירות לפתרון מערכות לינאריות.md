---
aliases:
  - אלימינציית גאוס
  - שיטת תומאס למטריצות תלת אלכסוניות
  - פירוק LU
  - פירוק שולסקי
---

ישנם המון שיטות לפתירת מערכת משוואות לינארית.
נעבור על מספר שיטות, הסיבוכיות שלהן, והיתרונות והחסרונות של כל אחת.

# #אלגוריתם: שיטת האלימינציה של גאוס
- ניזכר ב[[ALG1_004 מערכות משוואות לינאריות|אלימינציה של גאוס]] מאלגברה לינארית.

בהינתן מערכת משוואות לינארית נוכל לרשום אותה בצורה הבאה:
$$A\bar{x}=\bar{b}$$

בשיטת האלימינציה של גאוס, אנחנו ראשית [[ALG1_004 מערכות משוואות לינאריות#אלגוריתם דירוג מטריצה|מדרגים את המטריצה]], ואז מבצעים חילוץ לאחור (backward sweep):
1. נרחיב את מטריצה $A$ בעוד עמודה שתכלול את ערכי $\bar{b}$:
	$$(A|\bar{b})=\left(\begin{array}{c c c c | c}
a_{11} & a_{12} & \dots  & a_{1n} & {b}_{1} \\
a_{21} & a_{22} & \dots  & a_{2n} & {b}_{2} \\
\vdots  & \vdots  & \ddots  & \vdots  & \vdots  \\
a_{n 1} & a_{n 2} &  \cdots  & a_{nn} & b_{n}
\end{array}\right)$$
2. נחליף את השורות באופן כזה שאיבר $a_{11}$ יהיה האיבר הגדול ביותר (בערכו המוחלט) בעמודה הראשונה.
3. ניצור עמודת אפסים מתחת לאיבר $a_{11}$ ע"י:
	- חיסור $\dfrac{a_{21}}{a_{11}}\times R_{1}$ מהשורה השנייה (כאשר ב-${r}_{1}$ הכוונה לשורה הראשונה).
	- חיסור $\dfrac{a_{31}}{a_{11}}\times R_{1}$ מהשורה השלישית.
	- $\vdots$
	- חיסור $\dfrac{a_{n 1}}{a_{11}}\times R_{1}$ מהשורה ה-$n$-ית.
	
	נקבל:
	$$(A^{(1)}|\bar{b}^{(1)})=\left(\begin{array}{c c c c | c}
	a_{11} & a_{12} & \dots  & a_{1n} & {b}_{1} \\
	0 & a_{22} & \dots  & a_{2n} & {b}_{2}^{(1)} \\
	\vdots  & \vdots  & \ddots  & \vdots  & \vdots  \\
	0 & a_{n 2} &  \cdots  & a_{nn} & b_{n}^{(1)}
	\end{array}\right)$$
1. נחזור על שלבים 2-3 על התת-מטריצה מסדר $(n-1)\times n$ של $(A^{(1)}|\bar{b}^{(1)})$ שמתקבלת אם נתעלם מהשורה והעמודה הראשונה שלה. כתוצאה מכך אנחנו נסיים את דירוג המטריצה ונקבל [[ALG1_003 מטריצות#מטריצה משולשת עליונה ותחתונה|מטריצה משולשת עליונה]]:
	$$(A^{(n-1)}|\bar{b}^{(n-1)})=\left(\begin{array}{c c c c | c}
	a_{11} & a_{12} & \dots  & a_{1n} & {b}_{1} \\
	0 & a_{22} & \dots  & a_{2n} & {b}_{2}^{(n-1)} \\
	\vdots  & \vdots  & \ddots  & \vdots  & \vdots  \\
	0 & 0 &  \cdots  & a_{nn} & b_{n}^{(n-1)}
	\end{array}\right)$$
5. נפתור עבור ${x}_{1},{x}_{2},\dots ,x_{n}$, כאשר נתחיל מהאיבר $x_{n}$ לפי הנוסחה הבאה:
	$$x_{i}=\dfrac{c_{i,n+1}-\sum _{j=i+1}^{n}c_{i,j}x_{j}}{c_{i,i}}$$
	כאשר $C$ היא המטריצה $(A^{(n-1)}|\bar{b}^{(n-1)})$.


ב-`pseudocode`:

```r
h := 1 /* Initialization of the pivot row */
k := 1 /* Initialization of the pivot column */

while h ≤ m and k ≤ n
    /* Find the k-th pivot: */
    i_max := argmax (i = h ... m, abs(A[i, k]))
    if A[i_max, k] = 0
        /* No pivot in this column, pass to next column */
        k := k + 1
    else
        swap rows(h, i_max)
        /* Do for all rows below pivot: */
        for i = h + 1 ... m:
            f := A[i, k] / A[h, k]
            /* Fill with zeros the lower part of pivot column: */
            A[i, k] := 0
            /* Do for all remaining elements in current row: */
            for j = k + 1 ... n:
                A[i, j] := A[i, j] - A[h, j] * f
        /* Increase pivot row and column */
        h := h + 1
        k := k + 1

```

כאשר סוכמים את מספר הפעולות שעושים בשיטה זו, מקבלים כי בסך הכל מבצעים $\dfrac{2n^{3}}{3}$ פעולות. לכן מסווגים את שיטת האלימינציה עם סיבוכיות $O(n^{3})$.

# #אלגוריתם: שיטת תומס למטריצות תלת אלכסוניות
>[!def] הגדרה: 
 >**מטריצה תלת אלכסונית** היא מטריצה מהצורה:
> $$\begin{pmatrix}
{d}_{1} & {c}_{1} &  \\
{a}_{2} & {d}_{2} & {c}_{2} &  \\
 & {a}_{3} & {d}_{3} & {c}_{3} &  \\
 &  & \ddots  & \ddots  & \ddots  \\
 &  &  & a_{n-1}  & d_{n-1} & c_{n-1} \\
 &  &   & & a_{n} & d_{n}
\end{pmatrix}$$
 
בהינתן מערכת משוואות $A\bar{x}=\bar{b}$ כך ש-$A$ היא מטריצה תלת אלכסונית, נוכל לפתור אותה בשיטת תומאס בסיבוכיות $O(n)$.

השיטה מורכבת משני שלבים:
1. שיטת הליכה לפנים (forward sweep):
	על השורה הראשונה נבצע:
	$$\begin{aligned}
{c}_{1}'\to \dfrac{{c}_{1}}{{d}_{1}} &  & b'_{1}\to \dfrac{{b}_{1}}{{d}_{1}}
\end{aligned}$$
	ועל כל שורה אחרת:
	$$\begin{aligned}
{c}_{i}\to  \dfrac{{c}_{i}}{b_{i}-a_{i}c'_{i-1}} &  & b'_{i}\to \dfrac{b_{i}-a_{i}b'_{i-1}}{d_{i}-a_{i}c'_{i-1}}
\end{aligned}$$
בסוף התהליך אנחנו נקבל מטריצה משולשת עליונה עם $1$-ים על האלכסון:
	$$A^{*}=\left(\begin{array}{cccccc|c}
	1 & {c}_{1} &  &  &  &  & b_{1}' \\
	 & 1 & {c}_{2} &   &  &  & b_{2}'\\
	 &  & 1 & {c}_{3} &  &  & b_{3}' \\
	 &  &   & \ddots  & \ddots   &  & \vdots \\
	 &  &  &  & 1 & c_{n-1}  & b_{n-1}'\\
	 &  &   & & & 1 & b_{n}'
	\end{array} \right)$$
2. נבצע חילוץ לאחור:
	נפתור עבור ${x}_{1},{x}_{2},\dots ,x_{n}$, כאשר נתחיל מהאיבר $x_{n}$ לפי הנוסחה הבאה:
	$$\begin{aligned} 
&x_{n}=b_{n}' \\
&x_{i}=b_{i}'-c_{i}'x_{i+1} \quad & i>1
\end{aligned}$$

# #אלגוריתם: פירוק LU
נביט בשלב השלישי של אלימיניציית גאוס. אנחנו מאפסים את כל האיברים מתחת ל-$a_{11}$, כאשר כל הפעולות שאנחנו עושים על השורות מתבצעות גם על העמודה הכי ימנית - וקטור $\bar{b}$. נשים לב שאת פעולות אלו אנחנו למעשה יכולים לעשות בזמן יותר מאוחר, כי הם לא משפיעות על המטריצה $A$.
את כל הפעולות האלו אנחנו יכולים לייצג בעזרת מטריצה משולשת עליונה (זה בעצם סוג של [[ALG1_007 מטריצות הפיכות#מטריצה אלמנטרית|מטריצה אלמנטרית]]):
$$M^{(1)}=\begin{pmatrix}
1 \\
-l_{21} & 1 \\
-l_{31} &  & 1 \\
\vdots  &  &  & \ddots  \\
-l_{n 1} &  &  &  & 1
\end{pmatrix}$$
כלומר, לאחר איפוס העמודה הראשונה, נוכל לרשום את המטריצה והוקטור שמתקבלים כך:
$$A^{(1)}=M^{(1)}A\quad \quad \bar{b}^{(1)}=M^{(1)}\underline{b}$$

באותו אופן נמשיך $n-1$ פעמים עד שנקבל את המטריצה המדורגת שלנו (מטריצה משולשת עליונה). נסמן אותה ב-$U$:
$$U=A^{(n-1)}=M^{(n-1)}\cdots M^{(2)}M^{(1)}A$$
באותו אופן עבור $\bar{b}$:
$$\bar{b}^{(n-1)}=M^{(n-1)}\cdots M^{(2)}M^{(1)}\bar{b}$$

אם נפעיל את הפעולות ההפוכות ($[M^{(1)}]^{-1},\,[M^{(2)}]^{-1},\dots$) על $U$ בחזרה, אנחנו נקבל את המטריצה המקורית שלנו, $A$:

$$A=[M^{(1)}]^{-1}\cdots [M^{(n-2)}]^{-1}[M^{(n-1)}]^{-1}U$$

נסמן את המכפלת מטריצות הארוכה ב-$L$:
$$L=[M^{(1)}]^{-1}\cdots [M^{(n-2)}]^{-1}[M^{(n-1)}]^{-1}$$
ונקבל:
$$A=LU$$
מה שביצענו כאן נקרא **פירוק LU** - פירקנו את המטריצה $A$ למכפלת מטריצה משולשת תחתונה במטריצה משולשת עליונה.
![[Pasted image 20240211200535.png|book]]


כדי להבין איך $L$ נראה, נשים לב ש-$[M^{(k)}]^{-1}$ בעל בדיוק אותה צורה כמו $M^{(k)}$, רק הפעם האיברים שלו ללא סימן המינוס. אז למשל עבור $M^{(2)}$, ההופכי שלו נראה כך:
$$[M^{(2)}]^{-1}=\begin{pmatrix}
1 \\
 & 1 \\
 & l_{32} & \ddots  \\
 & \vdots  &  & \ddots  \\
 & l_{n 2} &  &  & 1
\end{pmatrix}$$

לכן המכפלה של כל המטריצות האלו נראית כך:
$$L=\begin{pmatrix}
1 \\
l_{21} & 1 \\
l_{31} & l_{32} & 1 \\
\vdots  & \vdots  & \ddots  & \ddots  \\
l_{n 1} & l_{n 2} & \cdots  & l_{n,n-1}
\end{pmatrix}$$

סדר הפעולות עבור פירוק מטריצה $A$ הוא כך:
$$\begin{pmatrix}
{l}_{11} \\
l_{21} & l_{22} \\
l_{31} & l_{32} & l_{33}
\end{pmatrix}\begin{pmatrix}
1 & u_{12} & u_{13} \\
 & 1 & u_{23} \\
 &  & 1
\end{pmatrix}=\begin{pmatrix}
{\color{cyan} a_{11}} & {\color{cyan} a_{12}} & {\color{cyan} a_{13}} \\
{\color{cyan} a_{21}} & {\color{red} a_{22}} & {\color{red} a_{23}} \\
{\color{cyan} a_{31}} & {\color{red} a_{32}} & {\color{lime} a_{33}}
\end{pmatrix}$$
1. מבצעים את הכפל מטריצות, כאשר את המשוואות מתחילים לפתור מה-"ר" החיצוני ל-"ר" הפנימי, כאשר תמיד נפתור קודם את האלמנט הפינתי.
	$$\begin{aligned}
&{\color{cyan} \begin{aligned}&{{l_{11}=a_{11}}}\\ &{{l_{11}u_{12}=a_{12}\implies  u_{12}={a}_{12}\ /l_{11}}}\\ &{{l_{11}u_{13}=a_{13}\implies  u_{13}=a_{13}\ /l_{11}}}\\ &{{l_{21}=a_{21}}}\\ &{{l_{31}=a_{31}}}\end{aligned}} \\[2ex]&
{\color{red} \begin{aligned}&{{l_{21}u_{12}+l_{22}=a_{22}\implies {l}_{22}=a_{22}-l_{21}u_{12}}}\\ &{{l_{21}u_{13}+l_{22}u_{23}=a_{23}\implies  u_{23}=\dfrac{a_{23}-l_{21}u_{13}}{l_{22}}}}\\ &{{l_{31}u_{12}+l_{32}=a_{32}\implies  l_{32}=a_{32}-l_{31}u_{12}}}\end{aligned}} \\[2ex]
&{\color{lime}l_{31}u_{13}+l_{32}u_{23}+l_{33}=a_{33}\implies l_{33}=a_{33}-l_{31}u_{13}+l_{32}u_{23} }
\end{aligned}$$
2. נפתור את המערכת היותר פשוטה ע"י חליצה לפנים (כמו "חליצה לאחור", אבל הפוך):
	$$L\bar{y}=\bar{b}$$
3. נפתור את המערכת הבאה ע"י חליצה לאחור:
	$$U\bar{x}=\bar{y}$$

>[!notes] הערה: 
 >אין משמעות לכך שאלכסון ה-$1$-ים יהיה דווקא במטריצת $U$ ולא ב-$L$. למעשה מבדילים בין שני המקרים בשמות שונים.
 >כאשר אנו קובעים ש- $u_{kk}=1$ אנחנו קוראים לשיטה זו **שיטת Crout**.
 >כאשר אנו קובעים ש- $l_{kk}=1$ אנחנו קוראים לשיטה זו **שיטת Doolittle**.

קוד ב-`MATLAB`:
```matlab
function LU = LUDecompDoolittle(A)
    n = length(A);
    LU = A;
    % decomposition of matrix, Doolittle's Method
    for i = 1:1:n
        for j = 1:(i - 1)
            LU(i,j) = (LU(i,j) - LU(i,1:(j - 1))*LU(1:(j - 1),j)) / LU(j,j);
        end
        j = i:n;
        LU(i,j) = LU(i,j) - LU(i,1:(i - 1))*LU(1:(i - 1),j);
    end
    %LU = L+U-I
end

function x = SolveLinearSystem(LU, B)
    n = length(LU);
    y = zeros(size(B));
    % find solution of Ly = B
    for i = 1:n
        y(i,:) = B(i,:) - LU(i,1:i)*y(1:i,:);
    end
    % find solution of Ux = y
    x = zeros(size(B));
    for i = n:(-1):1
        x(i,:) = (y(i,:) - LU(i,(i + 1):n)*x((i + 1):n,:))/LU(i, i);
    end    
end
```

מבחינת סיבוכיות, יש בפירוק LU את אותו מספר פעולות כמו בגאוס. לכן גם לפירוק LU סיבוכויות $O(n^{3})$. אך הפעם, מאחר ולא הכללנו את $\underline{b}$ בכל החישובים שלנו, אנחנו יכולים לשמור את המטריצות $L$ ו-$U$ במקרה ונרצה לחשב יותר מהר עבור $\underline{b}$ אחר.

## #אלגוריתם: פירוק שולסקי
עבור מטריצות [[ALG1_003 מטריצות#מטריצה סימטרית|סימטריות]] שהן [[CAL2_010 נקודות אקסטרמום#מטריצה מוגדרת חיובית|מוגדרות חיובית]] נוכל לבצע פירוק LU בסיבוכיות יותר טובה, הנקרא **פירוק שולסקי (Cholesky)**. במקרה כזה אנחנו יכולים למצוא מטריצה $G$ יחידה שהיא:
- משולשת תחתונה
- עם איברים חיוביים וממשיים על האלכסון
- מתקיים:
	$$A=GG^{T}$$

>[!example] דוגמה: 
 >במקרה של מטריצה מסדר $2\times 2$, נניח כי מטריצה $G$ כזאת קיימת:
 >$$A=\begin{pmatrix}
a_{11} & a_{12} \\
a_{12} & a_{22}
\end{pmatrix}=\begin{pmatrix}
{g}_{11} & 0 \\
g_{12} & g_{22}
\end{pmatrix}\begin{pmatrix}
g_{11} & g_{12} \\
0 & g_{22}
\end{pmatrix}$$
כעת יש לנו שלושה משוואות בשלושה נעלמים:
>$$\begin{cases}
a_{11}=g_{11}^{2} \\
a_{12}=g_{11}g_{12} \\
a_{22}=g_{12}^{2}+g_{22}^{2}
\end{cases}$$

הסיבוכיות של אלגוריתם זה היא גם $O(n^{3})$, אבל היא דורשת פחות פעולות חישוב סך הכל.
עבור פירוק LU, מתבצעים $\dfrac{2}{3}n^{3}+O(n^{2})$ חישובים. לעומת זאת, בפירוק שולסקי, מתבצעים $\dfrac{1}{3}n^{3}+O(n^{2})$ חישובים.

