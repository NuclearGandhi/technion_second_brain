---
aliases:
  - זיגלר-ניקולס
---
# מבוא
ראינו כבר ש[[ICT1_007 משוב בהגברים גבוהים#שגיאה עבור הפרעת מדרגה|בקר PI]] הוא מהצורה:
$$C(s)={k}_{p}\left( 1+\dfrac{{k}_{i}}{s} \right)$$
לפעמים גם רושמים אותו:
$$C(s)={k}_{p}\left( 1+\dfrac{1}{{\tau}_{i}s} \right)$$
כאשר ${\tau}_{i}:=1/{k}_{i}$ נקרא **זמן אתחול**.

לעומת זאת, **PID** הוא בקר מהצורה:
$$C(s)={k}_{p}\left( 1+\dfrac{1}{{\tau}_{i}s} \right)(1+{\tau}_{d}s)$$
או, באופן יותר כללי (המאפשר גם אפסים מרוכבים):
$$C(s)=\left( 1+\dfrac{1}{{\tau}_{i}s}+{\tau}_{d}s \right)$$
נוכל כעת לפרט אינטואיטיבית מה כל חלק עושה בבקר PID:
- החלק הפרופורציוני P מתחשב בהווה.
- החלק האינטגרלי I משתמש במידע בעבר.
- החלקי הגוזר D "מנסה" לחזות את העתיד.

נביט כעת בתגובת התדירות של הבקרים השונים.
**עבור בקר PI**:
![[Pasted image 20250202105724.png|bookhue|600]]

נשים לב שהבקר PI מוסיף *פיגור* פאזה ולכן מקטין את ה[[ICT1_010 מערכות השהייה#עודפי הגבר ופאזה|עודף פאזה]]. כדי להקטין זאת, נבחר ${\tau}_{i}$ כך ש- ${\omega}_{c}{\tau}_{i}\gg 1$.

**עבור בקר PD**:
![[{D3D4B7CD-FBF5-46AB-982C-8B782EF3FBFD}.png|bookhue|600]]

נשים לב שבקר PD מוסיף *קידום* פאזה ולכן מגדיל את העודף פאזה. כדי לנצל זאת, נבחר ${\tau}_{d}$ כך ש- ${\omega}_{c}{\tau}_{d} \not\ll 1$.

מסקר שנערך ביותר מ-100 תחנות כוח בפרובינציית גוואנג-דונג בסין מצאו ש-$94.4\%$ מכל הבקרים היו PI, $4\%$ היו PID, ו-$1.9\%$ השתמשו בבקרה מתקדמת (לא יודע מה זה, נשמע כמו משהו מסובך). הסיבה שפעולת הגזירה בשימוש רק ב-$4\%$ מכל הבקרים היא שהיתרונות של "חזיית" העתיד משמעותיות בעיקר לתהליכים שמאפשרים הגברים גבוהים בבקרים. עבור הרבה מהמערכות, פעולת הגזירה, "חזיית" העתיד, שמתבצעת ע"י אקסטרפולציה לינארית, עלולה ליצור אותות בקרה גדולים ולפיכך לא רצויים בגלל הגברת רעש המדידה. בקרת טמפרטורה היא דוגמה טיפוסית למקרה בו פעולת הגזירה יכולה לעזור: לחיישנים יש רעשי מדידה נמוכים כך שנוכל לתכנן לבקרים הגבר גבוה.



# כוונון PID

בתכנון בקר PID אחד מהאתגרים שעומדים לפנינו הוא *כוונון* הפרמטרים של הבקר. פותחו המון שיטות שונות לאופן כוונון נכון וטוב.

## כוונון זיגלר-ניקולס
שיטת הכוונון הראשונה פותחה ע"י זיגלר וניקולס בשנות ה-40 [[ICT1_000 00340040 מבוא לבקרה#ביבליוגרפיה|(Ziegler & Nichols, 1942)]]. הרעיון שלהם היה לבצע ניסוי פשוט על התהליך וממנו לחלץ מאפיינים של דינמיקת התהליך במישור הזמן והתדר.
בשיטת מישור התדר, הבקר מחובר לתהליך, מגדירים את הגבר האינטגרטור והגוזר לאפס, ומשחקים עם ההגבר הפרופורציונאלי ${k}_{p}$ עד שהמערכת מתחילה לתנוד.

![[{F43B2F7D-C06B-46B3-9C4F-1B66483E643F}.png|bookhue]]
>תגובת המערכת לערכי הגבר פרופורציוניים שונים. [[ICT1_000 00340040 מבוא לבקרה#ביבליוגרפיה|(Leonid Mirkin’s Homepage, n.d.)]].

הערך הקריטי ${K}_{u}$ של ההגבר הפרופורציוני נמצא ביחד עם זמן המחזור ${T}_{u}$.

>[!notes] הערה: 
 >למען האמת, ${T}_{u}=2\pi /{\omega}_{\phi}$ ו- ${K}_{u}={\mu}_{g}=1/\lvert P(j\omega _{\phi}) \rvert$ (כאשר ${\omega}_{\phi}$ הוא [[ICT1_010 מערכות השהייה#עודפי הגבר ופאזה|תדר מעבר הפאזה]]).

בעזרת ערכים אלו, זיגלר וניקולס מציעים את הערכים:
$$\begin{array}{c|c}
 & {k}_{p} & {\tau}_{i} & {\tau}_{d} \\
\hline \mathrm{P} & 0.5{K}_{u} &  &  \\
\mathrm{PI} & 0.45{K}_{u} & {T}_{u}/1.2 &  \\
\mathrm{PID} & 0.6{K}_{u} & {T}_{u}/2 & {T}_{u}/8
\end{array}$$

ערכים אלו מוצעים רק כנקודות התחלה. לרוב, נצטרך לשחק עוד עם הפרמטרים כדי לקבל את התוצאה הרצויה.


>[!example] דוגמה: 
> עבור החוג הסגור:
> ![[{B74E2FD3-D3BC-425E-BF66-54A0A2BEF5FA}.png|bookhue|450]]
> 
> העקום הפולארי של התהליך:
> ![[{BE80AB65-F95A-4D4D-860C-B597C63B6292}.png|bookhue|500]]
> 
> נקבל:
> $${K}_{u} \approx  \dfrac{1}{0.21}\approx  4.688,\qquad {T}_{u}=\dfrac{2\pi}{{\omega}_{\phi}}\approx 3.27$$
> לכן לפי זיגלר-ניקולס נקבל את הבקר PI או הבקר PID:
> $$\begin{aligned}
>  & {C}_{\mathrm{PI}}(s)=2.11\left( 1+\dfrac{1}{2.73s} \right) \\[1ex]
>  & {C}_{\mathrm{PID}}(s)=3.28\left( 1+\dfrac{1}{\pu{1.31s}}+0.49s \right)
> \end{aligned}$$
> 
> ![[{259C3262-E580-4E1B-9739-16AF71B427FF}.png|bookhue|600]]
> 
> מבחינת הגרף הפולארי:
> ![[{C4325274-ACF2-4BAA-887B-5F3576A615B7}.png|bookhue|400]]
> תדר המעבר ועודפי ההגברים והפאזות המתקבלים:
> $$\begin{aligned}
>  & \mathrm{PI}: &  & {\omega}_{c}=1.11, &  & {\mu}_{g}=1.79, &  & {\mu}_{\text{ph}}=33.7^{\circ}  \\[1ex]
>  & \mathrm{PID}: &  & {\omega}_{c}=1.55, &  & {\mu}_{g}=1.97, &  & {\mu}_{\text{ph}}=36.3^{\circ} 
> \end{aligned}$$
> מבחינת התגובות מדרגה:
> ![[{CC5B9410-BEA7-4253-8E29-A8E73DD81ECA}.png|bookhue|500]]
> 
> מבחינת התגובות להפרעת מדרגה.
> ![[{CADDCEC5-158C-473A-A710-67442F41A577}.png|bookhue|500]]
> 

# ארכיטקטורות PID
עד כה עסקנו במשוב מסוג משוב יחידה:
![[{7360FBA1-4E8A-4068-98C7-93C0003C38B0}.png|bookhue|500]]
אות הבקרה במישור הזמן:
$$u(t)={k}_{p}\left[ e(t)+\dfrac{1}{{\tau}_{i}}\int_{0}^{t} e(\theta) \, \mathrm{d}\theta+{\tau}_{d}\dot{e}(t)  \right]$$
הפונקציית תמסורת של הבקר:
$$C(s)={k}_{p}\left( 1+\dfrac{1}{{\tau}_{i}s}+{\tau}_{d}s \right)=\dfrac{{k}_{p}({\tau}_{d}{\tau}_{i}s^{2}+{\tau}_{i}s+1)}{{\tau}_{i}s}$$
נשים לב שיש לו אפסים. אם נביט בפונקציית תמסורת של המערכת:
$$T(s)=\dfrac{{N}_{P}(s){N}_{C}(s)}{\mathcal{X}_{\text{cl}}(s)}=\dfrac{{k}_{p}({\tau}_{d}{\tau}_{i}s^{2}+{\tau}_{i}s+1){N}_{P}(s)}{\mathcal{X}_{\text{cl}}(s)}$$
נשים לב שהאפסים של הבקר הם גם האפסים של $T(s)$, ואנחנו לא אוהבים אפסים, כי אם הם דומיננטיים מספיק, הם יכולים לגרום לתגובת-יתר ($\mathrm{OS}$) גדולה מדי.

דרך אחת לטפל בבעיה זו היא *לשנות את הארכיטקטורה* של החוג הסגור:
![[{C0869DA3-229E-4875-A74A-822744BB23F1}.png|bookhue|500]]

כעת:
$$u(t)={k}_{p}\left[ -y(t)+\dfrac{1}{{\tau}_{i}}\int_{0}^{t} e(\theta) \, \mathrm{d}\theta-{\tau}_{d}\dot{y}(t)  \right]$$
כלומר, אנחנו מפעילים את הגזירה, D, רק על היציאה $y$, ולא על כל השגיאה $e$. לפיכך, הגזירה לא תגדיל לנו שינויים משמעותיים בשגיאה, בעוד האינטגרטור, שמטרתו לאפס את השגיאה, עדיין פועל כרגיל על $e$.

פונקציית המערכת $r\to y$ היא:
$${T}_{yr}(s)=\dfrac{P(s){k}_{p}/({\tau}_{i}s)}{1+P(s)C(s)}=\dfrac{{k}_{p}{N}_{P}(s)}{\mathcal{X}_{\text{cl}}(s)}$$
לפונקציית תמסורת זו יש רק את האפסים של התהליך $P$, כך שבאמת כנראה נקבל תגובות מעבר יותר חלקות. באותו הזמן, תגובת ההפרעה לא מושפעת משינוי ארכיטקטורה זה, שזה אחלה.


>[!example] דוגמה: 
> 
> בהינתן אותה המערכת מהדוגמה הקודמת:
> $$P(s)=\dfrac{k}{s+a}\qquad \text{and}\qquad C(s)={k}_{p}\left( 1+\dfrac{1}{{\tau}_{i}s} \right)$$
> אז ל-
> $$T(s)=\dfrac{k{k}_{p}({\tau}_{i}s+1)}{{\tau}_{i}s^{2}+{\tau}_{i}(a+k{k}_{p})s+k{k}_{p}}$$
> יש אפס ב- $s=-1/{\tau}_{i}$, בעוד-
> $${T}_{yr}(s)=\dfrac{k{k}_{p}}{{\tau}_{i}s^{2}+{\tau}_{i}(a+k{k}_{p})s+k{k}_{p}}$$
> הוא פונקציית תמסורת מסדר שני ללא אפסים.
> עם אותו הכוונון, אבל בארכיטקטורות שונות, תגובות המדרגה:
> ![[{922DD906-3EC9-495F-B4CE-FA01028FC323}.png|bookhue|500]]
> 

# בקרה בשתי דרגות חופש
בקרה בשתי דרגות חופש (2DOF controllers) היא סוג של שילוב בין [[ICT1_003 בקרה בחוג פתוח#מבוא|בקרה בחוג פתוח]] לבקרה בחוג סגור. הרעיון הוא להתעלם מהבקר $C$ אם המערכת מתנהגת כרצוי.
![[{5915BADA-EAB1-4F6D-8F07-0899F32F00B6}.png|bookhue|600]]
כדי לבטא את ההתנהגות הרצויה, אנו דורשים מהאותות החדשים ש:
1. האותות ${y}_{\text{ref}}$ ו-${u}_{\text{req}}$ חסומים (להבטחת יציבות).
2. מתקיים ${y}_{\text{ref}}=P{u}_{\text{ref}}$ (להבטחת עקביות).

אם $d=n=0$, אז ניתן לראות מהדיאגרמה:
$$\begin{gathered}
u={u}_{\text{req}}+C({y}_{\text{ref}}-Pu) \\[1ex]
u+CPu={u}_{\text{req}}+C{y}_{\text{ref}} \\[1ex]
u=\dfrac{1}{1+CP}{u}_{\text{req}}+\dfrac{C}{1+CP}{y}_{\text{ref}}
\end{gathered}$$
נשים לב שיש לנו כבר שמות למקדמים של ${u}_{\text{req}}$ ו-${y}_{\text{ref}}$:
$$
u=S{u}_{\text{req}}+{T}_{c}{y}_{\text{ref}}$$
מאחר ו-(לפי [[ICT1_005 מבוא למשוב#משוב יחידה|משוב יחידה]]) ${T}_{c}P=T$ וגם $S+T=1$:
$$\begin{aligned}
u & =(1-{T}_{c}P){u}_{\text{req}}+{T}_{c}{y}_{\text{ref}} \\[1ex]
 & ={u}_{\text{req}}-{T}_{c}\underbrace{ P{u}_{\text{req}} }_{ {y}_{\text{ref}} }+{T}_{c}{y}_{\text{ref}} \\[1ex]
 & ={u}_{\text{req}}
\end{aligned}$$
קיבלנו ש- $u={u}_{\text{req}}$, כך שעם איך שהגדרנו את ${y}_{\text{ref}}$, נקבל:
$$\begin{aligned}
y & =Pu \\[1ex]
 & =P{u}_{\text{ref}} \\[1ex]
 & ={y}_{\text{ref}}
\end{aligned}$$
כך ש- $y={y}_{\text{ref}}$, בלי תלות ב-$C$ (כל עוד $C$ מייצב).

אם נבחר ${y}_{\text{ref}}={T}_{\text{ref}}r$ וגם ${u}_{\text{req}}={C}_{\text{ol}}r$ עבור ${C}_{\text{ol}}=P^{-1}{T}_{\text{ref}}$, אז:
![[{B9A95F18-A1A8-4EB4-BF90-E8F8F324E36B}.png|bookhue|600]]

אנו מעוניינים באותות:
$$\boxed{y={T}_{\text{ref}}r+{T}_{d}d-{T}_{n} },\qquad \boxed{u={C}_{\text{ol}}r-Td-{T}_{c}n }$$
בקר זה משלב בקר בחוג סגור ובקר בחוג פתוח עם הפרדה מוחלטת בין התגובה הנומינלית של המערכת (שמאופיין ע"י ${C}_{\text{ol}}$) וייצוב וטיפול באי-וודאויות של המערכת (שמאופיין ע"י $C$).

![[{F36034BB-9B57-4412-9543-1F75343E18B6}.png|bookhue|600]]
>השוואה בתגובת מדרגה בין משוב יחידה בחוג סגור ובין מערכת בשתי דרגות חופש. ב- $t=1.84$ הוכנסה הפרעה למערכת.

