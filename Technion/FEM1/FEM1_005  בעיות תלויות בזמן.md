---
aliases:
---
# מבוא
כעת נעסוק בבעיות תלויות בזמן דרך משוואות האלסטודינמיקה עבור עיוותים אינפיניטסימליים:

$$\begin{align}
\nabla \cdot \boldsymbol{\sigma} + \mathbf{f}  & = \rho_o \frac{\mathrm{d}^2\mathbf{u}}{\mathrm{d}t^2} \\[1ex]
 &  = \rho_o \frac{\mathrm{d}\mathbf{v}}{\mathrm{d}t} \tag{9.1}
\end{align}$$
# צעידה בזמן כללית
כדי להמחיש את תהליך הצעידה בזמן, נתחיל עם הדינמיקה של מסה נקודתית בודדת תחת השפעת כוח $\Psi$. משוואת התנועה נתונה על ידי [[PHY1_003 חוקי ניוטון#חוק ניוטון השני|חוק שני של ניוטון]]:

$$m\dot{\mathbf{v}} = \Psi  \tag{9.2}$$

כאשר $\Psi$ הוא הכוח הכולל המופעל על החלקיק. נפתח את המהירות בטור טיילור סביב $t + \theta \Delta t$, כאשר $0 \leq \theta \leq 1$, עבור $\mathbf{v}(t + \Delta t)$, ונקבל:

$$\begin{align}
\mathbf{v}(t + \Delta t) &  = \mathbf{v}(t + \theta\Delta t) + \left.\frac{\mathrm{d}\mathbf{v}}{\mathrm{d}t}\right|_{t+\theta\Delta t} (1 - \theta) \Delta t  \\[1ex]
 & \qquad + \frac{1}{2} \left.\frac{\mathrm{d}^2\mathbf{v}}{\mathrm{d}t^2}\right|_{t+\theta\Delta t} (1-\theta)^2(\Delta t)^2 + \mathcal{O}(\Delta t)^3 \tag{9.3}
\end{align}$$

ועבור $\mathbf{v}(t)$, נקבל:

$$\begin{align}
\mathbf{v}(t)  & = \mathbf{v}\mathbf{}(t + \theta \Delta t) - \left.\frac{\mathrm{d}\mathbf{v}}{\mathrm{d}t}\right|_{t+\theta\Delta t} \theta \Delta t  \\[1ex]
 & \qquad + \frac{1}{2} \left.\frac{\mathrm{d}^2\mathbf{v}}{\mathrm{d}t^2}\right|_{t+\theta\Delta t} \theta^2(\Delta t)^2 + \mathcal{O}(\Delta t)^3 \tag{9.4}
\end{align}$$

חיסור שני הביטויים נותן:

$$\left.\frac{\mathrm{d}\mathbf{v}}{\mathrm{d}t}\right|_{t+\theta\Delta t} = \frac{\mathbf{v}(t + \Delta t) - \mathbf{v}(t)}{\Delta t} + \hat{\mathcal{O}}(\Delta t) \tag{9.5}$$

כאשר $\hat{\mathcal{O}}(\Delta t) = \mathcal{O}(\Delta t)^2$ כאשר $\theta = \frac{1}{2}$, אחרת $\hat{\mathcal{O}}(\Delta t) = \mathcal{O}(\Delta t)$. לכן, הצבה לתוך משוואה $(9.2)$ נותנת:

$$\mathbf{v}(t + \Delta t) = \mathbf{v}(t) + \frac{\Delta t}{m} \Psi(t + \theta \Delta t) + \hat{\mathcal{O}}(\Delta t)^2 \tag{9.6}$$

נשים לב שסכום משוקלל של משוואות $(9.3)$ ו-$(9.4)$ נותן:

$$\mathbf{v}(t + \theta \Delta t) = \theta \mathbf{v}(t + \Delta t) + (1 - \theta)\mathbf{v}(t) + \mathcal{O}(\Delta t)^2 \tag{9.7}$$

ביטוי זה יהיה שימושי בהמשך. כעת נפתח את מיקום המסה בטור טיילור סביב $t + \theta \Delta t$:

$$\begin{align}
\mathbf{u}(t + \Delta t)  & = \mathbf{u}(t + \theta\Delta t) + \left.\frac{\mathrm{d}\mathbf{u}}{\mathrm{d}t}\right|_{t+\theta\Delta t} (1-\theta)\Delta t  \\[1ex]
 & \qquad + \frac{1}{2} \left.\frac{\mathrm{d}^2\mathbf{u}}{\mathrm{d}t^2}\right|_{t+\theta\Delta t} (1-\theta)^2(\Delta t)^2 + \mathcal{O}(\Delta t)^3 \tag{9.8}
\end{align}$$

ו-

$$\begin{align}
\mathbf{u}(t)  & = \mathbf{u}(t + \theta \Delta t) - \left.\frac{\mathrm{d}\mathbf{u}}{\mathrm{d}t}\right|_{t+\theta\Delta t} \theta \Delta t  \\[1ex]
 & \qquad + \frac{1}{2} \left.\frac{\mathrm{d}^2\mathbf{u}}{\mathrm{d}t^2}\right|_{t+\theta\Delta t} \theta^2(\Delta t)^2 + \mathcal{O}(\Delta t)^3 \tag{9.9}
\end{align}$$

חיסור שני הביטויים נותן:

$$\frac{\mathbf{u}(t + \Delta t) - \mathbf{u}(t)}{\Delta t} = \mathbf{v}(t + \theta \Delta t) + \hat{\mathcal{O}}(\Delta t) \tag{9.10}$$

הצבת משוואה $(9.7)$ נותנת:

$$\begin{align}
\mathbf{u}(t + \Delta t)  & = \mathbf{u}(t) + (\theta \mathbf{v}(t + \Delta t)  \\[1ex]
 & \qquad + (1 - \theta)\mathbf{v}(t)) \Delta t + \hat{\mathcal{O}}(\Delta t)^2 \tag{9.11}
\end{align}$$

ושימוש במשוואה $(9.6)$ נותן:

$$\begin{align}
\mathbf{u}(t + \Delta t)  & = \mathbf{u}(t) + \mathbf{v}(t)\Delta t  \\[1ex]
 & \qquad +  \frac{\theta(\Delta t)^2}{m} \Psi(t + \theta \Delta t) + \hat{\mathcal{O}}(\Delta t)^2  \tag{9.12}
\end{align}$$

הביטוי $\Psi(t + \theta \Delta t)$ ניתן לטיפול בדרך פשוטה:

$$\Psi(t + \theta \Delta t) \approx \theta \Psi(t + \Delta t) + (1 - \theta)\Psi(t) \tag{9.13}$$

>[!notes] הערות: 
> * כאשר $\theta = 1$, זוהי [[NUM1_011 שיטות נומריות לפתרון משוואות דיפרנציאליות#שיטת אויילר|שיטת אויילר לאחור]] (Backward Euler) הסתומה, שהיא מאוד יציבה ו-$\hat{\mathcal{O}}(\Delta t)^2 = \mathcal{O}(\Delta t)^2$ באופן מקומי בזמן.
> * כאשר $\theta = 0$, זוהי שיטת [[NUM1_011 שיטות נומריות לפתרון משוואות דיפרנציאליות#שיטת אויילר|שיטת אויילר לפנים]] (Forward Euler) המפורשת, שהיא יציבה בתנאים מסוימים ו-$\hat{\mathcal{O}}(\Delta t)^2 = \mathcal{O}(\Delta t)^2$ באופן מקומי בזמן.
> * כאשר $\theta = 0.5$, זוהי שיטת "נקודת האמצע" (Midpoint) הסתומה, שהיא יציבה ו-$\hat{\mathcal{O}}(\Delta t)^2 = \mathcal{O}(\Delta t)^3$ באופן מקומי בזמן.

לסיכום, קיבלנו עבור המהירות[^1]:

[^1]: לצורך פישוט הסימון, אנו משמיטים את הביטויים מסוג $\mathcal{O}(\Delta t)$.


$$\mathbf{v}(t + \Delta t) = \mathbf{v}(t) + \frac{\Delta t}{m}(\theta \Psi(t + \Delta t) + (1 - \theta)\Psi(t)) \tag{9.14}$$
ועבור המיקום:

$$\begin{aligned}
\mathbf{u}(t + \Delta t) &= \mathbf{u}(t) + \mathbf{v}(t + \theta \Delta t)\Delta t \\
&= \mathbf{u}(t) + (\theta \mathbf{v}(t + \Delta t) + (1 - \theta)\mathbf{v}(t)) \Delta t
\end{aligned} \tag{9.15}$$

או במונחים של $\Psi$:

$$\begin{aligned}
\mathbf{u}(t + \Delta t)  & = \mathbf{u}(t) + \mathbf{v}(t)\Delta t  \\[1ex]
 & \qquad + \theta \frac{(\Delta t)^2}{m}(\theta \Psi(t + \Delta t) + (1 - \theta)\Psi(t))
\end{aligned} \tag{9.16}$$

# יישום לניסוח הרציף
כעת נתבונן באנלוגיה הרציפה ל-"$m\dot{\mathbf{v}}$":

$$\begin{aligned}
\rho_o \frac{\partial^2 \mathbf{u}}{\partial t^2}  & = \rho_o \frac{\partial \mathbf{v}}{\partial t}  \\[1ex]
 & = \nabla \cdot \boldsymbol{\sigma} + \mathbf{f} := \Psi
\end{aligned} \tag{9.17}$$

ולכן:

$$\rho_o \mathbf{v}(t + \Delta t) = \rho_o \mathbf{v}(t) + \Delta t (\theta \Psi(t + \Delta t) + (1 - \theta)\Psi(t)) \tag{9.18}$$

הכפלת משוואה $(9.18)$ בפונקציית מבחן ואינטגרציה נותנת:

$$\begin{align}
\int_{\Omega} \boldsymbol{\nu} \cdot \rho_o \mathbf{v}(t + \Delta t) \,\mathrm{d}\Omega  & =\int_{\Omega} \boldsymbol{\nu} \cdot \rho_o \mathbf{v}(t) \,\mathrm{d}\Omega\\
&\qquad + \Delta t \int_{\Omega} \boldsymbol{\nu} \cdot (\theta \Psi(t + \Delta t)  \\[1ex]
 & \qquad + (1 - \theta)\Psi(t)) \,\mathrm{d}\Omega\tag{9.19}
\end{align} $$

ושימוש ב[[CAL2_014 אינטגרלים משטחיים#משפט גאוס|משפט גאוס]] ואכיפת $\boldsymbol{\nu} = 0$ על $\Gamma_u$ נותן (באמצעות סימון מספרי צעד זמן מפושט $L$, כאשר $t = L\Delta t$ ו- $t + \Delta t = (L + 1)\Delta t$):

$$\begin{align}
\int_{\Omega} \boldsymbol{\nu} \cdot \rho_o \mathbf{v}^{L+1} \,\mathrm{d}\Omega &  = \int_{\Omega} \boldsymbol{\nu} \cdot \rho_o \mathbf{v}^L \,\mathrm{d}\Omega\\[1ex]
&+ \Delta t\theta \left( -\int_{\Omega} \nabla\boldsymbol{\nu} : \boldsymbol{\sigma} \,\mathrm{d}\Omega \right.  \\[1ex]
 & \qquad + \left. \int_{\Gamma_t} \boldsymbol{\nu} \cdot (\boldsymbol{\sigma} \cdot \mathbf{n}) \,\mathrm{d}A + \int_{\Omega} \boldsymbol{\nu} \cdot \mathbf{f} \,\mathrm{d}\Omega \right)^{L+1}\\
&+ \Delta t(1-\theta) \left( -\int_{\Omega} \nabla\boldsymbol{\nu} : \boldsymbol{\sigma} \,\mathrm{d}\Omega  \right. \\[1ex]
 & \qquad \left.+ \int_{\Gamma_t} \boldsymbol{\nu} \cdot \mathbf{t}^* \,\mathrm{d}A + \int_{\Omega} \boldsymbol{\nu} \cdot \mathbf{f} \,\mathrm{d}\Omega \right)^L\tag{9.20}
\end{align} $$

אנו מניחים[^2]:
$$\begin{align}
 & \{\mathbf{u}^h\} = [\boldsymbol{\boldsymbol{\Phi}}]\{\mathbf{a}\} \quad \text{and}  \\[1ex]
 & \{\boldsymbol{\nu}^h\} = [\boldsymbol{\boldsymbol{\Phi}}]\{\mathbf{b}\} \quad \text{and} \\[1ex]
  & \{\mathbf{v}^h\} = [\boldsymbol{\boldsymbol{\Phi}}]\{\dot{\mathbf{a}}\} \tag{9.21}
\end{align}$$

[^2]:הסימון $\{  \}$ נועד להדגיש שמדובר בוקטורים, ואילו $[]$ הוא עבור מטריצות.

מה שנותן, במונחים של מטריצות ווקטורים:

$$\begin{aligned}
 & \{b\}^T [M]\{\dot{a}\}^{L+1}  = \{b\}^T [M]\{\dot{a}\}^L\\[1ex]
&\qquad - \Delta t\theta \{b\}^T \left(-[K]\{a\}^{L+1} + \{R_f\}^{L+1} + \{R_t\}^{L+1}\right)\\[1ex]
&\qquad - \{b\}^T \Delta t(1-\theta) \left(-[K]\{a\}^L + \{R_f\}^L + \{R_t\}^L\right)
\end{aligned} \tag{9.22}$$

כאשר $[M] = \int_{\Omega} \rho_o [\boldsymbol{\Phi}]^T[\boldsymbol{\Phi}] \,\mathrm{d}\Omega$, ו-$[K]$, $\{R_f\}$ ו-$\{R_t\}$ מוגדרים כפי שהוגדרו בפרקים הקודמים על אלסטוסטטיקה. שימו לב ש-$\{R_f\}^L$ ו-$\{R_t\}^L$ הם ערכים ידועים מצעד הזמן הקודם. מכיוון ש-$\{b\}^T$ הוא שרירותי:

$$\begin{align}
  &  [M]\{\dot{a}\}^{L+1}   \\[1ex]
 & \qquad  = [M]\{\dot{a}\}^L  \\[1ex]
 & \qquad \qquad + (\Delta t\theta) \left(-[K]\{a\}^{L+1} + \{R_f\}^{L+1} + \{R_t\}^{L+1}\right)\\[1ex]
&\qquad\qquad  + \Delta t(1-\theta) \left(-[K]\{a\}^L + \{R_f\}^L + \{R_t\}^L\right) \tag{9.23}
\end{align}$$

יש להוסיף לכך את הקירוב עבור ההעתקה הדיסקרטית:

$$\{a\}^{L+1} = \{a\}^L + \Delta t \left(\theta \{\dot{a}\}^{L+1} + (1-\theta)\{\dot{a}\}^L\right) \tag{9.24}$$

עבור שיטה סתומה טהורה (אוילר לאחור) $\theta = 1$:

$$\begin{align}
 & \left([M]\{\dot{a}\}^{L+1} + \Delta t [K]\{a\}^{L+1}\right) \\[1ex]
 &\qquad  = [M]\{\dot{a}\}^L   \Delta t \left(\{R_t\}^{L+1} + \{R_f\}^{L+1}\right) \tag{9.25}
\end{align}$$

בתוספת:

$$\{a\}^{L+1} = \{a\}^L + \Delta t \{\dot{a}\}^{L+1} \tag{9.26}$$

אשר דורשת פתרון של מערכת משוואות אלגבריות, בעוד שעבור שיטה מפורשת (אוילר לפנים) $\theta = 0$, כאשר בדרך כלל $[M]$ מקורבת על ידי מטריצה קלה להיפוך, כגון מטריצה אלכסונית, $[M] \approx M[1]$, כדי להקל על היפוך המטריצה, ומתקבל:

$$\{\dot{a}\}^{L+1} = \{\dot{a}\}^L + \Delta t [M]^{-1}\left(-[K]\{a\}^L + \{R_f\}^L + \{R_t\}^L\right) \tag{9.27}$$

בתוספת:

$$\{a\}^{L+1} = \{a\}^L + \Delta t \{\dot{a}\}^L \tag{9.28}$$

