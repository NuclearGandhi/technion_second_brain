---
aliases: 
title: תרגיל בית 1
---


| **קורס**      | אלמנטים סופיים לאנליזה הנדסית |
| ------------- | ----------------------------- |
| **מספר קורס** | 00350022                      |


|                   | **סטודנט א'**                  |
| ----------------- | ------------------------------ |
| **שם**            | עידו פנג בנטוב                 |
| **ת"ז**           | 322869140                      |
| **דואר אלקטרוני** | ido.fang@campus.technion.ac.il |

<div><hr><hr></div>


## שאלה 1
נביט בפונקציה:
$$f(x)=(x+\sin x)\cdot \ln(1+x)$$
### סעיף א'
אנו יודעים שסביב ${x}_{0}=0$, ה[[CAL1_006 פולינום טיילור#משפט טיילור|טור טיילור]] של הפונקציות הבסיסיות הוא:
$$\begin{aligned}
 & \sin x=x-\dfrac{x^{3}}{3!}+\mathcal{O}(h^{4}) \\[1ex]
 & \ln(1+x)=x-\dfrac{x^{2}}{2}+\dfrac{x^{3}}{3} + \mathcal{O}(h^{4})
\end{aligned}$$
לכן נוכל לרשום:
$$\begin{aligned}
f(x) & = \left( x+x-\dfrac{x^{3}}{6}+\mathcal{O}(h^{4}) \right)\left( x-\dfrac{x^{2}}{2}+\dfrac{x^{3}}{3}+\mathcal{O}(h^{4}) \right) \\[1ex]
 & =\left( 2x-\dfrac{x^{3}}{6} \right)\left( x-\dfrac{x^{2}}{2}+\dfrac{x^{3}}{3} \right)+\mathcal{O}(h^{7}) \\[1ex]
 & =2x^{2}-x^{3}+\dfrac{x^{4}}{2}+\dfrac{x^{5}}{12}-\dfrac{x^{6}}{18}+\mathcal{O}(h^{7})
\end{aligned}$$
אם ניקח רק את שלושת הביטויים הראשונים:
$$\boxed {
f(x)= 2x^{2}-x^{3}+\dfrac{x^{4}}{2}+\mathcal{O}(h^{5})
 }$$
### סעיף ב'
נדרש למצוא קירוב אינטרפולציה של $f(x)$ בקטע $[0, 0.5]$ בצורה:
$$f(x) = N_i(x)f_i + O(h^4)$$
כאשר $N_i(x)$ הוא וקטור שורה של פולינומי לגראנז', $f_i$ הוא וקטור עמודה עם ערכי הפונקציה בנקודות מרוחקות באופן שווה, ו-$h = 0.5$ הוא אורך הקטע.

כדי להגיע לשגיאת חיתוך מסדר $O(h^4)$, נדרש לקבוע כמה נקודות אינטרפולציה דרושות.

באופן כללי, עבור [[NUM1_007 אינטרפולציה פולינומית#אינטרפולציית לגראנז'|אינטרפולציית לגראנז']] עם $n$ נקודות, השגיאה היא מסדר $O(h^n)$, כאשר $h$ הוא המרחק בין הנקודות. מכיוון שאנו רוצים $O(h^4)$, אנו צריכים לפחות $4$ נקודות אינטרפולציה.

לכן, האורך של הווקטורים $N_i$ ו-$f_i$ צריך להיות $4$. נשתמש בנקודות מרוחקות באופן שווה בקטע $[0, 0.5]$:
$$x_1 = 0, \quad x_2 = \frac{1}{6}, \quad x_3 = \frac{1}{3}, \quad x_4 = 0.5$$

<div><hr><hr></div>


פולינומי לגראנז' $N_i(x)$ מוגדרים כך:
$$N_i(x) = \prod_{\substack{j=1\\j\neq i}}^{n} \frac{x - x_j}{x_i - x_j}$$
כאשר $n=4$ ו-$x_j$ הן הנקודות שהגדרנו לעיל. נחשב כל אחד מהפולינומים:

$$\begin{aligned}
N_1(x) 
&= \frac{(x-1/6)(x-1/3)(x-0.5)}{(0-1/6)(0-1/3)(0-0.5)} \\[1ex]
&= 36(x-1/6)(x-1/3)(x-0.5)
\end{aligned}$$

$$\begin{aligned}
N_2(x) 
&= \frac{(x-0)(x-1/3)(x-0.5)}{(1/6-0)(1/6-1/3)(1/6-0.5)} \\[1ex]
&= 108  x  (x-1/3)(x-0.5)
\end{aligned}$$

$$\begin{aligned}
N_3(x) &= \frac{(x-0)(x-1/6)(x-0.5)}{(1/3-0)(1/3-1/6)(1/3-0.5)} \\[1ex]
&= -108  x (x-1/6)(x-0.5)
\end{aligned}$$

$$\begin{aligned}
N_4(x)&= \frac{(x-0)(x-1/6)(x-1/3)}{(0.5-0)(0.5-1/6)(0.5-1/3)} \\[1ex]
&= 36 x  (x-1/6)(x-1/3)
\end{aligned}$$

אם נפתח כל אחד מהפולינומים, נקבל:

$$\boxed {
\begin{aligned}
 & N_1(x) = 36\left( x^3 - x^2 + \frac{5}{36}x - \frac{1}{36} \right) \\[1ex]
 & N_2(x)= 108\left( x^3 - \frac{5}{6}x^2 + \frac{1}{6}x \right) \\[1ex]
 & N_3(x) = -108\left( x^3 - \frac{2}{3}x^2 + \frac{1}{12}x \right) \\[1ex]
 & N_4(x) = 36\left( x^3 - \frac{1}{2}x^2 + \frac{1}{18}x \right)
\end{aligned}
 }$$

לפי הגדרת הקרוב, $f_i$, הם ערכי הפונקציה בנקודות הדגימה:
$$\boxed {
\begin{aligned}
 & f_1 = f(0) = 0 \\[1ex]
 & f_2 = f\left(\frac{1}{6}\right)   \approx 0.05126 \\[1ex]
 & f_3 = f\left(\frac{1}{3}\right)  \approx 0.1902 \\[1ex]
 & f_4 = f(0.5) \approx 0.3971
\end{aligned}
 }$$

### סעיף ג'
כתבנו קוד MATLAB שמחשב את האינטרפולציה ומשווה אותה לפונקציה המקורית. הקוד נמצא ב-[GitHub](https://github.com/NuclearGandhi/technion_second_brain/blob/master/Technion/FEM1/FEM1_HW001/code/q1.m).

![[interpolation_plot.png|bookhue|600]]
>השוואת הפונקציה המקורית והקרוב שלה.

הקוד מחשב את ערכי הפונקציה בנקודות האינטרפולציה, ואז משתמש בפולינומי לגראנז' כדי לחשב את הקירוב בכל נקודה ב-$[0, 0.5]$ ולהשוות אותו לפונקציה המקורית.

התוצאות מראות שאינטרפולציה עם $4$ נקודות אכן נותנת קירוב טוב מאוד לפונקציה המקורית, עם שגיאה מקסימלית בסדר גודל שמתאים ל-$O(h^4)$, כפי שצפינו מהתאוריה.

```
Maximum interpolation error: 1.80e-04
Expected error order: O(h^4) = 7.72e-04
```

<div><hr><hr></div>


## שאלה 2
הפונקציה המשלימה לפונקציית השגיאה מוגדרת באופן הבא:
$$\text{erfc}(x) = 1 - \text{erf}(x) = \frac{2}{\sqrt{\pi}} \int_{x}^{\infty} e^{-t^2} \mathrm{d}t$$

נדרש לכתוב פונקציה שמקבלת $x$ ומחזירה $\text{erfc}(x)$, ולהשתמש בה כדי לצייר גרף של $\text{erfc}(x)$ בקטע $[0,1]$. נשתמש בשיטת [[NUM1_009 אינטגרציה נומרית#אינטגרציית גאוס|אינטגרציית גאוס]] כדי לחשב את האינטגרל.

**התמרת האינטגרל מקטע אינסופי לקטע סופי**:
האינטגרל שאנו מחשבים הוא מ-$x$ עד אינסוף:

$$\text{erfc}(x) = \frac{2}{\sqrt{\pi}} \int_{x}^{\infty} e^{-t^2} \mathrm{d}t$$

כדי לחשב אותו עם שיטת גאוס-לז'נדר, צריך להמיר אותו לאינטגרל על קטע סופי. נשתמש בהחלפת המשתנים:

$$t = x + \frac{1+s}{1-s}$$

שממפה את התחום $[x, \infty)$ לתחום $[-1, 1)$. הנגזרת של ההחלפה היא:

$$\mathrm{d}t = \frac{2}{(1-s)^2} \mathrm{d}s$$

ולכן האינטגרל הופך להיות:

$$\text{erfc}(x) = \frac{2}{\sqrt{\pi}} \int_{-1}^{1} e^{-(x + \frac{1+s}{1-s})^2} \cdot \frac{2}{(1-s)^2} \mathrm{d}s$$

<div><hr><hr></div>


**שיטת אינטגרציית גאוס**:
באינטגרציית גאוס, האינטגרל מקורב כסכום משוקלל של ערכי הפונקציה בנקודות מסוימות:

$$\int_{-1}^{1} f(s) \mathrm{d}s \approx \sum_{i=1}^{n} w_i f(s_i)$$

עבור $n=1$ (נקודת אינטגרציה אחת), יש לנו משקל ונקודה על הקטע $[-1,1]$:
- נקודה: $s_1 = 0$
- משקל: $w_1 = 2$

עבור $n=2$ (שתי נקודות אינטגרציה) על הקטע $[-1,1]$:
- נקודות: $s_1 = -\frac{1}{\sqrt{3}},\, s_2 = \frac{1}{\sqrt{3}}$
- משקלים: $w_1 = w_2 = 1$

![[erfc_plot.png|bookhue|600]]
>פונקציית השגיאה לעומת קרובים שלה לפי אינטגרציית גאוס.


קוד לחישוב פונקציית השגיאה המשלימה נמצא ב-[GitHub](https://github.com/NuclearGandhi/technion_second_brain/blob/master/Technion/FEM1/FEM1_HW001/code/q2.m).