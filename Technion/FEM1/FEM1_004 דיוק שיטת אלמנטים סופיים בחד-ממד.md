---
aliases:
---
# מבוא
כפי שראינו, הרעיון המרכזי בשיטת האלמנטים הסופיים הוא לבחור קירוב סופי של הפתרון האמיתי ולנסח את הבעיה החלשה הבאה:

מציאת $u^h \in H^{u^h}(\Omega) \subset H^1(\Omega)$, עם $u^h |_{\Gamma_u} = d$, כך ש-
$$\underbrace{ \int_{\Omega} \dfrac{\mathrm{d}v^h}{\mathrm{d}x}E\dfrac{\mathrm{d}u^h}{\mathrm{d}x}\mathrm{d}x }_{ \mathcal{B}(u^{h},v^{h}) } = \underbrace{ \int_{\Omega}fv^h \mathrm{d}x + v^h t^*|_{\Gamma_t} }_{ \mathcal{F}(u^{h}) }\tag{4.1}$$
כאשר $\forall v^h \in H^{h}_{v}(\Omega) \subset H^1(\Omega)$, עם $v^h |_{\Gamma_u} = 0$.

אנו מתייחסים ל-$H^{h}_{u}(\Omega)$ ו-$H^{h}_{v}(\Omega)$ כמרחבי הקירוב (למשל, פונקציות לינאריות). הנקודה הקריטית היא ש-$H^{h}_{u}(\Omega), H^{h}_{v}(\Omega) \subset H^1(\Omega)$. קירוב "פנימי" זה מאפשר פיתוח של אומדני שגיאה פשוטים. אנו נבחר ב-$H^{h}_{u}(\Omega)$ ו-$H^{h}_{v}(\Omega)$ כזהים.

>[!def] הגדרה: 
>לכל פונקציה קבילה $w \in H^1(\Omega)$, נגדיר את **סמי-נורמת האנרגיה (energy semi-norm)** כך:
> $$\begin{aligned}
> ||u - w||^2_{E(\Omega)} &  := \int_{\Omega} \left( \dfrac{\mathrm{d}u}{\mathrm{d}x} - \dfrac{\mathrm{d}w}{\mathrm{d}x} \right) E \left( \dfrac{\mathrm{d}u}{\mathrm{d}x} - \dfrac{\mathrm{d}w}{\mathrm{d}x} \right) \mathrm{d}x  \\[1ex]
>  & = \mathcal{B}(u-w, u-w) 
> \end{aligned}\quad(4.2)$$

אם תנאי השפה אינם מאפשרים תנועה קשיחה (כלומר, $u-w=\text{const}$ אפשרי רק אם $u-w=0$), אז סמי-נורמת האנרגיה הופכת לנורמה מתמטית קלאסית רגילה.

**אומדן שגיאה בשיטת האלמנטים הסופיים:**
תחת הנחות די מתונות, ניתן להראות ש:

$$||u - u^h||_{E(\Omega)} \leq \mathcal{C}(u,p)h^{\min(r-1,p):=\gamma} \tag{4.3}$$

כאשר $p$ הוא סדר הפולינום של פונקציות הבסיס, $r$ הוא רמת החלקות של הפתרון האמיתי, $h$ הוא גודל האלמנט המקסימלי, ו-$\mathcal{C}$ הוא קבוע התלוי בפתרון ובפולינום אך לא ב-$h$. לא ניכנס לפיתוח של ביטוי זה.

>[!notes] הערה:
> נציין כי קבוצת הפונקציות המוגדרות ע"י $H^{h}_{u}(\Omega) \subset H^1(\Omega)$ עם $u^h|_{\Gamma_u} = d$ אינה טכנית מרחב של פונקציות ויש לאפיין אותה כ"מגוון לינארי". הדבר אינו מהווה בעיה לניתוח שיבוא.

>[!notes] הערה:
> נציין כי $\sqrt{B(u,u)}$ היא נורמה מכיוון ש:
> - היא חיוביות:
> 	$$||u||^2_{E(\Omega)} = \mathcal{B}(u,u) \geq 0 $$
> 	כאשר, בהינתן ש-$u = \text{const}$, $\mathcal{B}(u,u) = 0$ אם ורק אם $u = 0$.
> - מתקיים אי-שוויון המשולש:
> $$\begin{aligned}
> ||u + v||^2_{E(\Omega)}  & = \mathcal{B}(u+v,u+v)  \\[1ex]
> & = \mathcal{B}(u,u) + 2\mathcal{B}(u,v) + \mathcal{B}(v,v)  \\[1ex]
> & \leq ||u||^2_{E(\Omega)} + 2||u||_{E(\Omega)}||v||_{E(\Omega)} + ||v||^2_{E(\Omega)}  \\[1ex]
> & = (||u||_{E(\Omega)} + ||v||_{E(\Omega)})^2
> \end{aligned}$$
> - ניתנת להכפלה בקבוע:
> 	$$||\alpha u||_{E(\Omega)} = \sqrt{\mathcal{B}(\alpha u, \alpha u)} = |\alpha| \sqrt{\mathcal{B}(u,u)}$$

# משפט "הקירוב הטוב ביותר"
פתרון שיטת האלמנטים הסופיים הוא האופטימלי ביותר מבחינת נורמת האנרגיה. כדי להוכיח זאת אנו משתמשים ב[[#מבוא|משוואה]] $\text{(4.1)}$:

$$\mathcal{B}(u,v) = \mathcal{F}(v)\tag{4.7}$$
לכל $v \in H^1(\Omega)$ עם $v|_{\Gamma_u} = 0$ (הפתרון המדויק), ו-

$$\mathcal{B}(u^h,v^h) = \mathcal{F}(v^h)\tag{4.8}$$
לכל $v^h \in H^{h}_{v}(\Omega) \subset H^1(\Omega)$ עם $v^h|_{\Gamma_u} = 0$ (הפתרון הנומרי).

חיסור משוואה $\text{(4.8)}$ מ-$\text{(4.7)}$ (כאשר מציבים $v=v^h$ במשוואה הראשונה) מוביל לתכונת אורתוגונליות בסגנון [[FEM1_001 מבוא ומידול בעיה חד ממדית#שיטת גלרקין|גלרקין]]:

$$\mathcal{B}(u - u^h, v^h) = \mathcal{B}(e^h, v^h) = 0 \tag{4.9}$$
לכל $v^h \in H^{h}_{v}(\Omega)$ עם $v^h|_{\Gamma_u} = 0$, כאשר השגיאה מוגדרת כ- $e^h := u - u^h$. 

נבחר כעת $v^h \in H^{v^h}(\Omega)$ כלשהו ונגדיר $z^h = u^h + v^h$. אז:

$$e^h - v^h = u - u^h - v^h = u - z^h\tag{4.10}$$
כאשר $z^h$ הוא [[FEM1_003 מימוש אלמנט סופי בחד-ממד#מבוא|קירוב קביל קינמטית]] של הפתרון האמיתי. באמצעות ייצוג זה והתכונה מ-$\text{(4.9)}$, אנו מקבלים:
$$\begin{aligned}
\mathcal{B}(e^h - v^h, e^h - v^h) &= \mathcal{B}(e^h, e^h) - 2\mathcal{B}(e^h, v^h) + \mathcal{B}(v^h, v^h)
\end{aligned} \tag{4.11}$$

מכיוון ש-$\mathcal{B}(v^h, v^h) \geq 0$, נקבל:
$$\mathcal{B}(u - u^h, u - u^h) \leq \mathcal{B}(u - z^h, u - z^h)\tag{4.12}$$

זהו **משפט הקירוב הטוב ביותר**, המראה שהקירוב $u^h$ המתקבל משיטת האלמנטים הסופיים הוא הטוב ביותר מבין כל הקירובים האפשריים במרחב $H^{h}_{u}(\Omega)$ מבחינת נורמת האנרגיה.

![[{90C2A63E-78C3-4B7F-9F09-BAA6EA711289}.png|bookhue|500]]
>סכמה של משפט הקירוב הטוב ביותר. [[FEM1_000 00350022 אלמנטים סופיים לאנליזה הנדסית#ביבליוגרפיה|(Zohdi, 2018)]].

# עקרון האנרגיה הפוטנציאלית המינימלית

עקרונות מינימום הם קבוצה של מושגים מועילים ביותר בפיזיקה. נראה כעת כיצד הם מתקשרים לשיטת האלמנטים הסופיים. 

יהי $w \in H^1(\Omega)$ פונקציה קינמטית קבילה כלשהי (כלומר, פונקציה המקיימת את תנאי הגבול). באמצעות הגדרת נורמת האנרגיה, נקבל:

$$\begin{align}||u - w||^2_{E(\Omega)} &= \mathcal{B}(u-w, u-w)  \\[1ex]
 & = \mathcal{B}(u,u) + \mathcal{B}(w,w) - 2\mathcal{B}(u,w) \\[1ex]
\end{align}$$

נארגן מחדש את הביטוי:
$$\begin{align}
||u - w||^2_{E(\Omega)} &= \mathcal{B}(w,w) - \mathcal{B}(u,u) + 2\mathcal{B}(u,u) - 2\mathcal{B}(u,w) \\[1ex]
&= \mathcal{B}(w,w) - \mathcal{B}(u,u) - 2\mathcal{B}(u,w-u) \\[1ex]
\end{align}$$

מכיוון שהפתרון האמיתי $u$ מקיים את משוואת הבעיה החלשה $\mathcal{B}(u,v) = \mathcal{F}(v)$ לכל $v \in H^1(\Omega)$ עם $v|_{\Gamma_u} = 0$, וגם $w-u$ מקיים את תנאי הגבול ההומוגני (שכן $w$ ו-$u$ מקיימים את אותם תנאי גבול), נוכל להציב $v = w-u$ ולקבל:

$$\begin{align}
||u - w||^2_{E(\Omega)} &= \mathcal{B}(w,w) - \mathcal{B}(u,u) - 2\mathcal{F}(w-u) \\[1ex]
&= \mathcal{B}(w,w) - 2\mathcal{F}(w) - (\mathcal{B}(u,u) - 2\mathcal{F}(u)) \\[1ex]
&= 2\mathcal{J}(w) - 2\mathcal{J}(u) \tag{4.13}
\end{align}$$

כאשר הגדרנו את ה"פוטנציאל" באופן הבא:
$$\begin{align}
\mathcal{J}(w) & := \dfrac{1}{2}\mathcal{B}(w,w)-\mathcal{F}(w) \\[1ex]
 & =\dfrac{1}{2}\int_{\Omega} \dfrac{\mathrm{d}w}{\mathrm{d}x}E \dfrac{\mathrm{d}w}{\mathrm{d}x} \mathrm{d}x -\int_{\Omega} fw \mathrm{d}x -t^{*}w\bigg|_{{\Gamma}_{t}} \tag{4.14}
\end{align}$$

מכיוון ש-$||u - w||^2_{E(\Omega)} \geq 0$ עבור כל $w$, נקבל:
$$0 \leq ||u - w||^2_{E(\Omega)} = 2(\mathcal{J}(w) - \mathcal{J}(u)) \implies \mathcal{J}(u) \leq \mathcal{J}(w) \tag{4.15}$$

ביטוי זה ידוע כ**עקרון האנרגיה הפוטנציאלית המינימלית** (Principle of Minimum Potential Energy - PMPE). במילים אחרות, הפתרון האמיתי $u$ ממזער את האנרגיה הפוטנציאלית $\mathcal{J}$ מבין כל הפונקציות הקבילות מבחינה קינמטית.

# אומדנים פשוטים לרשתות FEM מתאימות
התוצאות שהצגנו בסעיפים הקודמים מאפשרות לנו לפתח אומדנים לגודל הרשת הנדרש כדי להשיג דיוק מסוים. 

כפי שראינו במשוואה $\text{(4.3)}$, תחת הנחות סבירות, שגיאת הקירוב של שיטת האלמנטים הסופיים מוגבלת על ידי:
$$||u - u^h||_{E(\Omega)} \leq \mathcal{C}(u,p)h^{\gamma}, \quad \gamma = \min(r-1,p)$$

כאשר:
- $p$ הוא סדר הפולינום של פונקציות הבסיס (למשל, $p=1$ עבור פונקציות לינאריות)
- $r$ הוא מדד החלקות של הפתרון האמיתי $u$ (בד"כ מוגדר לפי מרחב סובולב $H^r$)
- $h$ הוא הגודל המקסימלי של אלמנט ברשת
- $\mathcal{C}$ הוא קבוע שאינו תלוי ב-$h$ אלא רק בפתרון ובסדר הקירוב

בנוסף, משילוב עם עקרון האנרגיה הפוטנציאלית המינימלית (משוואה $\text{(4.15)}$) עבור $w = u^h$, נקבל:

$$||u - u^h||^2_{E(\Omega)} = 2(\mathcal{J}(u^h) - \mathcal{J}(u)) \tag{4.20}$$

משוואה זו מספקת קשר ישיר בין שגיאת האנרגיה לבין הפרש האנרגיה הפוטנציאלית בין הפתרון המקורב לפתרון האמיתי.

## חישוב קבוע השגיאה והערכת גודל הרשת

מכיוון שהפתרון האמיתי $u$ אינו ידוע לנו בדרך כלל, איננו יכולים לחשב ישירות את $\mathcal{J}(u)$. במקום זאת, אנו יכולים לפתור את הבעיה עם שתי רשתות בעלות רזולוציות שונות, $h_1 > h_2$, ולהעריך את קבוע השגיאה $C$.

בהינתן ש-$\mathcal{J}(u^{h_1}) \geq \mathcal{J}(u^{h_2}) \geq \mathcal{J}(u)$ (הנובע מעקרון האנרגיה המינימלית), נוכל להציב במשוואת השגיאה:

$$\begin{gathered}
||u - u^{h_1}||^2_{E(\Omega)} = 2(\mathcal{J}(u^{h_1}) - \mathcal{J}(u)) \approx C^2h^{2\gamma}_1 \\[1ex]
||u - u^{h_2}||^2_{E(\Omega)} = 2(\mathcal{J}(u^{h_2}) - \mathcal{J}(u)) \approx C^2h^{2\gamma}_2
\end{gathered}\tag{4.21}$$

על ידי חיסור המשוואות זו מזו ופתרון עבור $C$, נקבל:

$${C} = \sqrt{\frac{2(\mathcal{J}(u^{h_1})-\mathcal{J}(u^{h_2}))}{h^{2\gamma}_1-h^{2\gamma}_2}}\tag{4.22}$$

לאחר שמצאנו את $C$, אנו יכולים לחשב את גודל הרשת $h_{\text{tol}}$ הנדרש כדי להשיג שגיאה קטנה מסף נתון $\mathrm{TOL}$:

$$Ch^{\gamma}_{\text{tol}} \approx \mathrm{TOL} \implies h_{\text{tol}} \approx \left( \frac{\mathrm{TOL}}{{C}} \right)^{1/\gamma} \tag{4.23}$$

לסיכום, תהליך הערכת גודל הרשת האופטימלי מורכב מהצעדים הבאים:

### #אלגוריתם: חישוב גודל רשת אופטימלי
1. **פתרון על רשת גסה**:
   פתור את הבעיה על רשת עם גודל אלמנט ${h}_{1}$ וחשב את ערך האנרגיה הפוטנציאלית $\mathcal{J}(u^{{h}_{1}})$.

2. **פתרון על רשת עדינה יותר**:
   פתור את אותה בעיה על רשת עדינה יותר עם גודל אלמנט ${h}_{2}=K\cdot {h}_{1}$ (כאשר $K < 1$, למשל $K = 0.5$) וחשב את $\mathcal{J}(u^{{h}_{2}})$.

3. **חישוב קבוע השגיאה והערכת גודל הרשת האופטימלי**:
   חשב את קבוע השגיאה $C$ באמצעות משוואה $\text{(4.22)}$ ואז קבע את גודל הרשת האופטימלי ${h}_{\text{tol}}$ לפי משוואה $\text{(4.23)}$.

>[!notes] הערות: 
> - לרוב בוחרים $K=0.5$, כלומר מחצית את גודל האלמנט בין הרשת הגסה לעדינה.
> - שיטה זו מספקת הערכה גלובלית לגודל הרשת, אך באזורים מורכבים של הפתרון (למשל, שינויים חדים) ייתכן שנדרש עידון רשת מקומי נוסף.
> - בפועל, כדאי להשתמש בערך שמרני יותר של $h_{\text{tol}}$ מזה שחושב, כדי להבטיח שהשגיאה אכן תהיה קטנה מהסף הנדרש.

![[{CB60B07E-08B0-4730-9D6A-CBF3DD9D897F}.png|bookhue|600]]
>רשת שעודנה ב-$K=0.5$ כדי להעריך את השגיאה. [[FEM1_000 00350022 אלמנטים סופיים לאנליזה הנדסית#ביבליוגרפיה|(Zohdi, 2018)]].

# עידון רשת מקומית (Local Mesh Refinement)

בעוד שהשיטות הגלובליות שתוארו לעיל מאפשרות לנו להעריך את גודל הרשת הממוצע הדרוש, לעתים קרובות אנו זקוקים לרשת צפופה יותר באזורים מסוימים של התחום, במיוחד היכן שהפתרון משתנה במהירות (למשל, ליד גבולות או מקורות).

## שיטות מבוססות שארית

הגישה הפשוטה והיעילה ביותר לעידון רשת מקומי היא להשתמש בשארית (residual) כמדריך לאזורים שבהם דרוש עידון. יתרונה של גישה זו הוא שהיא אינה דורשת פתרון של מערכת משוואות נוספת, אלא רק חישוב של מספר ביטויים מקומיים.

שיטות מבוססות שארית משתמשות בשלושה מקורות מידע:
1. פתרון שיטת האלמנטים הסופיים עצמו ($u^h$)
2. תנאי הגבול הנתונים
3. משוואת השגיאה ותכונת האורתוגונליות של גלרקין

באמצעות אלה, ניתן לבנות את החסם השגיאה הבא:

$$\begin{align}
||u - u^h||^2_{E(\Omega)} &\leq \overbrace{ C_1\sum^N_{e=1}h^2_e||r_1||^2_{L^2(\Omega_e)} }^{ \text{interior}} \\[1ex]
&+ \underbrace{ C_2\sum^{INT}_I h_{eI}||[|r_2|]||^2_{L^2(\partial\Omega_I)} }_{ \text{interfaces} } \\[1ex]
&+ \underbrace{ C_3\sum^{B-INT}_J h_{eJ}||r_3||^2_{L^2(\partial{\Omega}_{JB})} }_{ \text{exterior-boundary}} \\[1ex]
\end{align}\tag{4.25}$$

כאשר:

* **$C_1$, $C_2$ ו-$C_3$** הם קבועים
* **$h_e$** הוא גודל האלמנט $e$
* **$r_1$** היא השארית הפנימית של האלמנט, המוגדרת כ:
$$r_1 = \frac{\mathrm{d}}{\mathrm{d}x}\left( E(x)\frac{\mathrm{d}u^h}{\mathrm{d}x} \right) + f$$
  שארית זו מודדת עד כמה הפתרון המקורב מפר את המשוואה הדיפרנציאלית בתוך האלמנט.

* **$[|r_2|]$** היא ה"קפיצה" בשטף בממשק בין אלמנטים, המוגדרת כ:
$$[|r_2|] = \left( E(x)\frac{\mathrm{d}u^h}{\mathrm{d}x} \right)_{x^+} - \left( E(x)\frac{\mathrm{d}u^h}{\mathrm{d}x} \right)_{x^-}$$
  כאן $x^+$ ו-$x^-$ מייצגים את הצדדים הימני והשמאלי של הממשק, בהתאמה. הקפיצה בשטף מודדת את אי-הרציפות של הנגזרת הראשונה (המוכפלת ב-$E(x)$) בגבולות בין אלמנטים.

* **$r_3$** היא שארית גבול חיצוני, המוגדרת כ:
$$r_3 = \left( E(x)\frac{\mathrm{d}u^h}{\mathrm{d}x} \right) - t^* \qquad x \in {\Gamma}_{t}$$
  שארית זו מודדת את מידת אי-קיום תנאי הגבול מסוג נוימן.

## אינדיקטורי שגיאה מקומיים

בהתבסס על החסם לעיל, אנו יכולים להגדיר אינדיקטור שגיאה מקומי לכל אלמנט:

$$\begin{aligned}
\zeta^2_e &  = C_1h^2_e||r_1||^2_{L^2(\Omega_e)} \\[1ex]
 & \qquad  + C_2h_{eI}||[|r_2|]||^2_{L^2(\partial\Omega_I)} \\[1ex]
 &  \qquad + C_3h_{eJ}||r_3||^2_{L^2(\partial{\Omega}_{JB})}
\end{aligned} \tag{4.26}$$

אינדיקטור זה מורכב משלושה מרכיבים:
1. שארית הפנימית (חוסר קיום המשוואה הדיפרנציאלית בתוך האלמנט)
2. קפיצות בשטף בממשקים בין אלמנטים
3. חוסר התאמה לתנאי גבול מסוג נוימן

![[{02E5E2D9-884D-4934-892E-7EFEF697B79C}.png|bookhue|600]]
>רשת מעודנת מקומית לחישוב פתרונות מקומיים מדויקים יותר. [[FEM1_000 00350022 אלמנטים סופיים לאנליזה הנדסית#ביבליוגרפיה|(Zohdi, 2018)]].

### #אלגוריתם עידון המקומי

האלגוריתם הפשוט ביותר לעידון רשת מקומי מבוסס על הצעדים הבאים:

1. **פתרון הבעיה**: פתור את בעיית האלמנטים הסופיים על הרשת הנוכחית.
2. **חישוב אינדיקטורי שגיאה**: חשב את ערך $\zeta_e$ לכל אלמנט ברשת.
3. **בחירת אלמנטים לעידון**: כל אלמנט שעבורו $\zeta_e > \text{TOL}$ מסומן לעידון.
4. **עידון הרשת**: חלק את האלמנטים המסומנים לאלמנטים קטנים יותר.
5. **חזרה**: חזור לצעד 1 עד שכל האינדיקטורים קטנים מהסף הנדרש $\text{TOL}$.

שיטה זו מאפשרת לנו ליצור רשת מותאמת באופן אופטימלי לבעיה הספציפית, עם אלמנטים קטנים יותר באזורים שבהם הפתרון משתנה במהירות ואלמנטים גדולים יותר באזורים שבהם הפתרון חלק יותר. זהו יתרון משמעותי של שיטת האלמנטים הסופיים האדפטיבית על פני שיטות עם רשת אחידה.
