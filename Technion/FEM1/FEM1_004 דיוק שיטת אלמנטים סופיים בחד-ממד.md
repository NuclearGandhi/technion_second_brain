---
aliases:
---
# מבוא
כפי שראינו, הרעיון המרכזי בשיטת האלמנטים הסופיים הוא לבחור קירוב סופי של הפתרון האמיתי ולנסח את הבעיה החלשה הבאה:

מציאת $u^h \in H^{u^h}(\Omega) \subset H^1(\Omega)$, עם $u^h |_{\Gamma_u} = d$, כך ש-
$$\underbrace{ \int_{\Omega} \dfrac{\mathrm{d}v^h}{\mathrm{d}x}E\dfrac{\mathrm{d}u^h}{\mathrm{d}x}\mathrm{d}x }_{ \mathcal{B}(u^{h},v^{h}) } = \underbrace{ \int_{\Omega}fv^h \mathrm{d}x + v^h t^*|_{\Gamma_t} }_{ \mathcal{F}(u^{h}) }\tag{4.1}$$
כאשר $\forall v^h \in H^{h}_{v}(\Omega) \subset H^1(\Omega)$, עם $v^h |_{\Gamma_u} = 0$.

אנו מתייחסים ל-$H^{h}_{u}(\Omega)$ ו-$H^{h}_{v}(\Omega)$ כמרחבי הקירוב (למשל, פונקציות לינאריות). הנקודה הקריטית היא ש-$H^{h}_{u}(\Omega), H^{h}_{v}(\Omega) \subset H^1(\Omega)$. קירוב "פנימי" זה מאפשר פיתוח של אומדני שגיאה פשוטים. אנו נבחר ב-$H^{h}_{u}(\Omega)$ ו-$H^{h}_{v}(\Omega)$ כזהים.

>[!def] הגדרה: 
>לכל פונקציה קבילה $w \in H^1(\Omega)$, נגדיר את **סמי-נורמת האנרגיה (energy semi-norm)** כך:
> $$\begin{aligned}
> ||u - w||^2_{E(\Omega)} &  := \int_{\Omega} \left( \dfrac{\mathrm{d}u}{\mathrm{d}x} - \dfrac{\mathrm{d}w}{\mathrm{d}x} \right) E \left( \dfrac{\mathrm{d}u}{ddx} - \dfrac{\mathrm{d}w}{\mathrm{d}x} \right) \mathrm{d}x  \\[1ex]
>  & = \mathcal{B}(u-w, u-w) 
> \end{aligned}\quad(4.2)$$

אם תנאי השפה אינם מאפשרים תנועה קשיחה (כלומר, $u-w=\text{const}$ אפשרי רק אם $u-w=0$), אז סמי-נורמת האנרגיה הופכת לנורמה מתמטית קלאסית רגילה.

**אומדן שגיאה בשיטת האלמנטים הסופיים:**
תחת הנחות די מתונות, ניתן להראות ש:

$$||u - u^h||_{E(\Omega)} \leq \mathcal{C}(u,p)h^{\min(r-1,p):=\gamma} \tag{4.3}$$

כאשר $p$ הוא סדר הפולינום של פונקציות הבסיס, $r$ הוא רמת החלקות של הפתרון האמיתי, $h$ הוא גודל האלמנט המקסימלי, ו-$\mathcal{C}$ הוא קבוע התלוי בפתרון ובפולינום אך לא ב-$h$. לא ניכנס לפיתוח של ביטוי זה.

>[!notes] הערה:
> נציין כי קבוצת הפונקציות המוגדרות ע"י $H^{h}_{u}(\Omega) \subset H^1(\Omega)$ עם $u^h|_{\Gamma_u} = d$ אינה טכנית מרחב של פונקציות ויש לאפיין אותה כ"מגוון לינארי". הדבר אינו מהווה בעיה לניתוח שיבוא.

>[!notes] הערה:
> נציין כי $\sqrt{B(u,u)}$ היא נורמה מכיוון ש:
> - היא חיוביות:
> 	$$||u||^2_{E(\Omega)} = \mathcal{B}(u,u) \geq 0 $$
> 	כאשר, בהינתן ש-$u = \text{const}$, $\mathcal{B}(u,u) = 0$ אם ורק אם $u = 0$.
> - מתקיים אי-שוויון המשולש:
> $$\begin{aligned}
> ||u + v||^2_{E(\Omega)}  & = \mathcal{B}(u+v,u+v)  \\[1ex]
> & = \mathcal{B}(u,u) + 2\mathcal{B}(u,v) + \mathcal{B}(v,v)  \\[1ex]
> & \leq ||u||^2_{E(\Omega)} + 2||u||_{E(\Omega)}||v||_{E(\Omega)} + ||v||^2_{E(\Omega)}  \\[1ex]
> & = (||u||_{E(\Omega)} + ||v||_{E(\Omega)})^2
> \end{aligned}$$
> - ניתנת להכפלה בקבוע:
> 	$$||\alpha u||_{E(\Omega)} = \sqrt{\mathcal{B}(\alpha u, \alpha u)} = |\alpha| \sqrt{\mathcal{B}(u,u)}$$

# משפט "הקירוב הטוב ביותר"
פתרון שיטת האלמנטים הסופיים הוא האופטימלי ביותר לפי נורמת האנרגיה. כדי להוכיח זאת אנו משתמשים ב[[#מבוא|משוואה]] $\text{(4.1)}$:

$$\mathcal{B}(u,v) = \mathcal{F}(v)\tag{4.7}$$
כאשר $\forall v \in H^1(\Omega)$ ו-

$$\mathcal{B}(u^h,v^h) = \mathcal{F}(v^h)\tag{4.8}$$
כאשר $\forall v^h \in H^{v^h}(\Omega) \subset H^1(\Omega)$. חיסור משוואה $\text{(4.8)}$ מ-$\text{(4.7)}$ מוביל לתכונת אורתוגונליות בסגנון [[FEM1_001 מבוא ומידול בעיה חד ממדית#שיטת גלרקין|גלרקין]] של "קירובים פנימיים":

$$\mathcal{B}(u - u^h, v^h) = \mathcal{B}(e^h, v^h) = 0 \tag{4.9}$$
כאשר $\forall v^h \in H^{v^h}(\Omega) \subset H^1(\Omega)$ וגם השגיאה מוגדרת ע"י $e^h := u - u^h$. נשים לב שכל איבר של תת-המרחב ניתן לייצוג ע"י

$$e^h - v^h = u - u^h - v^h = u - z^h\tag{4.10}$$
כאשר $z^h$ הוא [[FEM1_003 מימוש אלמנט סופי בחד-ממד#מבוא|קביל קינמטית]]. באמצעות ייצוג זה יש לנו
$$\mathcal{B}(e^h - v^h, e^h - v^h) = \mathcal{B}(e^h, e^h) - 2\mathcal{B}(e^h, v^h) + \mathcal{B}(v^h, v^h), \tag{4.11}$$
ולפיכך:
$$\mathcal{B}(u - u^h, u - u^h) \leq \mathcal{B}(u - z^h, u - z^h)\tag{4.12}$$

זהו **משפט הקירוב הטוב ביותר**.

![[{90C2A63E-78C3-4B7F-9F09-BAA6EA711289}.png|bookhue|500]]
>סכמה של משפט הקירוב הטוב ביותר. [[FEM1_000 00350022 אלמנטים סופיים לאנליזה הנדסית#ביבליוגרפיה|(Zohdi, 2018)]].

# עקרון האנרגיה הפוטנציאלית המינימלית

קבוצה שימושית של מושגים בפיזיקה הם *עקרונות מינימום*. יהי $w \subset H^1(\Omega)$ פונקציה קינמטית קבילה כלשהי. אזי:

$$\begin{align}||u - w||^2_{E(\Omega)} &= \mathcal{B}(u-w, u-w)  \\[1ex]
 & = \mathcal{B}(u,u) + \mathcal{B}(w,w) - 2\mathcal{B}(u,w) \\[1ex]
&= \mathcal{B}(w,w) - \mathcal{B}(u,u) - 2\mathcal{B}(u,w) + 2\mathcal{B}(u,u) \\[1ex]
&= \mathcal{B}(w,w) - \mathcal{B}(u,u) - 2\mathcal{B}(u,w-u) \\[1ex]
&= \mathcal{B}(w,w) - \mathcal{B}(u,u) - 2\mathcal{F}(w-u) \\[1ex]
&= \mathcal{B}(w,w) - 2\mathcal{F}(w) - (\mathcal{B}(u,u) - 2\mathcal{F}(u)) \\[1ex]
&= 2\mathcal{J}(w) - 2\mathcal{J}(u) \tag{4.13}
\end{align}$$
כאשר אנו מגדירים את "הפוטנציאל" באמצעות
$$\begin{align}
\mathcal{J}(w) & := \dfrac{1}{2}\mathcal{B}(w,w)-\mathcal{F}(w) \\[1ex]
 & =\dfrac{1}{2}\int_{\Omega}^{}  \dfrac{\mathrm{d}w}{\mathrm{d}x}E \dfrac{\mathrm{d}w}{\mathrm{d}x} \, \mathrm{d}x -\int_{\Omega}^{} fw \, \mathrm{d}x -t^{*}w\bigg|_{{\Gamma}_{t}}^{}  \tag{4.14}
\end{align}$$
מכאן נובע
$$0 \leq ||u - w||^2_{E(\Omega)} = 2(\mathcal{J}(w) - \mathcal{J}(u)) \text{ or } \mathcal{J}(u) \leq \mathcal{J}(w), \quad(4.15)$$
כאשר משוואה $\text{(4.15)}$ ידועה כ**עקרון האנרגיה הפוטנציאלית המינימלית (Principle of Minimum Potential Energy - PMPE)**. במילים אחרות, לפתרון האמיתי יש את הפוטנציאל המינימלי.

# אומדנים פשוטים לרשתות FEM מתאימות
התוצאות הקודמות מייצרות אומדנים לדיוק הרשת עבור דיוק רצוי. כפי שצוין קודם, תחת הנחות סטנדרטיות, אומדן השגיאה הקלאסי לשיטת האלמנטים הסופיים הוא משוואה $\text{(4.3)}$:
$$||u - u^h||_{E(\Omega)} \leq \mathcal{C}(u,p)h^{\min(r-1,p):=\gamma}$$
באמצעות עקרון האנרגיה הפוטנציאלית המינימלית לפתרון אלמנטים סופיים, משוואה $\text{(4.15)}$, עם $w = u^h$:

$$||u - u^h||^2_{E(\Omega)} = 2(\mathcal{J}(u^h) - \mathcal{J}(u)) \tag{4.20}$$
על-ידי פתרון בעיית התנאי שפה המתאימה עבור שתי רשתות עדינות יותר בזו אחר זו, $h_1 > h_2$, עם התכונה $\mathcal{J}(u^{h_1}) \geq \mathcal{J}(u^{h_2}) \geq \mathcal{J}(u^{h=0})$, נוכל להגדיר את מערכת המשוואות הבאה עבור קבוע לא ידוע $C$:

$$\begin{gathered}
||u - u^{h_1}||^2_{E(\Omega)} = 2(\mathcal{J}(u^{h_1}) - \mathcal{J}(u)) \approx C^2h^{2\gamma}_1 \\[1ex]
||u - u^{h_2}||^2_{E(\Omega)} = 2(\mathcal{J}(u^{h_2}) - \mathcal{J}(u)) \approx C^2h^{2\gamma}_2
\end{gathered}\tag{4.21}$$

הפתרון עבור $\mathcal{C}$:

$${C} = \sqrt{\frac{2(\mathcal{J}(u^{h_1})-\mathcal{J}(u^{h_2}))}{h^{2\gamma}_1-h^{2\gamma}_2}}\tag{4.22}$$
כעת ניתן לפתור את גודל הרשת המתאים על ידי כתיבת
$$Ch^{\gamma}_{\text{tol}} \approx \mathrm{TOL} $$
או פשוט:
$$ h_{\text{tol}} \approx \left( \frac{\mathrm{TOL}}{{C}} \right)^{1/\gamma} \tag{4.23}$$
לסיכום, כדי למצוא את שגיאת הדיסקרטיזציה (הפעולה של להפוך משהו לבדיד, שזה תאכלס מה שאנחנו עושים לתחום של הבעיה), אנו מיישמים את האלגוריתם הבא:

###  #אלגוריתם: חישוב שגיאת הדיסקרטיזציה
1. נפתור עם רשת גסה:
	$${h}_{1}\implies u^{{h}_{1}}\implies \mathcal{J}(u^{{h}_{1}})$$
2. נפתור עם רשת עדינה יותר:
	$${h}_{2}=K\cdot {h}_{1}\implies u^{{h}_{2}}\implies \mathcal{J}(u^{{h}_{2}})$$
3. נחשב את ${C}$, ומכאן נחשב את ${h}_{\text{tol}}$
	$${h}_{\text{tol}}\approx \left( \dfrac{\mathrm{TOL}}{C} \right)^{1/\gamma}$$

>[!notes] הערות: 
> בעוד שסכמה זו מספקת אומדן פשוט לעדינות הרשת הגלובלית הנדרשת, הרשתות צריכות להיות מעודנות מקומית כדי להבטיח דיוק סביר בכל התחום.

![[{CB60B07E-08B0-4730-9D6A-CBF3DD9D897F}.png|bookhue|600]]
>רשתות שעודנו (מהמילה עדין) ברצף (מוחצות, $K=0.5$) המשמשות להערכת השגיאה.
# עידון רשת מקומית (Local Mesh Refinement)
כנראה שהגישה הפשוטה ביותר לעִדּוּן רשת מקומי היא להשתמש בשארית כמדריך. שיטות שארית אינן דורשות פתרון מערכת משוואות. שיטות כאלה מגבילות את השגיאה על ידי שימוש ב-
* הפתרון של FEM עצמו
* הנתונים על הגבול
* משוואת השגיאה
* תכונת האורתוגונליות של גלרקין

הגישה היא ליצור את החסם הבא:

$$\begin{align}
||u - u^h||^2_{E(\Omega)} &  \leq \overbrace{ C_1\sum^N_{e=1}h^2_e||r_1||^2_{L^2(\Omega_e)} }^{ \text{interior} } \\[1ex]
 &  +\underbrace{  C_2\sum^{INT}_I h_{eI}||[|r_2|]||^2_{L^2(\partial\Omega_I)} }_{ \text{interfaces} }  \\[1ex]
 & + \underbrace{ C_3\sum^{B-INT}_J h_{eJ}||r_3||^2_{L^2(\partial\Omega^B_J)} }_{ \text{exterior-boundary} } \\[1ex]
\end{align}\tag{4.25}$$

כאשר
* $C_1$, $C_2$, ו-$C_3$ הם קבועים,
* $h_e$ הם הגדלים של האלמנטים,
* השארית הפנימית של האלמנט היא
	$$r_1 = \frac{\mathrm{d}}{\mathrm{d}x}\left( E(x)\frac{\mathrm{d}u^h}{\mathrm{d}x} \right) + f$$
* השארית ה"קופצת" של הממשק הפנימי היא
	$$[|r_2|] = \left( E(x)\frac{\mathrm{d}u^h}{\mathrm{d}x} \right)_{x^+} - \left( E(x)\frac{\mathrm{d}u^h}{\mathrm{d}x} \right)_{x^-}$$
* שארית ממשק הגבול ("אי-שביעות רצון") היא
	$$r_3 = \left(  E(x)\frac{\mathrm{d}u^h}{\mathrm{\mathrm{d}}x} \right) - t^* \qquad x \in {\Gamma}_{t}$$
* אינדיקטורי שגיאה מקומיים מוגדרים על ידי

$$\zeta^2_e \stackrel{\text{def}}{=} C_1h^2_e||r_1||^2_{L^2(\Omega_e)} + C_2h_{eI}||[|r_2|]||^2_{L^2(\partial\Omega_I)} + C_3h_{eJ}||r_3||^2_{L^2(\partial\Omega^B_J)} \tag{4.26}$$

הכמויות המקומיות $\zeta_e$ משמשות להחלטה האם אלמנט צריך להיות מעודן.

![[{02E5E2D9-884D-4934-892E-7EFEF697B79C}.png|bookhue|600]]
>רשת מעודנת מקומית ללכידת מאפייני פתרון עדינים יותר.

אם ${\zeta}_{e}>\mathrm{TOL}$, אז האלמנט מעודן.
