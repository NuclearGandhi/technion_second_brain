---
aliases: שיטת שארית משקוללת, שיטת גלרקין
---
# שיטות נומריות בסיסיות
בתרגול הראשון עוברים על:
1. [[CAL1_006 פולינום טיילור#טיילור|טור טיילור]]
2. [[NUM1_007 אינטרפולציה פולינומית#מבוא|אינטרפולציה]]
3. [[NUM1_009 אינטגרציה נומרית#מבוא|אינטגרציה נומרית]].

מ[[FEM1_000 00350022 אלמנטים סופיים לאנליזה הנדסית#ביבליוגרפיה|(Zohdi, 2018)]]:
## מבוא: שיטות שאריות המשוקללות
נביט במד"ר חד ממדית מהצורה
$$A(u)=f\tag{1.1}$$
כאשר, למשל:
$$A(u)=\dfrac{\mathrm{d}}{\mathrm{d}x}\left( {A}_{1} \dfrac{\mathrm{d}u}{dx} \right)+{A}_{2}u,\qquad {A}_{1}={A}_{1}(x),\qquad {A}_{2}={A}_{2}(x)$$
נשער פתרון מהצורה
$$u^{N}=\sum_{i=1}^{N}{a}_{i}{\phi}_{i}(x) \tag{1.2}$$
כאשר ה-${\phi}_{i}$-ים הם פונקציות קירוב, וה-${a}_{i}$-ים הם קבועים לא ידועים שאנו צריכים למצוא. כאשר נחסר את הקירוב מהפתרון האמיתי, נישאר עם "שארית":
$$r^{N}(x)=A(u^{N})-f \tag{1.3}$$
אם אנו מניחים שאנו יודעים את ה-$\phi$-ים, נרצה לבחור את ה-${a}_{i}$-ים כך שהשארית תהיה כמה שיותר קטנה. למעשה, אנו רוצים שה-*[[NUM1_003 נורמה#נורמה של וקטור|נורמה]]* של השארית, $\lVert r \rVert$, תהיה כמה שיותר קטנה. אנו נחליט לעבוד עם נורמה-$2$, המוגדרת:
$$\Pi(r^{N}):= \lVert r^{N} \rVert ^{2}:=\int_{0}^{L} (r^{N}(x))^{2} \, \mathrm{d}x \tag{1.4}$$
כאשר ניקח את הנגזרת ביחס לכל ${a}_{i}$, ונאפס, נקבל לכל $i=1,2,\dots,N$:
$$\dfrac{ \partial \Pi }{ \partial {a}_{i} }=\int_{0}^{L} 2r^{N} \dfrac{ \partial r^{N} }{ \partial {a}_{i} }  \, \mathrm{d}x=0\tag{1.5}  $$
זה מוביל אותנו ל-$N$ משוואות עם $N$ נעלמים. שיטה זו נקראת [[NUM1_008 בעיית הריבועים הפחותים#ריבועים פחותים|שיטת הריבועים הפחותים]].

## שיטת גלרקין
מתוך כל שיטות השארית המשוקללת, **שיטת גלרקין (Galerkin's method)** היא הכי נפוצה ומדויקת למספר רב של בעיות.
נביט בפתרון האמיתי, המקורב, והשגיאה, הקשורים דרך:
$$u-u^{N}=e^{N}\implies u=u^{N}+e^{N}\tag{1.10}$$
כעזר, נתייחס להם כוקטורים:
![[{C4C6D4C2-FC3E-4186-A6F8-9927F0F659DD}.png|bookhue|400]]
>אורתוגונליות של שגיאת הקירוב.

ניתן לראות שהשגיאה $e^{N}$ היא הקטנה ביותר כאשר $e^{N}$ היא אורתוגונלית ל-$u^{N}$. הבעיה היא שהשגיאה $e^{N}=u-u^{N}$ לא ידועה. אבל, השארית, כן ידועה.


>[!notes] הערה: 
 >בעוד השגיאה והשארית הם *לא אותו הדבר*, נשים לב שכאשר השארית אפס, השגיאה היא גם אפס.

הבחנה זו היא הבסיס לרעיון מאחורי שיטת גלרקין - נאלץ את השארית $r^{N}$ להיות אורתוגונלית $u^{N}$. מתמטית, לפי ההגדרה של [[PDE1_005 בעיית שטורם ליוביל#אורתוגנליות|אורתוגונליות]] לפונקציות:
$$\begin{gather}
\int_{0}^{L} r^{N}(x)u^{N}(x) \, \mathrm{d}x=0 \\[1ex]
\int_{0}^{L} r^{N}(x)\sum_{i=1}^{N}{a}_{i}{\phi}_{i}  \, \mathrm{d}x =0 \tag{1.11}
\end{gather}$$
מכך אנו מקבלים משוואה אחת. לכן, אנו אוכפים זאת לכל אחד מהפונקציות קירוב, שביחד מרכיבים את מרחב הקירובים שבונים את $u^{N}$,
$$\begin{gather}
\int_{0}^{L} r^{N}(x){a}_{i}{\phi}_{i}(x) \, \mathrm{d}x =0 \\[1ex]
{a}_{i}\int_{0}^{L} r^{N}(x){\phi}_{i}(x) \, \mathrm{d}x =0 \\[1ex]
\boxed {
\int_{0}^{L} r^{N}(x){\phi}_{i}(x) \, \mathrm{d}x=0 
 }\tag{1.12}
\end{gather} $$
כעת יש לנו $N$ משוואות עם $N$ נעלמים, שאיתם נוכל לחשב את ${a}_{i}$.

השיטה הכללית:
1. חישוב השארית:
	$$r^{N}(x)=A(u^{N})-f$$
2. נאלץ את השארית להיות אורתוגונלית לכל אחת מהפונקציות קירוב:
	$$\int_{0}^{L} r^{N}(x){\phi}_{i}(x) \, \mathrm{d}x =0,\qquad i=1,2,\dots ,N$$
3. נפתור את מערכת המשוואות (שהן כנראה מצומדות). המשוואה תהיה לינארית אם המשוואה הדיפרנציאלית לינארית, ואי-לינארית אם המשוואה הדיפרנציאלית אי-לינארית.

הבעיה המרכזית בשיטה זו היא שאין דרך שיטתית לבחירת פונקציות הקירוב ${\phi}_{i}$. שיטת האלמנטים הסופיים הבסיסית פותחה כהרחבה לשיטת גלרקין ע"י בניית פונקציות ${\phi}_{i}$ כדי לטפל בבעיות כאלו. היא:
1. מבוססת על שיטת גלרקין.
2. שיטתי ויעיל מבחינה חישובית.
3. מבוססת על הגדרה מחדש של המד"ח כדי להימנע מהדרישות המחמירות של אופן פתירת המד"ח.




# תרגילים
## שאלה 1
נתונה הבעיה בצורתה החלשה הבאה:
$$\begin{aligned}
 & -\dfrac{\mathrm{d}}{\mathrm{d}x}\left( (x+2) \dfrac{\mathrm{d}u}{\mathrm{d}x} \right)=1,\qquad 0<x<1 \\[1ex]
 & u(0)=0 \\[1ex]
 & u(1)=u^{*}=\pu{1e-4}
\end{aligned} \tag{E1.1}$$
פתרונה האנליטי הוא:
$$u=-x+\dfrac{1.0001}{\ln 3-\ln 2}\ln \left( \dfrac{x+2}{2} \right)$$

פתרו אותה בשיטת גלרקין.

**פתרון**:
ראשית, נצטרך לבחור את פונקציות הבסיס לקירוב. נראה לי [[NUM1_007 אינטרפולציה פולינומית#אינטרפולציית לגראנז'|פולינומי לגראנז']] זה סבבה:
$$u^{N}(x)={a}_{i}{\phi}_{i}(x)={a}_{i}\mathcal{L}_{i}(x),\qquad \mathcal{L}_{i}(x)=\prod _{\substack{k=1\\k\neq i}}^{N} \dfrac{x-{x}_{k}}{{x}_{i}-{x}_{k}}$$
כאשר בביטוי השמאלי יש שימוש ב[[SLD2_001 טנזור המאמץ#עיקרון הסכימה של איינשטיין|עיקרון הסכימה של איינשטיין]].
בבעיה זו יש לנו שני תנאי שפה מסוג דיריכלה, שאנו רוצים לקיים במדויק לפני שאנו פותרים את משוואה זו (לפונקציות שמקיימות זאת אנו קוראים **פונקציות קבילות קינמטית**). זה אומר שמספר הנקודות המינימלי שאנו צריכים כדי לבנות את הפולינומים הוא $N=3$. במקרה זה ישנם $2$ נעלמים שנחשבם לפי התנאי שפה ואחד לפי המשוואה עצמה. נבחר את הנקודות:
$${x}_{1}=0,\qquad {x}_{2}=\dfrac{1}{2},\qquad {x}_{3}=1$$
כאשר את ${x}_{2}$ בחרנו שרירותית. לכן, הפולינומים יהיו:
$${\phi}_{1}=2\left( x-\dfrac{1}{2} \right)(x-1),\qquad {\phi}_{2}=-4x(x-1),\qquad {\phi}_{3}=2x\left( x-\dfrac{1}{2} \right)$$
נדרוש מתנאי השפה ש:
$$\begin{aligned}
 & u^{N}(0)=0: &  & {a}_{1}{\phi}_{1}(0)+{a}_{2}{\phi}_{2}(0)+{a}_{3}{\phi}_{3}(0)=0 \\[1ex]
 &  &  & {a}_{1}[2\cdot(-1/2)\cdot (-1)]+{a}_{2}\cdot 0+{a}_{3}\cdot 0=0 \\[1ex]
 &  &  & \implies {a}_{1}=0 \\[1ex]
 & u^{N}(1)=u^{*}: &  & \dots =u^{*} \\[1ex]
 &  &  & \implies {a}_{3}=u^{*}
\end{aligned}$$

>[!notes] הערה: 
 >היה אפשר גם לראות זאת ישירות מעצם הגדרת פולינומי לגראנז'.

כעת נוכל להגדיר את השארית:
$$r^{N}=A(u^{N})-f$$
נשים לב ש-$A$, האופרטור הלינארי, במקרה שלנו הוא:
$$A(u)=-\dfrac{\mathrm{d}}{\mathrm{d}x}\left( (x+2) \dfrac{\mathrm{d}u}{\mathrm{d}x} \right)$$
ולכן השארית:
$$\begin{aligned}
r^{N} & =-\dfrac{\mathrm{d}}{\mathrm{d}x}\left( (x+2) \dfrac{\mathrm{d}u^{N}}{\mathrm{d}x} \right)-1 \\[1ex]
 & =-\dfrac{\mathrm{d}}{\mathrm{d}x}\left( (x+2) \dfrac{\mathrm{d}{\phi}_{i}}{\mathrm{d}x} \right){a}_{i}-1
\end{aligned}$$
כאשר שוב, השתמשנו כאן בעיקרון הסכימה של איינשטיין.
נפעיל כעת את [[FEM1_001 מבוא ומידול בעיה חד ממדית#שיטת גלרקין|שיטת גלרקין]]:
$$\begin{gathered}
\int_{0}^{1} r^{N}(x){\phi}_{i}(x) \, \mathrm{d}x=0  \\[1ex]
\int_{0}^{1} \left[ -\dfrac{\mathrm{d}}{\mathrm{d}x}\left( (x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x} \right){a}_{j}-1 \right]{\phi}_{i} \, \mathrm{d}x =0
\end{gathered}$$
נסדר מחדש את הביטוי:
$$-\left[ \int_{0}^{1} {\phi}_{i} \dfrac{\mathrm{d}}{\mathrm{d}x}\left( (x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x} \right) \, \mathrm{d}x  \right]{a}_{j}=\int_{0}^{1} {\phi}_{i} \, \mathrm{d}x  \tag{E1.2}$$
משוואה $\text{(E1.2)}$ (למעשה שלוש משוואות) היא מערכת משוואות לינאריות שניתן לרשום בצורה:
$${K}_{ij}{a}_{i}={F}_{i}$$
השורה הראשונה והשלישית במטריצה ${K}_{ij}$ והוקטור ${F}_{i}$ הם למעשה תנאי השפה:
$$\begin{pmatrix}
1 & 0 & 0 \\
{K}_{21} & {K}_{22} & {K}_{23} \\
0 & 0 & 1
\end{pmatrix}\begin{pmatrix}
{a}_{1} \\
{a}_{2} \\
{a}_{3}
\end{pmatrix}=\begin{pmatrix}
0 \\
{F}_{2} \\
u^{*}
\end{pmatrix} \tag{E1.3}$$
כאשר:
$$\begin{align}
 & {K}_{21}=-\int_{0}^{1} {\phi}_{2} \dfrac{\mathrm{d}}{\mathrm{d}x}\left( (x+2) \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x} \right) \, \mathrm{d}x=\int_{0}^{1} 4x(x-1)(8x+5) \, \mathrm{d}x  \\[1ex]
 & {K}_{22}=-\int_{0}^{1} {\phi}_{2} \dfrac{\mathrm{d}}{\mathrm{d}x}\left( (x+2)\dfrac{\mathrm{d}{\phi}_{2}}{\mathrm{d}x} \right) \, \mathrm{d}x=\int_{0}^{1} -16x(x-1)(4x+3) \, \mathrm{d}x \\[1ex]
 & {K}_{23}=-\int_{0}^{1} {\phi}_{2} \dfrac{\mathrm{d}}{\mathrm{d}x}\left( (x+2) \dfrac{\mathrm{d}{\phi}_{3}}{\mathrm{d}x} \right) \, \mathrm{d}x=\int_{0}^{1} 4x(x-1)(8x+7) \, \mathrm{d}x \\[1ex]
  & {F}_{2}=\int_{0}^{1} {\phi}_{2} \, \mathrm{d}x=\int_{0}^{1} -4x(x-1) \, \mathrm{d}x
\end{align}$$

כדי לפשט את $\text{(E1.3)}$ אנו יכולים להזיז את העמודה הראשונה והשלישית של המטריצה ${K}_{ij}$ לצד ימין כדלהלן (וואו בחיים שלי לא השתמשתי במילה הזאת):
$$\begin{pmatrix}
1 & 0 & 0 \\
0 & {K}_{22} & 0 \\
0 & 0 & 1
\end{pmatrix}\begin{pmatrix}
{a}_{1} \\
{a}_{2} \\
{a}_{3}
\end{pmatrix}=\begin{pmatrix}
0 \\
{F}_{2} \\
u^{*}
\end{pmatrix}-\begin{pmatrix}
0 \\
{K}_{21} \\
0
\end{pmatrix}{a}_{1}-\begin{pmatrix}
0 \\
{K}_{23} \\
0
\end{pmatrix}{a}_{3}$$
כעת נוכל לפשט את מערכת המשוואות ולפתור רק מטריצה $1\times 1$:
$$\begin{gather}
 {K}_{22}{a}_{2}={F}_{2}-\cancel{ {K}_{21}{ {a}_{1} } }-{K}_{23}{a}_{3} \\[1ex]
{K}_{22}{a}_{2}={F}_{2}-{K}_{23}a3 \tag{E1.4}
\end{gather}$$
כעת, נצטרך לפתור את האינטגרלים. נוכל לעשות זאת בעזרת [[NUM1_009 אינטגרציה נומרית#אינטגרציית גאוס|אינטגרציית גאוס]]. מאחר ופונקציות הבסיס ${\phi}_{j}$ הם פולינומים מסדר $2$, השגיאה תהיה $\mathcal{O}(h^{3})$. כדי לעשות זאת נצטרך $2$ נקודות גאוס. אנו גם נצטרך להמיר לאינטגרציה על התחום $[-1,1]$:
$$\int_{a}^{b} f(x) \, \mathrm{d}x \approx  \dfrac{b-a}{2}\sum_{i=1}^{2}{\omega}_{i} f\left( \dfrac{b-a}{2}{x}_{i}+ \dfrac{b+a}{2} \right) $$
במקרה שלנו $a=0$ ו- $b=1$. הנקודות הן ${x}_{1,2}=\pm\sqrt{ 1/3 }$, והמשקלים ${\omega}_{1,2}=1$. נקבל כי:
$${K}_{22}=\dfrac{40}{3},\qquad {K}_{23}=-\dfrac{22}{3},\qquad {F}_{2}=\dfrac{2}{3}$$
נציב ב-$\text{(E1.4)}$:
$$\begin{aligned}
{a}_{2} & =\dfrac{3}{40}\left( \dfrac{2}{3}+\dfrac{22}{3}u^{*} \right) \\[1ex]
 & =0.05
\end{aligned}$$
לבסוף, לאחר שאנו יודעים את כל הערכים של הפתרון בצמתים, אנו יכולים לבצע אינטרפולציה ולקבל את הפתרון המקורב:
$$\begin{aligned}
u^{N}(x) & ={\phi}_{j}{a}_{j} \\[1ex]
 & =0\cdot 2\left( x-\dfrac{1}{2} \right)(x-1)-0.05\cdot 4x(x-1)+u^{*}\cdot 2x\left( x-\dfrac{1}{2} \right)
\end{aligned}$$

>[!TODO] TODO: להשלים