---
aliases:
  - פונקציה קבילה קינמטית
---

# מבוא
שיטות קלאסיות לפתרון ב[[FEM1_001 מבוא ומידול בעיה חד ממדית#שיטת גלרקין|שיטת גלרקין]] בונות קירובים מ**פונקציות קבילות קינמטית (kinematically admissible functions)**, שהן פונקציות שמקיימות את תנאי השפה על הזזה (דהיינו תנאי דיריכלה) מלכתחילה. שתי בעיות מרכזיות עולות:
1. לפעמים זה די קשה למצוא פונקציות קבילות קינמטית בכל המרחב הרלוונטי.
2. אם כן מצאנו פונקציות כאלה, הן מובילות למערכת משוואות מצומדות ומסובכות.

ניתן להתעלות על בעיות מסוג זה בעזרת העובדה שקירובים מקומיים יכולים לספק פתרונות בדיוק גבוה, ובאותו הזמן להוביל למערכת משוואות שיש להן מבנים מתמטיים נוחים לחישוב, גם בממדים גבוהים. קירובים חלקיים אלו, או "אלמנטיים" אלו, כבר הוכרו לפני לפחות 60 שנה ע"י קורנט (Courant). היה מגוון של שיטות קירוב דומות לפתרון משוואות פיזיקליות. הכי נפוצה ביניהן היא שיטת האלמנטים הסופיים, FEM. המאפיין המרכזי של שיטה זו היא חילוק המרחב באופן שיטתי להרכבה של תת-תחומים בדידים, או, "אלמנטים", ואז לקרב את הפתרון של כל אחד מחלקים אלו באופן שמצמד אותם כדי ליצור פתרון גלובלי תקף לאורך כל התחום. התהליך פותח באופן כזה שהמשוואות האלגבריות יהיו ניתנות לחישוב (במחשב), ויעילות מבחינת הזיכרון שהן משתמשות בו. 


# קירוב אלמנט סופי
נביט בצורה החלשה של הבעיה שראינו ב[[FEM1_002 אלסטוסטטיקה חד-ממדית#מרחב סובולב הילברטני|פרק קודם]] (משוואה $\text{(2.13)}$):

עלינו למצוא $u\in H^{1}(\Omega)$ (הפתרון שלנו), כאשר $u\big|_{{\Gamma}_{u}}^{}=u^{*}$ (תנאי שפה כלשהו מסוג דיריכלה), כך שלכל $v$ שמקיים $v\in H^{1}(\Omega)$ וגם $v\big|_{{\Gamma}_{u}}^{}=0$, מתקיים:
$$
\int_{\Omega}^{}  \dfrac{\mathrm{d}v}{\mathrm{d}x}E \dfrac{\mathrm{d}u}{\mathrm{d}x} \, \mathrm{d}x=\int_{\Omega}^{} fv \, \mathrm{d}x +t^{*}v\big|_{{\Gamma}_{t}}^{}  $$

אנו מקרבים את $u$ ע"י
$$u^{h}(x)=\sum_{j=1}^{N}{a}_{j}{\phi}_{j}(x) $$
כאשר הסימון את $u^{h}$ אפשר לקרוא כ"הקירוב של $u$ ע"י אלמנטים סופיים באורך $h$".
אם נבחר $v$ עם אותם הפונקציות קירוב, אבל עם [[ALG1_005 מרחבים וקטוריים#צירוף לינארי|קומבינציה לינארית]] שונה
$$v^{h}(x)=\sum_{i=1}^{N}{b}_{i}{\phi}_{i}(x) $$
אז אנו יכולים לרשום:
$$\begin{aligned}
 & \underbrace{ \int _{\Omega} \dfrac{\mathrm{d}}{\mathrm{d}x}\left( \sum_{i=1}^{N}{b}_{i}{\phi}_{i}(x)  \right) E \dfrac{\mathrm{d}}{\mathrm{d}x}\left( \sum_{j=1}^{N}{a}_{j}{\phi}_{j}(x)  \right) \, \mathrm{d}x }_{ :=\text{ stiffness contribution} } \\[1ex]
 & \qquad =\underbrace{ \int _{\Omega} \left( \sum_{i=1}^{N}{b}_{i}{\phi}_{i}(x)  \right)f \, \mathrm{d}x }_{ := \text{ body load contribution} } +\underbrace{ \left( \left( \sum_{i=1}^{N}{b}_{i}{\phi}_{i}(x)  \right)t^{*} \right)\bigg|_{{\Gamma}_{t}}^{}  }_{ :=\,\text{traction load contribution} }
\end{aligned}$$
מאחר וה-$v$-ים שרירותיים, גם ${b}_{i}$ שרירותיים (חוץ מהקצוות, שם תנאי השפה קובעים את ${b}_{i}$), כך ש:
$$\begin{aligned}
 & \sum_{i=1}^{N}{b}_{i}\left( \sum_{j=1}^{N}{K}_{ij}{a}_{j}-{R}_{i}  \right)=0
\end{aligned} \tag{3.5a}$$
כאשר:
$$\begin{aligned}
 & {K}_{ij}:=\int_{\Omega}^{}  \dfrac{\mathrm{d}{\phi}_{i}}{\mathrm{d}x}E \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x} \, \mathrm{d}x  \\[1ex]
 & {R}_{i}:=\int_{\Omega}^{} {\phi}_{i}f \, \mathrm{d}x +{\phi}_{i}t^{*}\bigg|_{{\Gamma}_{t}}^{} 
\end{aligned}$$
את $\text{(3.5)}$ אנו יכולים גם לרשום בצורה מטריציונית:
$$\boxed{\mathbf{K}\mathbf{a}=\mathbf{R} }\tag{3.5b}$$
כאשר $\mathbf{K}$ היא מטריצה $N\times N$, ש-, באופן לא מפתיע, קוראים לה **מטריצת הקשיחות**. ל-$\mathbf{R}$ אנו קוראים **וקטור העומס (load vector)**. ככל שאנו מגדילים את $N$ אנו מגדילים את סיבוכיות הפתרון, אבל גם את דיוק השיעור שלנו. למעשה, $N$ גדול הוא לא בעייתי כל כך בבעיות חד-ממדיות, אבל הוא יהווה מכשול די משמעותי כאשר נידון בבעיות תלת-ממדיות.

>[!notes] הערה: 
 >בתרגול אנו מפרקים את וקטור העומס $\mathbf{R}$ ל**מטריצת המסה** (mass matrix) ו**וקטור הכוח** (force vector). אנו עושים זאת על קירוב $f$ בעזרת אותם הפונקציות בסיס:
 >$$f(x)\approx {\phi}_{j}f({x}_{j})={\phi}_{j}{f}_{j}$$
 >לכן במקרה שבו תנאי השפה נוימן הוא הומוגני, אנו מקבלים:
 >$${R}_{i}=\left( \int_{\Omega}^{} {\phi}_{i}{\phi}_{j} \, \mathrm{d}x \right) {f}_{j}$$
 >ל-$\mathbf{f}$ אנו קוראים **וקטור הכוח** (force vector) ולאינטגרל $\int_{\Omega}^{} {\phi}_{i}{\phi}_{j} \, \mathrm{d}x$ אנו קוראים **מטריצת המסה** (mass matrix).
 >פירוק זה עשוי להיות יקר חישובית בבעיות סטטיות, אך בבעיות דינמיות הוא מתבצע באופן טבעי מתוך פיתוח המשוואות.

# בניית פונקציות בסיס של FEM
שיטת אלמנטים סופיים מגדירה פונקציות בסיס (למטרת הקירוב) באופן מקוטע (piecewise) לאורך תת-תחום, ה"אלמנטים הסופיים", של כלל התחום. פונקציות הבסיס הן לרוב פולינומים פשוטים מסדר נמוך. אנו מקפידים שמתקיים:
1. פונקציות הבסיס חלקות מספיק כך שהן חלק מ-$H^{1}(\Omega)$.
2. פונקציות הבסיס הן פולינומים פשוטים למקוטעין, המוגדרות אלמנט-אלמנט.
3. פונקציות הבסיס יוצרות בסיס בו ${\phi}_{i}({x}_{j})=0$ כאשר $i\neq j$, וגם ${\phi}_{i}({x}_{i})=1$. בנוסף לכך, $\sum_{i=1}^{N}{\phi}_{i}(x)=1$ לכל $x$ ו-${\phi}_{i}(x)=0$ מחוץ לאלמנטים עם אותה הצומת $i$.

קבוצה של פונקציות אפשריות לבסיס מוגדרות כ:
$$\phi(x)=\dfrac{x-{x}_{i-1}}{{h}_{i}}\qquad {x}_{i-1}\leq  x\leq  {x}_{i}\tag{3.6}$$
כאשר ${h}_{i}={x}_{i}-{x}_{i-1}$ וגם
$$\phi(x)=1-\dfrac{x-{x}_{i}}{{h}_{i+1}}\qquad {x}_{i}\leq  x\leq  {x}_{i+1}\tag{3.7}$$
אחרת, $\phi(x)=0$. הנגזרת של הפונקציה היא:
$$\dfrac{\mathrm{d}\phi}{\mathrm{d}x}=\dfrac{1}{{h}_{i}}\qquad {x}_{i-1}\leq  x\leq  {x}_{i}\tag{3.8}$$
וגם
$$\dfrac{\mathrm{d}\phi}{\mathrm{d}x}=-\dfrac{1}{{h}_{i+1}}\qquad {x}_{i}\leq  x\leq  {x}_{i+1}\tag{3.9}$$
הפונקציות מסודרות כך שה-"פסגה" של הפונקציה ה-$i$-ית מתלכדת עם הצומת ה-$i$. אחת מהיתרונות של בחירת פונקציות זו הוא שהיא מאוד נוחה לאינטגרציה.

![[{36521D26-47B5-40B0-AC82-9E0588AE1901}.png|bookhue|450]]
>בסיס לאלמנט סופי חד-ממדי. למעלה, דוגמה לרשת אחידה. למטה, דוגמה לרשת לא אחידה. [[FEM1_000 00350022 אלמנטים סופיים לאנליזה הנדסית#ביבליוגרפיה|(Zohdi, 2018)]].

>[!notes] הערה: 
 >1. התחום ${x}_{i-1}$ ל-${x}_{i}$ הוא מה שאנו קוראים לו **אלמנט סופי** (finite element).
 >2. אם אנו מחלקים את התחום ל-$N$ אלמנטים, ולכל אלמנט אנו מבצעים *קירוב לינארי* (linear approximation), אז יש לנו $N+1$ **צמתים** (nodes) לאורך התחום.
 
# אינטגרציית גאוס

נחזור טיפה על [[NUM1_009 אינטגרציה נומרית#אינטגרציית גאוס|אינטגרציית גאוס]]. גאוס שם לב שניתן לבצע אינטגרציה על פולינום מסדר $2G-1$ בדיוק לחלוטין עם $G$ נקודות דגימה ומשקלים מתאימים. לכן, אנו מגדירים מחדש את הפונקציה $F(x)$ על תחום מנורמל $-1\leq \zeta\leq 1$ כך ש:
$$\int_{0}^{L} F(x) \, \mathrm{d}x=\int_{-1}^{1} F(x(\zeta))J(\zeta) \, \mathrm{d}\zeta=\sum_{i=1}^{G}{w}_{i}F({\zeta}_{i})J({\zeta}_{i})=\sum_{i=1}^{G}{w}_{i}\hat{F}({\zeta}_{i})    $$
כאשר $J$ הוא היעקוביאן של הטרנספורמציה. לעומת רוב שיטות האינטגרציה, באינטגרציית גאוס אין את הדרישה שהדגימה על הפונקציה תתרחש בנקודות במרווח שווה ביניהן. כעת, אנו יכולים למשל לבצע אינטגרציה על ביטוי מסדר שלישי (וגם סדר נמוך יותר) עם בדיוק $G=2$ נקודות, כי $(2G-1)=3$. לכן
- עבור סדר שלישי $(\zeta ^{3})$:
	$$\int_{-1}^{1} \zeta ^{3}  \, \mathrm{d}\zeta=0={w}_{1}{{{\zeta}_{1}}}^{3}+{w}_{2}{{{\zeta}_{2}}}^{3}\tag{3.11} $$
- עבור סדר שני $(\zeta ^{2})$:
	$$\int_{-1}^{1} \zeta ^{2} \, \mathrm{d}\zeta =2/3={w}_{1}{{{\zeta}_{1}}}^{2}+{w}_{2}{{{\zeta}_{2}}}^{2}\tag{3.12}$$
- עבור ביטוי לינארי $(\zeta)$:
	$$\int_{-1}^{1} \zeta \, \mathrm{d}\zeta =0={w}_{1}{\zeta}_{1}+{w}_{2}{\zeta}_{2}\tag{3.13}$$
- עבור קבוע ($1$):
	$$\int_{-1}^{1} 1 \, \mathrm{d}\zeta =2={w}_{1}+{w}_{2}\tag{3.14}$$
ישנם כעת ארבעה נעלמים ${\zeta}_{1},{\zeta}_{2},{w}_{1},{w}_{2}$ שאנו צריכים למצוא. הפתרון שמקיים את כל הדרישות הוא ${\zeta}_{1}=\sqrt{ 1/3 }=-{\zeta}_{2}$ ו- ${w}_{1}={w}_{2}=1$. במקרה הכללי יותר, ה-$\zeta$-ות הן שורשים של משהו שנקרא פולינומי לג'נדר, שזה משהו ידוע, ויש לנו טבלה להן.
![[{7A2B9E79-3640-4555-9461-C64DF4C07AF3}.png|bookhue|600]]
>אינטגרציית גאוס. [[FEM1_000 00350022 אלמנטים סופיים לאנליזה הנדסית#ביבליוגרפיה|(Zohdi, 2018)]].

![[{6F7D9194-BBA1-42FA-BE20-D429D23618CD}.png|bookhue|500]]
>טבלה לאינטגרציית גאוס. [[FEM1_000 00350022 אלמנטים סופיים לאנליזה הנדסית#ביבליוגרפיה|(Zohdi, 2018)]].

>[!example] דוגמה: 
> נביט באינטגרל הבא:
> $$I=\int_{0.2}^{1.5} 10e^{-x^{2}} \, \mathrm{d}x $$
> האינטגרל הוא מהצורה:
> $$I=\int_{a}^{b} f(x) \, \mathrm{d}x =\int_{-1}^{1} f \left( \dfrac{(b-a)\zeta+b+a}{2}  \right) \underbrace{ \dfrac{b-a}{2} }_{ J } \, \mathrm{d}\zeta  $$
> עם הטרנספורמציה
> $$x=\dfrac{(b-a)\zeta+b+a}{2}\implies \mathrm{d}x= \dfrac{b-a}{2}\mathrm{d}\zeta$$
> כאשר נבצע את טרנספורמציה זו נקבל
> $$I=\int_{0.2}^{1.5} 10e^{-x^{2}} \, \mathrm{d}x=\dfrac{1.5-0.2}{2}\int_{-1}^{1} 10e^{-(0.65\zeta+0.85)^{2}} \, \mathrm{d}\zeta  $$
> כאשר $x=0.65\zeta+0.85$. באינטגרציה בשלוש נקודות, נקבל (הפתרון המדויק הוא $6.588$):
> $$\begin{aligned}
> I & =\dfrac{1.5-0.2}{2}\int_{-1}^{1} 10e^{-(0.65\zeta+0.85)^{2}} \, \mathrm{d}\zeta \\[1ex]
>  & =6.5(0.5555e^{-(0.65(-0.77459)+0.85)^{2}}+\dots ) \\[1ex]
>  & =6.586
> \end{aligned}$$
> 

# טרנספורמציה גלובלית/מקומית
אחד מהיתרונות של שיטת אלמנטים סופיים הוא שהחישוב ניתן לביצוע אלמנט-אלמנט. את מטריצת הקשיחות $\mathbf{K}$ הגדרנו כ:
$${K}_{ij}:=\int_{\Omega}^{} \dfrac{\mathrm{d}{\phi}_{i}}{\mathrm{d}x}E \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x}  \, \mathrm{d}x  $$
ופונקציית העומס:
$${R}_{i}:=\int_{\Omega}^{} {\phi}_{i}f \, \mathrm{d}x +{\phi}_{i}t^{*}\bigg|_{{\Gamma}_{t}}^{}$$

אנו מחלקים את התחום $\Omega$ לאלמנטים ${\Omega}_{1},{\Omega}_{2},\dots,{\Omega}_{e},\dots{\Omega}_{N}$,ואז נפרק את החישובים (אינטגרלים על $\Omega$) לאלמנטים (אינטגרלים על ${\Omega}_{e}$), ${K}_{ij}=\sum_{e}^{}K^{e}_{ij}$, ($e$ עבור element) כאשר:
$$K^{e}_{ij}=\int_{{\Omega}_{e}}^{} \dfrac{\mathrm{d}{\phi}_{i}}{\mathrm{d}x}E \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x} \, \mathrm{d}x \tag{3.24}$$
וגם:
$$R^{e}_{i}=\int_{{\Omega}_{e}}^{} {\phi}_{i}f \, \mathrm{d}x +{\phi}_{i}t^{*}\bigg|_{{\Gamma}_{t,e}} \tag{3.25}$$
כאשר ${R}_{i}=\sum_e R^{e}_{i}$ וגם ${\Gamma}_{t,e}={\Gamma}_{t}\cap{\Omega}_{e}$.

>[!example] דוגמה: 
> $$\begin{aligned}
> & {K}_{11}=\sum_{e}^{}K^{e}_{11} =\int_{{x}_{1}}^{{x}_{2}} \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x}E \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x} \, \mathrm{d}x  \\[1ex]
> &{K}_{12}=\sum_{e}^{}{K}^{e}_{12}=\int_{{x}_{1}}^{{x}_{2}} \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x}E \dfrac{\mathrm{d}{\phi}_{2}}{\mathrm{d}x} \, \mathrm{d}x  \\[1ex]
> & {K}_{22}=\sum _{e}K^{e}_{22}=\int_{{x}_{1}}^{{x}_{2}} \dfrac{\mathrm{d}{\phi}_{2}}{\mathrm{d}x}E \dfrac{\mathrm{d}{\phi}_{2}}{\mathrm{d}x}   \, \mathrm{d}x+\int_{{x}_{2}}^{{x}_{3}}  \dfrac{\mathrm{d}{\phi}_{2}}{\mathrm{d}x}E \dfrac{\mathrm{d}{\phi}_{2}}{\mathrm{d}x} \, \mathrm{d}x
> \end{aligned}$$
> 

כדי לבצע את החישובים באופן שיטתי, אנו רוצים להמיר את הקואורדינטות של כל אלמנט לתחום $[-1,1]$ לטובת אינטגרציית גאוס.  לפיכך, אנו צריכים לבצע את הטרנספורמציה הבאה, מהמערכת צירים המקומית למערכת הצירים המרחבית האמיתית,
$$x(\zeta)=\sum_{i=1}^{2}x_{i}\hat{\phi}_{i}(\zeta) \tag{3.26} $$
כאשר ${x}_{i}$ הוא המיקום האמיתי במרחב של הצומת ה-$i$, ו- $\hat{\phi}(\zeta):=\phi(x(\zeta))$.

![[{62FA85E5-D1C9-453F-9436-1B48611DFF9B}.png|bookhue|400]]
>טרנספורמציה לאלמנט סופי חד-ממדי. [[FEM1_000 00350022 אלמנטים סופיים לאנליזה הנדסית#ביבליוגרפיה|(Zohdi, 2018)]].

שיטות מיפוי אלו (הטרנספורמציות) לרוב נקראים מפות "פרמטריות". אם סדר הפולינום של פונקציות הצורה גבוהות כמו קירוב גלרקין על האלמנט, הוא נקרא מפה **איזו-פרמטרית**. אם הוא נמוך יותר, אז **סאב-פרמטרי**, ואם הוא גבוה יותר אז הוא נקרא **סופר-פרמטרי**.

# מאפיינים דיפרנציאליים של פונקציות צורה
לקירוב לינארי, פונקציות הצורה המקומיות הן מהצורה:
$$\hat{\phi}_{1}=\dfrac{1}{2}(1-\zeta),\qquad \hat{\phi}_{2}=\dfrac{1}{2}(1+\zeta)$$
יש להם את התכונות הבאות:
- לאלמנטים לינאריים יש לנו בסיס הכולל שני צמתים, ולכן שתי דרגות חופש.
- פונקציות הצורה ($\hat{\phi}_{1},\hat{\phi}_{2}$) ניתנות לחישוב באופן יחסית די פשוט. הם יחידה בצומת המתאימה ואפס בכל שאר הצמתים.

>[!notes] הערה: 
 >אנו לא באמת מחשבים את הפונקציות ${\phi}_{i}$; אנחנו למעשה מתחילים מ- $\hat{\phi}_{i}$ ואז *ממפים* (transform) אותם לתחום של הבעיה האמיתית. לכן במטריצת הקשיחות או במטריצת המסה שנראה בהמשך, כל הביטויים חייבים להיות מוגדרים במונחים של קואורדינטות מקומיות (local coordinates).
 
כעת נגדיר מספר ביטויים בסיסיים שיעזרו לנו בחישוב הערכים המקומיים כמו $K^{e}_{ij}$ ו- $R^{e}_{i}$.  למשל, כאשר נבצע את הטרנספורמציה אסור לנו לשכוח שיש גם להכפיל את האינטגרנד ב[[CAL2_011 אינטגרל רב ממדי#מטריצת היעקוביאן|יעקוביאן]]. במקרה החד-ממדי:
$$J=\dfrac{\mathrm{d}x}{\mathrm{d}\zeta}\tag{3.28}$$
ונשים לב גם ש:
$$\dfrac{1}{J}=\dfrac{\mathrm{d}\zeta}{\mathrm{d}x}\tag{3.30}$$
כעת נוכל לפתח ביטוי לנגזרת של $\phi(x)$ (לפי [[CAL2_006 נגזרות של פונקציות בשני משתנים#כלל השרשרת|כלל השרשרת]]):
$$\begin{aligned}
\dfrac{\mathrm{d}\phi}{\mathrm{d}x} & =\dfrac{\mathrm{d}}{\mathrm{d}x}\phi(M(\zeta)) \\[1ex]
 & =\dfrac{\mathrm{d}\zeta}{\mathrm{d}x} \dfrac{\mathrm{d}}{\mathrm{d}\zeta}\phi(M(\zeta)) \\[1ex]
 & =\dfrac{\mathrm{d}\zeta}{\mathrm{d}x} \dfrac{\mathrm{d}}{\mathrm{d}\zeta}\hat{\phi}(\zeta)
\end{aligned}$$
נציב ב-$(\text{3.24})$, ונקבל בעזרת [[#אינטגרציית גאוס]]:
$$\boxed {
\begin{aligned}
K^{e}_{ij} & =\sum_{q=1}^{g}{w}_{q}\left[ \left( \dfrac{\mathrm{d}}{\mathrm{d}\zeta } \hat{\phi}_{i}(\zeta)  \right) \dfrac{\mathrm{d}\zeta}{\mathrm{d}x}E\left( \dfrac{\mathrm{d}}{\mathrm{d}\zeta} \hat{\phi}_{j}(\zeta)  \right)\dfrac{\mathrm{d}\zeta}{\mathrm{d}x} J\right]_{\zeta={\zeta}_{q}}  \\[1ex]
 & =\sum_{q=1}^{g}{w}_{q}\left[ \left( \dfrac{\mathrm{d}}{\mathrm{d}\zeta } \hat{\phi}_{i}(\zeta)  \right)\left( \dfrac{\mathrm{d}}{\mathrm{d}\zeta} \hat{\phi}_{j}(\zeta)  \right) E\dfrac{1}{J}\right]_{\zeta={\zeta}_{q}}
\end{aligned} \tag{3.32}
 }$$
וגם:
$$\begin{align}
\boxed {
R^{e}_{i}=\sum_{q=1}^{g}\left[ {w}_{q}\hat{\phi}_{i}(\zeta)fJ \vphantom{\left( \dfrac{1}{1} \right)} \right]_{\zeta={\zeta}_{q}}+\left[ \hat{\phi}_{i}t^{*}\vphantom{\left( \dfrac{1}{1} \right)} \right]_{{\Gamma}_{t,e}} 
 }\tag{3.33}
\end{align}$$

>[!example] דוגמה:
>**פיתוח הצורה החלשה**:
> נתונה הבעיה הבאה:
> $$\begin{aligned}
>  & \dfrac{\mathrm{d}}{\mathrm{d}x}\left( E(x) \dfrac{\mathrm{d}u}{\mathrm{d}x} \right)+f(x)=0  &  & 0\leq  x\leq  1 \\[1ex]
>  & u(0)=0 \\[1ex]
>  & \dfrac{\mathrm{d}u}{\mathrm{d}x}(1)=t
> \end{aligned}$$
> צורתה החלשה היא (לאחר אינטגרציה בחלקים):
> $$\int_{0}^{1} \dfrac{\mathrm{d}v}{\mathrm{d}x}E(x) \dfrac{\mathrm{d}u}{\mathrm{d}x} \, \mathrm{d}x =\int_{0}^{1} f(x)v \, \mathrm{d}x +\underbrace{ \left[ E(x) \dfrac{\mathrm{d}u}{\mathrm{d}x}v \right]_{0}^{1} }_{ t^{*}v } $$
> נפרק את התחום לשלושה אלמנטים, ולכן נקבל ארבעה צמתים:
> ![[{BC34ADAC-5F99-44D6-BCEE-C84B428B127B}.png|bookhue|350]]
> 
> - על אלמנט ${\Omega}_{1}$, מתקיים ${x}_{i}={x}_{1}=0$ ו- ${x}_{i+1}={x}_{2}=1/3$ וגם:
> 	$${{\phi}}_{1}(x)=1-3x,\qquad {\phi}_{2}(x)=3x$$
> - על אלמנט ${\Omega}_{2}$, מתקיים ${x}_{i}={x}_{2}=1/3$ ו- ${x}_{i+1}={x}_{3}=2/3$ וגם:
> 	$${\phi}_{2}(x)=2-3x,\qquad {\phi}_{3}(x)=-1+3x$$
> - על אלמנט ${\Omega}_{3}$, מתקיים ${x}_{i}={x}_{3}=2/3$ ו- ${x}_{i+1}={x}_{4}=1$ וגם:
> 	$${\phi}_{3}=3-3x,\qquad {\phi}_{4}=-2+3x$$
> 
> אנו מבצעים את החישובים אלמנט-אלמנט. כל החישובים ב- $0\leq x\leq 1/3$ שייכים לאלמנט ${\Omega}_{1}$, בעוד כל החישובים ב- $1/3\leq x\leq 2/3$ שייכים לאלמנט ${\Omega}_{2}$, וכל החישובים ב- $2/3\leq x\leq 1$ שייכים לאלמנט ${\Omega}_{3}$.
> **בניית המערכת הדיסקרטית**:
> עבור אלמנט ${\Omega}_{1}$, כדי לחשב את $K^{e=1}_{ij}$, נביט בביטוי הבא עבור ערכי $i=1,2,3$:
> $$\sum_{j=1}^{N}\left( \int_{0}^{1/3}  \dfrac{\mathrm{d}{\phi}_{i}}{\mathrm{d}x} E(x) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x} \, \mathrm{d}x  \right){a}_{j} $$
> ספציפית עבור $i=1$, הביטוי הוא:
> $$\begin{aligned}
>  & \underbrace{ \left( \int_{0}^{1/3} \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x}E(x) \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x} \, \mathrm{d}x  \right) }_{ K^{e=1}_{1 1} }{a}_{1}+\underbrace{ \left( \int_{0}^{1/3} \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x}E(x) \dfrac{\mathrm{d}{\phi}_{2}}{\mathrm{d}x} \, \mathrm{d}x  \right) }_{ K^{e=1}_{1 2} }{a}_{2} \\[1ex]
>  & \qquad +\underbrace{ \left( \int_{0}^{1/3} \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x}E(x) \dfrac{\mathrm{d}{\phi}_{3}}{\mathrm{d}x} \, \mathrm{d}x  \right) }_{=0 }{a}_{3}+0\dots 
> \end{aligned}$$
> כאשר אנו מקבלים המון ביטויים (כמו השלישי) שמתאפסים כי פונקציות הבסיס שם הן $0$ בתחום האלמנט הראשון. הביטויים כמו $K^{e=1}_{ij}$ מכפילים את הביטויים ${a}_{j}$, המגדירים את המיקום שלהם בתוך מטריצת הקשיחות הגלובלית. אם נחזור על הפעולה עבור $i=2$ עם $j=1,2,3$, נקבל את הערכים הבאים בתוך מטריצת הקשיחות הגלובלית (שהיא מטריצה מסדר $4\times 4$ כי יש $4$ צמתים):
> $$\begin{pmatrix}
> K^{e=1}_{11} & K^{e=1}_{12} & 0 & 0 \\
> K^{e=1}_{21} & K^{e=1}_{22} & 0 & 0 \\
> 0 & 0 & 0 & 0 \\
> 0 & 0 & 0 & 0 
> \end{pmatrix} $$
> כלומר, מטריצת הקשיחות המקומית היא רק:
> $$\begin{pmatrix}
> K^{e=1}_{11} & K^{e=1}_{12}  \\
> K^{e=1}_{21} & K^{e=1}_{22}
> \end{pmatrix} $$
> באותו אופן, וקטור העומס המקומי של אלמנט ${\Omega}_{1}$ הוא
> $$\left( \int_{0}^{1/3} {\phi}_{i}f(x) \, \mathrm{d}x  \right)$$
> כך שבאופן וקטורי:
> $$\begin{pmatrix}
> R^{e=1}_{1} \\
> R^{e=1}_{2}
> \end{pmatrix}$$
> נחזור על תהליך זה על כל שלושת האלמנטים ונקבל את מטריצת הקשיחות ווקטור העומס הגלובליים:
> $$\begin{pmatrix}
> K^{e=1}_{11} & K^{e=1}_{12} & 0 & 0 \\
> K^{e=1}_{21} & K^{e=1}_{22}+K^{e=2}_{11} & 0 & 0 \\
> 0 & K^{e=2}_{21} & K^{e=2}_{22}+K^{e=3}_{11} & K^{e=3}_{12} \\
> 0 & 0 & K^{e=3}_{21} & K^{e=3}_{22} 
> \end{pmatrix} \qquad  \begin{pmatrix}
> R^{e=1}_{1} \\
> R^{e=1}_{2}+R^{e=2}_{1} \\
> R^{e=2}_{2}+R^{e=3}_{1} \\
> R^{e=3}_{2}
> \end{pmatrix}$$
> נשים לב שבאלמנט האחרון יש לנו גם תנאי שפה שאנו חייבים להתייחס אליו בוקטור העומס:
> 	$$\begin{aligned}
> R^{e=3}_{2}  & =\int_{2/3}^{1} {\phi}_{4}f(x) \, \mathrm{d}x +E(x) \dfrac{\mathrm{d}u}{\mathrm{d}x}{\phi}_{4}(1) \\[1ex]
>  & =\int_{2/3}^{1} {\phi}_{4}f(x) \, \mathrm{d}x +t^{*}
> \end{aligned} $$
> כמובן שאת כל האינטגרלים נחשב בעזרת אינטגרציית גאוס - כלומר, נשתמש ב- $\text{(3.32)}$ ו-$\text{(3.33)}$.

# אלמנטים ממעלה גבוהה
בהמון מקרים, אם אנו יודעים שהפתרון האמיתי הוא חלק, נעדיף לבצע קירוב ממעלה גבוה יותר. בכללי, אם הפתרון המדויק לבעיה הוא חלק, עבור רשת סבוכה מספיק ($N$ גדול מספיק), הפתרון ממעלה גבוהה יותר מדויק יותר. באותו אופן, אם הפתרון האמיתי לא חלק, עבור רשת סבוכה מספיק, הפתרון עם הפונקציות צורה הלינאריות יותר מדויק.

![[{8FDC33B4-0EB6-4EAD-8BCE-408FA32724F8}.png|bookhue|600]]
>שלושה אלמנטים ממעלה גבוהה עם $7$ צמתים. [[FEM1_000 00350022 אלמנטים סופיים לאנליזה הנדסית#ביבליוגרפיה|(Zohdi, 2018)]].

כדי לבנות קירוב ממעלה שנייה לכל אלמנט, אנו נצטרך כעת $3$ צמתים בכל אחד מהם במקום $2$. כמו מקודם, פונקציית הבסיס חייבת להיות יחידה בכל צומת שהיא שייכת אליו, ואפס בכל השאר. לכן, לאלמנט ממעלה שנייה כללי:
- לצומת $1$:
	$$\hat{\phi}_{1}(\zeta)=-\dfrac{1}{2}(1-\zeta)\zeta$$
	מה שמניב:
	$$\hat{\phi}_{1}(-1)=1,\qquad \hat{\phi}_{1}(0)=0,\qquad \hat{\phi}_{1}(1)=0$$
- לצומת $2$:
	$$\hat{\phi}_{2}(\zeta)=(1+\zeta)(1-\zeta)$$
	מה שמניב:
	$$\hat{\phi}_{2}(-1)=0,\qquad \hat{\phi}_{2}(0)=1,\qquad \hat{\phi}_{2}(1)=0$$
- לצומת $3$:
	$$\hat{\phi}_{3}(\zeta)=\dfrac{1}{2}(\zeta+1)\zeta$$
	מה שמניב:
	$$\hat{\phi}_{3}(-1)=0,\qquad \hat{\phi}_{3}(0)=0,\qquad \hat{\phi}_{3}(1)=1$$

הקשר בין $x$ ו-$\zeta$ יהיה:
$$x(\zeta)={x}_{i}\hat{\phi}_{1}(\zeta)+{x}_{i+1}\hat{\phi}_{2}(\zeta)+{x}_{i+2}\hat{\phi}_{3}(\zeta) \tag{3.48}$$
בנוסף, למערכת המשוואות שנבנית מפונקציות אלו עדיין יש את הצורה הלינארית:
$$\sum_{j=1}^{N}{K}_{ij}{a}_{j}={R}_{i},\qquad i=1,2,\dots ,N $$
כאשר $N$ הוא מספר הצמתים בחד-ממד. נביט בדוגמה עם $3$ אלמנטים, מה שנותן $7$ צמתים. נפרק את האינטגרל לאלמנטים:
$$\int_{0}^{1}=\int_{0}^{1/3}  +\int_{1/3}^{2/3}+\int_{2/3}^{1}    $$

עבור אלמנט $1$, עם $i=1,2,\dots,N$, אנו צריכים לחשב:
$$\sum_{j=1}^{N}\underbrace{ \int_{0}^{1/3} \dfrac{\mathrm{d}{\phi}_{i}}{\mathrm{d}x}E(x) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x} \, \mathrm{d}x   }_{ K^{e=1}_{ij} } \tag{3.51}$$
מה שנותן:
$$\begin{align}
 & \sum_{j=1}^{N} \int_{0}^{1/3} \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x}E(x) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x} \, \mathrm{d}x =\underbrace{ \int_{0}^{1/3} \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x}E(x) \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x} \, \mathrm{d}x }_{ K^{e=1}_{11} }  \\[1ex]
 & \qquad +\underbrace{ \int_{0}^{1/3} \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x}E(x) \dfrac{\mathrm{d}{\phi}_{2}}{\mathrm{d}x}  \, \mathrm{d}x  }_{ K^{e=1}_{12} } \\[1ex]
 & \qquad +\underbrace{ \int_{0}^{1/3} \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x}E(x) \dfrac{\mathrm{d}{\phi}_{2}}{\mathrm{d}x}  \, \mathrm{d}x }_{ K^{e=1}_{13} }  \\[1ex]
 & \qquad +\underbrace{ \int_{0}^{1/3} \dfrac{\mathrm{d}{\phi}_{1}}{\mathrm{d}x}E(x) \dfrac{\mathrm{d}{\phi}_{2}}{\mathrm{d}x}  \, \mathrm{d}x }_{ K^{e=1}_{14}=0 } +\underbrace{ \dots }_{ =0 } \tag{3.52}  \\[1ex]
\end{align}$$

בצד ימין של $\text{(3.51)}$, עבור $i=1,2,\dots$, אנו צריכים לחשב
$$\int_{0}^{1/3} {\phi}_{i}f(x) \, \mathrm{d}x =R^{e=1}_{i}\tag{3.53}$$
ולכן
$$R^{e=1}_{1}=\int_{0}^{1/3} {\phi}_{1}f(x) \, \mathrm{d}x \tag{3.54}$$
נחזור זאת על $i=2,3,\dots,N$ ונקבל:
$$\begin{pmatrix}
K^{e=1}_{11} & K^{e=1}_{12} & K^{e=1}_{13} & 0 & 0 & 0 & 0 \\
K^{e=1}_{21} & K^{e=1}_{22} & K^{e=1}_{23} & 0 & 0 & 0 & 0 \\
K^{e=1}_{31} & K^{e=1}_{32} & K^{e=1}_{33} & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0
\end{pmatrix}\begin{pmatrix}
{a}_{1} \\
{a}_{2} \\
{a}_{3} \\
{a}_{4} \\
{a}_{5} \\
{a}_{6} \\
{a}_{7}
\end{pmatrix}=\begin{pmatrix}
R^{e=1}_{1} \\
R^{e=1}_{2} \\
R^{e=1}_{3} \\
0 \\
0 \\
0 \\
0
\end{pmatrix} \tag{3.55}$$
נחזור זאת על אלמנטים $2$ ו-$3$ ונקבל:
$$\tiny\begin{pmatrix}
K^{e=1}_{11} & K^{e=1}_{12} & K^{e=1}_{13} & 0 & 0 & 0 & 0 \\
K^{e=1}_{21} & K^{e=1}_{22} & K^{e=1}_{23} & 0 & 0 & 0 & 0 \\
K^{e=1}_{31} & K^{e=1}_{32} & K^{e=1}_{33} + K^{e=2}_{11} & K^{e=2}_{12} & K^{e=2}_{13} & 0 & 0 \\
0 & 0 & K^{e=2}_{21} & K^{e=2}_{22} & K^{e=2}_{23} & 0 & 0 \\
0 & 0 & K^{e=2}_{31} & K^{e=2}_{32} & K^{e=2}_{33}+K^{e=3}_{11} & K^{e=3}_{12} & K^{e=3}_{13} \\
0 & 0 & 0 & 0 & K^{e=3}_{21} & K^{e=3}_{22} & K^{e=3}_{23} \\
0 & 0 & 0 & 0 & K^{e=3}_{31} & K^{e=3}_{32} & K^{e=3}_{33}
\end{pmatrix}\begin{pmatrix}
{a}_{1} \\
{a}_{2} \\
{a}_{3} \\
{a}_{4} \\
{a}_{5} \\
{a}_{6} \\
{a}_{7}
\end{pmatrix}=\begin{pmatrix}
R^{e=1}_{1} \\
R^{e=1}_{2} \\
R^{e=1}_{3}+R^{e=2}_{1} \\
R^{e=2}_{2}  \\
R^{e=2}_{3}+R^{e=3}_{2}  \\
R^{e=3}_{2}  \\
R^{e=3}_{3} 
\end{pmatrix} \tag{3.56}$$

# תרגילים
## שאלה 1
הביטו במוט חד-ממדי תחת הכוח המפורש (הצירי) $f(x)=1$ עם תנאי שפה דיריכלה הומוגניים על השפה ${\Gamma}_{u}$ ($x=0$) ותנאי שפה נוימן הומוגניים על השפה ${\Gamma}_{t}$ ($x=2$). הניחו ש- $E=1$ ו- $A(x)=x+2$.

![[FEM1_002 אלסטוסטטיקה חד-ממדית 2025-04-21 12.17.05.excalidraw.svg]]
>סכמת הבעיה.

### סעיף א'
רשמו את המשוואות השולטות בבעיה.

**פתרון**:
לפי $\text{(2.14)}$, או לפי [[DVI1_008 רטט במערכות רציפות#משוואות התנועה של חוט תונד|משוואות תנועה של מוט במתיחה]]:
$$\boxed {
\begin{aligned}
 & -\dfrac{\mathrm{d}}{\mathrm{d}x}\left( (x+2) \dfrac{\mathrm{d}u}{\mathrm{d}x} \right)=1 &  &  0<x<2 \\[1ex]
 & u(0)=0 &  & {\Gamma}_{u} \\[1ex]
 & (x+2) \dfrac{\mathrm{d}u}{\mathrm{d}x}\bigg|_{x=2}^{}=0  &  & {\Gamma}_{t}
\end{aligned}
 }$$

### סעיף ב'
הגדירו את השאריות על התחום ועל תנאי השפה נוימן.

**פתרון**:
נסמן את הפתרון המשוער ב- $u^{h}={\phi}_{j}{a}_{j}$. כמו ב[[FEM1_001 מבוא ומידול בעיה חד ממדית#שאלה 1|שאלה מתרגול קודם]]:
$$\begin{gathered}
r^{h} =-\dfrac{\mathrm{d}}{\mathrm{d}x}\left( (x+2) \dfrac{\mathrm{d}{u}^{h}}{\mathrm{d}x} \right)-1 \\[1ex]
\boxed {
r^{h}=-\dfrac{\mathrm{d}}{\mathrm{d}x}\left( (x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x} \right){a}_{j}-1
 }
\end{gathered}$$
בנוימן:
$$\begin{gathered}
{r}_{t}=(x+2) \dfrac{\mathrm{d}u^{h}}{\mathrm{d}x}\bigg|_{2}^{} \\[1ex]
\boxed {
{r}_{t}=(x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x}{a}_{j}\bigg|_{2}^{}
 }
\end{gathered} $$
### סעיף ג'
מצאו את הצורה החלשה של הבעיה.

**פתרון**:
לפי [[FEM1_001 מבוא ומידול בעיה חד ממדית#שיטת גלרקין|שיטת גלרקין]] על המשוואה ועל התנאי שפה:
$$\begin{gathered}
\int_{0}^{2} {\phi}_{i}r^{h} \, \mathrm{d}x +\left[ {\phi}_{i}{r}_{q}\vphantom{\left( \dfrac{1}{1} \right)} \right]_{2}=0 \\[1ex]
\int_{0}^{2} {\phi}_{i} \left[ -\dfrac{\mathrm{d}}{\mathrm{d}x} \left( (x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x} \right){a}_{j}-1 \right] \, \mathrm{d}x+\left[ {\phi}_{i}(x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x}{a}_{j} \right]_{2}=0 
\end{gathered}$$
נרשום את הצורה החלשה (אינטגרציה בחלקים):
$$\begin{aligned}
 & \left[ \int_{0}^{2} \dfrac{\mathrm{d}{\phi}_{i}}{\mathrm{d}x} (x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x}\, \mathrm{d}x  \right]{a}_{j}-{ \left[ {\phi}_{i}(x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x}{a}_{j} \right]_{0}^{2} } \\[1ex]
 &\qquad +{ \left[ {\phi}_{i}(x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x}{a}_{j} \right]_{2} }=\int_{0}^{2} 1\cdot{\phi}_{i} \, \mathrm{d}x 
\end{aligned}$$
נפתח את הביטוי השני כדי לראות שיש ביטויים שמתבטלים:
$$\begin{aligned}
 & \left[ \int_{0}^{2} \dfrac{\mathrm{d}{\phi}_{i}}{\mathrm{d}x} (x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x}\, \mathrm{d}x  \right]{a}_{j}-\cancel{ \left[ {\phi}_{i}(x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x}{a}_{j} \right]_{2} } \\[1ex]
 &\qquad  +\cancel{ \left[ {\phi}_{i}(x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x}{a}_{j} \right]_{0} }+\cancel{ \left[ {\phi}_{i}(x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x}{a}_{j} \right]_{2} }=\int_{0}^{2}1\cdot {\phi}_{i} \, \mathrm{d}x 
\end{aligned}$$
התנאי שפה ב- $x=2$ מבטלים אחד את השני. 
תנאי שפה נוימן הומוגניים תמיד מבטלים אחד את השני בצורה החלשה. לכן קוראים להם לפעמים **תנאי שפה טבעיים**, והם מתקיימים באופן טבעי. לפיכך, אם למשל אנו לא דורשים תנאי שפה דיריכלה מסוימים, אז זה כאילו אנחנו מניחים תנאי שפה נוימן.
תנאי השפה ב- $x=0$ מתאפס בגלל פונקציות הבסיס שנשתמש בהם. אנו נבחר בפונקציות בסיס כך שכל אחד מהם, חוץ מהראשון ${\phi}_{1}(x)$, נעלם ב- $x=0$. הערך של ${\phi}_{1}(x)$ ב- $x=0$ הוא $1$, אבל כאשר נציב תנאי שפה דיריכלה למטריצה ${K}_{ij}$, [[FEM1_001 מבוא ומידול בעיה חד ממדית#שאלה 1|כפי שראינו בשאלה מתרגול קודם]], השורה המתאימה (הראשונה) של המטריצה לא תילקח בחשבון.
נישאר עם:
$$\left[ \int_{0}^{2} \dfrac{\mathrm{d}{\phi}_{i}}{\mathrm{d}x}(x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x} \, \mathrm{d}x  \right]{a}_{j}=\int_{0}^{2} 1\cdot {\phi}_{i} \, \mathrm{d}x \tag{E2.1}$$

נשים לב שבצד שמאל מופיע מטריצת הקשיחות ובצד ימין וקטור העומס, כמו ב[[#קירוב אלמנט סופי|משוואה]] $\text{(3.5b)}$.

נרצה כעת לדון בפונקציות הקירוב/בסיס. כאן $f(x)=1$, אבל בכללי אנו רושמים:
$$f(x)\approx {\phi}_{j}f({x}_{j})={\phi}_{j}{f}_{j}$$
כאשר ${x}_{j}$ הם נקודות הצומת. כעת, בביטוי בצד ימין של $\text{(E2.1)}$ נקבל:
$$\int_{0}^{2} {\phi}_{i}f(x) \, \mathrm{d}x =\left[ \int_{0}^{2} {\phi}_{i}{\phi}_{j} \, \mathrm{d}x  \right]{f}_{j}$$
האינטגרל שקיבלנו נקרא **מטריצת המסה**. נציב בחזרה ב-$\text{(E2.1)}$:
$$\boxed {
\left[ \int_{0}^{2} \dfrac{\mathrm{d}{\phi}_{i}}{\mathrm{d}x}(x+2) \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x} \, \mathrm{d}x  \right]{a}_{j}=\left[ \int_{0}^{2} {\phi}_{i}{\phi}_{j} \, \mathrm{d}x  \right]{f}_{j}\tag{E2.2}
 }$$
כאשר ${f}_{j}$ במקרה הזה הוא פשוט יחידה. ניתן לרשום את ביטוי זה כ:
$${K}_{ij}{a}_{j}={M}_{ij}{f}_{j}$$
כאשר $\mathbf{K}$ היא מטריצת הקשיחות, $\mathbf{a}$ הוא וקטור ההזזות, $\mathbf{f}$ הוא וקטור הכוח, ו-$\mathbf{M}$ היא מטריצת המסה. נשים לב גם ש-$\mathbf{K}$ היא מטריצה סימטרית ו[[CAL2_010 נקודות אקסטרמום#מטריצה מוגדרת חיובית|מוגדרת חיובית]].

### סעיף ד'
בחרו פונקציות בסיס לשיטת אלמנטים סופיים.

**פתרון**:
נבחר בפונקציות בסיס שהן רציפות למקוטעין כפי שמוסבר ב[[#בניית פונקציות בסיס של FEM]]:
![[Pasted image 20250421160732.png|bookhue|500]]
>פונקציות הבסיס שאנו בוחרים בשאלה.

למשל עבור $N=2$ פונקציות הבסיס יהיו:
$$\boxed {
\begin{aligned}
 & {\phi}_{1}=\begin{cases}
1-x & 0<x<1 \\
0 & 1<x<2
\end{cases} \\[1ex]
 & {\phi}_{2}=\begin{cases}
x & 0<x<1 \\
2-x & 1<x<2
\end{cases} \\[1ex]
 & {\phi}_{3}=\begin{cases}
0 & 0<x<1 \\
x-1 & 1<x<2
\end{cases}
\end{aligned}
 }$$
זהו פיתוח גלובלי, כדי לפתח באופן כללי נבחן עבור אלמנט כללי - כלומר באופן מקומי.

### סעיף ה'
פתחו את הטרנספורמציה/מיפוי למערכת קואורדינטות מקומיות.

**פתרון**:
בעצם מה שאנחנו עושים זה לקחת כל אלמנט ולבצע עליו טרנספורמציה:
![[FEM1_003 מימוש אלמנט סופי בחד-ממד 2025-04-21 16.34.19.excalidraw.svg]]
>טרנספורמציה מקומית של אלמנט.

במקרה שלנו:
$$\begin{aligned}
 & {\hat{\phi}}_{1}(\zeta)=\dfrac{1}{2}(1-\zeta) \\[1ex]
 & {\hat{\phi}}_{2}(\zeta)=\dfrac{1}{2}(1+\zeta)
\end{aligned}$$

נרצה למצוא את $x(\zeta)$, כלומר, את $\zeta \to x$ עבור אלמנט מסוים. לפי [[#טרנספורמציה גלובלית/מקומית|משוואה]] $\text{(3.26)}$:
$$\begin{aligned}
x^{}(\zeta) & ={\phi}_{1}{x}_{e}+{\phi}_{2}{x}_{e+1} \\[1ex]
 & \dots = \dfrac{{x}_{e}+{x}_{e+1}}{2}+\dfrac{1}{2}\zeta({x}_{e+1}-{x}_{e}) \\[1ex]
 & =\boxed {
\dfrac{{h}_{e}}{2}\zeta+ \dfrac{{x}_{e}+{x}_{e+1}}{2}
 }
\end{aligned}$$
כאשר $h^{e}:={x}_{e+1}-{x}_{e}$.
לחישובים בהמשך, נצטרך לחשב עוד ערכים: היעקוביאן:
$$\begin{aligned}
J^{e} & =\left( \dfrac{\mathrm{d}x}{\mathrm{d}\zeta} \right)^{e} \\[1ex]
 & =\dfrac{{h}^{e}}{2}
\end{aligned}$$
כאשר אנו קוראים את $J^{e}$ כ-"היעקוביאן של הטרנספורמציה של אלמנט $e$".

נסמן את הנגזרת לפי $\zeta$ עם ${B}_{i}(\zeta):=\dfrac{\mathrm{d}{\hat{\phi}}_{i}(\zeta)}{\mathrm{d}\zeta}$, ונראה כי:
$${B}_{1}(\zeta)=-\dfrac{1}{2},\qquad {B}_{2}(\zeta)=\dfrac{1}{2}$$
הנגזרת לפי $x$:
$$\begin{aligned}
\dfrac{\mathrm{d}\phi^{e}_{i}(x)}{\mathrm{d}x} & =\dfrac{\mathrm{d}{\hat{\phi}}_{i}(\zeta)}{\mathrm{d}\zeta}\left( \dfrac{\mathrm{d}\zeta}{\mathrm{d}x} \right)^{e} \\[1ex]
 & = \dfrac{\mathrm{d}{\hat{\phi}}_{i}(\zeta)}{\mathrm{d}\zeta} \dfrac{1}{{J}^{e}} \\[1ex]
 & =\dfrac{\mathrm{d}{\hat{\phi}}_{i}(\zeta)}{\mathrm{d}\zeta} \dfrac{2}{{h}^{e}} \\[1ex]
 & ={B}_{i}(\zeta) \dfrac{2}{{h}^{e}}
\end{aligned}$$
### סעיף ו'
מצאו את הקשיחות ה-*מקומית* ומטריצת המסה ה-*מקומית* של כל אלמנט.

**פתרון**:
לפי [[#מאפיינים דיפרנציאליים של פונקציות צורה|משוואות]] $\text{(3.32)}$
$$\begin{aligned}
{K}^{e}_{ij} & =\int_{{x}_{e}}^{{x}_{e+1}} \dfrac{\mathrm{d}\phi^{e}_{i}}{\mathrm{d}x} EA \dfrac{\mathrm{d}\phi^{e}_{j}}{\mathrm{d}x} \, \mathrm{d}x  \\[1ex]
 & =\int_{-1}^{1} \dfrac{1}{J^{e}}{B}_{i}EA \dfrac{1}{J^{e}}{B}_{j} \lvert J^{e} \rvert \, \mathrm{d}\zeta \\[1ex]
 & =\int_{-1}^{1} \dfrac{2}{h^{e}}{B}_{i}EA \dfrac{2}{h^{e}}{B}_{j} \dfrac{h^{e}}{2} \, \mathrm{d}\zeta  
\end{aligned}$$
ולכן:
$$\boxed{K^{e}_{ij}=\dfrac{2}{h^{e}}\int_{-1}^{1} {B}_{i}EA{B}_{j} \, \mathrm{d}\zeta  }$$

מטריצת המסה:
$$\begin{aligned}
M^{e}_{ij} & =\int_{{x}_{e}}^{{x}_{e+1}} \phi^{e}_{i}\phi^{e}_{j} \, \mathrm{d}x  \\[1ex]
 & =\int_{-1}^{1} \phi^{e}_{i}\phi^{e}_{j}\lvert J^{e} \rvert  \, \mathrm{d}\zeta \\[1ex]
 & =\int_{-1}^{1} \phi^{e}_{i}\phi^{e}_{j}  \dfrac{h^{e}}{2} \, \mathrm{d}\zeta  
\end{aligned}$$
לכן:
$$\boxed{M^{e}_{ij}= \dfrac{h^{e}}{2}\int_{-1}^{1} \phi^{e}_{i}\phi^{e}_{j} \, \mathrm{d}\zeta  }$$

נבחר לחלק ל-$2$ אלמנטים. זה אומר ש-$h^{e}=1$. לכן:
$$\begin{aligned}
K^{e}_{11} & =\dfrac{2}{h^{e}}\int_{-1}^{1} {B}_{1}(x^{e}(\zeta)+2){B}_{1} \, \mathrm{d}\zeta  \\[1ex]
 & =\dfrac{2}{1}\int_{-1}^{1} -\dfrac{1}{2}\left( \dfrac{1}{2}\zeta+ \dfrac{{x}_{e}+{x}_{e+1}}{2}+2 \right)\left( -\dfrac{1}{2} \right) \, \mathrm{d}\zeta \\[3ex]
K^{e}_{21} & =\dfrac{2}{h^{e}}\int_{-1}^{1} {B}_{1}(x^{e}(\zeta)+2){B}_{2} \, \mathrm{d}\zeta \\[1ex]
 & =\dfrac{2}{1}\int_{-1}^{1} -\dfrac{1}{2}\left( \dfrac{1}{2}\zeta+\dfrac{{x}_{e}+{x}_{e+1}}{2}+2 \right) \dfrac{1}{2} \, \mathrm{d}\zeta \\[3ex]
K^{e}_{22} & =\dfrac{2}{h^{e}}\int_{-1}^{1} {B}_{2}(x^{e}(\zeta)+2){B}_{2} \, \mathrm{d}\zeta \\[1ex]
 & =\dfrac{2}{1}\int_{-1}^{1}  \dfrac{1}{2}\left( \dfrac{1}{2}\zeta+\dfrac{{x}_{e}+{x}_{e+1}}{2}+2 \right) \dfrac{1}{2} \, \mathrm{d}\zeta   
\end{aligned}$$

על כל אחד מהם אנו יכולים לבצע [[#אינטגרציית גאוס]] עם נקודה אחת (האינטגרנד לינארי) עם $\zeta=0$ ו-$w=2$. נקבל:
$$\begin{aligned}
 & K^{e}_{11}=2\cdot \dfrac{1}{2}\left( \dfrac{{x}_{e}+{x}_{e+1}}{2}+2 \right) \\[1ex]
 & K^{e}_{21}=-2\cdot \dfrac{1}{2}\left( \dfrac{{x}_{e}+{x}_{e+1}}{2}+2 \right) \\[1ex]
 & K^{e}_{22}=2\cdot \dfrac{1}{2}\left( \dfrac{{x}_{e}+{x}_{e+1}}{2}+2 \right)
\end{aligned}$$
לכן המטריצות המקומיות (נציב $e=1,2$):
$$\boxed {
\begin{aligned}
 & \mathbf{K}^{1}= \dfrac{5}{2}\begin{pmatrix}
1 & -1 \\
-1 & 1
\end{pmatrix} \\[1ex]
 & \mathbf{K}^{2}=\dfrac{7}{2}\begin{pmatrix}
1 & -1 \\
-1 & 1
\end{pmatrix} \\[1ex]
 & \mathbf{M}^{e}=\dfrac{1}{6}\begin{pmatrix}
2 & 1 \\
1 & 2
\end{pmatrix}
\end{aligned}
 }$$

### סעיף ז'
פתחו ביטוי לקשיחות ה-*גלובלית* ומטריצת המסה ה-*גלובלית*.

**פתרון**:
חילקנו ל-$2$ אלמנטים, ולכן יש לנו $3$ פונקציות בסיס ${\phi}_{1},{\phi}_{2},{\phi}_{3}$ כפי שהצגנו ב[[#שאלה 1#סעיף ד'|סעיף ד']]. לפי ה[[#מאפיינים דיפרנציאליים של פונקציות צורה|דוגמה]], כאשר נשלב את המטריצות המקומיות לגלובליות נקבל (למטריצת המסה אנו מבצעים את אותם הפעולות כמו למטריצת הקשיחות):
$$\boxed {
\mathbf{K}=\begin{pmatrix}
2.5 & -2.5 & 0 \\
-2.5 & 6 & -3.5 \\
0 & -3.5 & 3.5
\end{pmatrix},\qquad \mathbf{M}= \begin{pmatrix}
1/3 & 1/6 & 0 \\
1/6 & 2/3 & 1/6 \\
0 & 1/6 & 1/3
\end{pmatrix}
 }$$
### סעיף ח'
מצאו את הקירוב לפתרון בשיטת אלמנטים סופיים.

**פתרון**
מבחינת וקטור הכוח, הוא פשוט $\mathbf{f}=\begin{pmatrix}1 & 1 & 1\end{pmatrix}^{T}$. מערכת המשוואות היא:
$$\begin{gathered}
\mathbf{K}\mathbf{a}=\mathbf{M}\mathbf{f} \\[1ex]

\end{gathered}$$
נתחיל לחשב:
$$\begin{gathered}
\begin{pmatrix}
2.5 & -2.5 & 0 \\
-2.5 & 6 & -3.5 \\
0 & -3.5 & 3.5
\end{pmatrix}\begin{pmatrix}
{a}_{1} \\
{a}_{2} \\
{a}_{3}
\end{pmatrix}= \begin{pmatrix}
1/3 & 1/6 & 0 \\
1/6 & 2/3 & 1/6 \\
0 & 1/6 & 1/3
\end{pmatrix}\begin{pmatrix}
1 \\
1 \\
1
\end{pmatrix} \\[3ex]
\begin{pmatrix}
2.5 & -2.5 & 0 \\
-2.5 & 6 & -3.5 \\
0 & -3.5 & 3.5
\end{pmatrix}\begin{pmatrix}
{a}_{1} \\
{a}_{2} \\
{a}_{3}
\end{pmatrix}=\begin{pmatrix}
1/2 \\
1 \\
1/2
\end{pmatrix}
\end{gathered}$$

כאן אנחנו כבר צריכים להיזהר ולזכור שיש לנו תנאי שפה מסוג דיריכלה ב- $x=0$. [[#קירוב אלמנט סופי|ניזכר]] שבחירת ה-${b}_{i}$-ים בקצוות לא שרירותית, כך שהמשוואות שפיתחנו עבורן לא תקיפות, ובכלל, לפי איך שאנו מקרבים את הפתרון $u^{h}$, צריך להתקיים:
$$\begin{aligned}
 & u^{h}(0)=0: &  & \sum_{j=1}^{3}{a}_{j}{\phi}_{j}(0)=0 \\[1ex]
 &  &  & {a}_{1}{\phi}_{1}(0)+{a}_{2}{\phi}_{2}(0)+{a}_{3}{\phi}_{3}(0)=0 \\[1ex]
 &  &  & {a}_{1}\cdot 1+{a}_{2}\cdot 0+{a}_{3}\cdot 0=0 \\[1ex]
 &  &  & {a}_{1}=0 
\end{aligned}$$
לפיכך, נישאר עם מערכת המשוואות המצומצמת:
$$\begin{pmatrix}
6 & -3.5 \\
-3.5 & 3.5
\end{pmatrix}\begin{pmatrix}
{a}_{2} \\
{a}_{3}
\end{pmatrix}=\begin{pmatrix}
1 \\
1/2
\end{pmatrix}$$
נקבל ש-:
$${a}_{1}=0,\qquad {a}_{2}=3/5,\qquad {a}_{3}=26/35$$
כעת אנו יודעים את הערכים של הפתרון בצמתים, ונוכל לבצע אינטרפולציה כדי לקבל את הפתרון המקורב. נשים לב שלפי [[#שאלה 1#סעיף ד'|סעיף ד']]:
$$\begin{aligned}
 & \phi^{e=1}_{1}(x)=1-x \\[1ex]
 & \phi^{e=1}_{2}(x)=x \\[1ex]
 & \phi^{e=2}_{1}(x)=2-x \\[1ex]
 & \phi^{e=2}_{2}(x)=x-1
\end{aligned}$$
ולכן הקירוב:
$$u^{h}=\begin{cases}
{a}_{1}\phi^{e=1}_{1}+{a}_{2}\phi^{e=1}_{2}  &  & 0<x<1 &  & \text{element 1} \\[1ex]
{a}_{2}\phi^{e=2}_{1}+{a}_{3}\phi^{e=2}_{2} &  & 1<x<2 &  & \text{element 2}
\end{cases}$$
נציב ערכים ונקבל:
$$\boxed{u^{h}=\begin{cases}
\dfrac{3}{5}x \\[1ex]
 \dfrac{3}{5}(2-x)+\dfrac{26}{35}(x-1)
\end{cases} }$$
![[fem-comparison.png|bookhue]]
>פתרון מדויק ופתרונות בשיטת אלמנטים סופיים עם מספר אלמנטים שונים.


## שאלה 2
הביטו בצלע קירור הבאה:
![[FEM1_003 מימוש אלמנט סופי בחד-ממד 2025-04-28 15.34.41.excalidraw.svg]]
>צלע קירור הנתונה להסעה ושטף חום.

### סעיף א'
רשמו את משוואות החום השולטות בצלע.

**פתרון**:
![[FEM1_003 מימוש אלמנט סופי בחד-ממד 2025-04-28 19.33.25.excalidraw.svg]]
>חתך דיפרנציאלי על הצלע.

בהנחה והשטף הנכנס הוא חיובי, שטף היציאה הוא שלילי. נרשום את מאזן החום:
$$\begin{gathered}
q(x)a^{2}-q(x+\mathrm{d}x)a^{2}-4a\,\mathrm{d}x\cdot h[T(x)-{T}_{\infty }]=0 \\[1ex]
\dfrac{-q(x+\mathrm{d}x)-q(x)}{\mathrm{d}x}-\dfrac{4h}{a}(T-{T}_{\infty })=0 \\[1ex]
\dfrac{\mathrm{d}q}{\mathrm{d}x}+\dfrac{4h}{a}T=\dfrac{4h}{a}{T}_{\infty }
\end{gathered}$$
לפי [[HTF1_001 מבוא#הולכה|חוק פורייה]], מתקיים $q=-k \dfrac{\mathrm{d}T}{\mathrm{d}x}$, ואז נוכל לרשום:
$$\boxed {
\dfrac{\mathrm{d}}{\mathrm{d}x}\left( -k \dfrac{\mathrm{d}T}{\mathrm{d}x} \right)+\dfrac{4h}{a}T=\dfrac{4h}{a}{T}_{\infty }
 }$$
מבחינת תנאי שפה, יש לנו שטף חום מצד שמאל:
$$\begin{aligned}
 & x=0: &  & -k \dfrac{\mathrm{d}T}{\mathrm{d}x}\bigg|_{0}^{} ={q}_{0}
\end{aligned}$$
מצד ימין יש גם שטף חום וגם הסעה:
$$\begin{aligned}
 & x=L: &  & q(L)-h[T(L)-{T}_{\infty }]=0
\end{aligned}$$
לפי פורייה בקצה, זה גם:
$$\begin{aligned}
 & x=L: &  & k \dfrac{\mathrm{d}T}{\mathrm{d}x}\bigg|_{L}^{} +h[T(L)-{T}_{\infty }]
\end{aligned}$$
ננרמל כי למה לא:
$$\begin{aligned}
 & \bar{x}=\dfrac{x}{L} &  & \theta=\dfrac{T-{T}_{\infty }}{{T}_{0}-{T}_{\infty }} \\[1ex]
 & \alpha =\dfrac{4hL^{2}}{ka} &  & \bar{q}=\dfrac{{q}_{0}L}{k({T}_{0}-{T}_{\infty })} \\[1ex]
 & \sigma=\dfrac{hL}{k}
\end{aligned}$$
נקבל את הבעיה הבאה:
$$\boxed {
\begin{aligned}
 & -\dfrac{\mathrm{d}^{2}\theta}{\mathrm{d}\bar{x}^{2}}+\alpha \theta=0 &  & 0<\bar{x}<1 \\[1ex]
 & -\dfrac{\mathrm{d}\theta}{\mathrm{d}\bar{x}}=\bar{q} &  & \bar{x}=0 \\[1ex]
 & \dfrac{\mathrm{d}\theta}{\mathrm{d}\bar{x}}+\sigma\theta=0 &  & \bar{x}=1
\end{aligned}
 }$$

### סעיף ב'
הגדירו את השאריות של המשוואה ושל תנאי השפה.

**פתרון**:
נניח שהפתרון המקורב הוא מהצורה $\theta^{h}={\phi}_{j}{a}_{j}$. השארית של המשוואה:
$$\begin{aligned}
r^{h} & :=-\dfrac{\mathrm{d}^{2}\theta^{h}}{\mathrm{d}\bar{x}^{2}}+\alpha \theta^{h} \\[1ex]
 & = \left( -\dfrac{\mathrm{d}^{2}{\phi}_{j}}{\mathrm{d}\bar{x}^{2}} +\alpha {\phi}_{j}\right){a}_{j}
\end{aligned}$$
השאריות של תנאי השפה:
$$\begin{aligned}
{r}_{{t}_{1}} & =-\dfrac{\mathrm{d}\theta^{h}}{\mathrm{d}\bar{x}}\bigg|_{0}^{} -\bar{q} \\[1ex]
 & =-\dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}\bar{x}}{a}_{j}\bigg|_{0}^{} -\bar{q} \\[3ex]
{r}_{{t}_{2}} & =\left( \dfrac{\mathrm{d}\theta^{h}}{\mathrm{d}\bar{x}}+\sigma\theta^{h} \right)\bigg|_{1}^{}  \\[1ex]
 & =\left( \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}\bar{x}}+\sigma {\phi}_{j} \right){a}_{j}\bigg|_{1}^{} 
\end{aligned}$$
### סעיף ג'
הפעילו את שיטת גלרקין ומצאו את הנוסח החלש.

**פתרון**:
מעכשיו נרשום $x$ במקום $\bar{x}$ כי זה מייגע ומבלבל.

לפי [[FEM1_001 מבוא ומידול בעיה חד ממדית#שיטת גלרקין|שיטת גלרקין]]:
$$\begin{aligned}
 & \int_{0}^{1} {\phi}_{i}r^{h} \, \mathrm{d}{x}+{\phi}_{i}(0) {r}_{{t}_{1}}+{\phi}_{i}(1){r}_{{t}_{2}} \\[1ex]
 & \qquad \int_{0}^{1} {\phi}_{i}\left( -\dfrac{\mathrm{d}^{2}{\phi}_{j}}{\mathrm{d}x^{2}} +\alpha {\phi}_{j}\right) \, \mathrm{d}x \cdot {a}_{j}-{\phi}_{i}\left( \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x}{a}_{j}+\bar{q} \right)\bigg|_{0}^{} \\[1ex]
 & \qquad  +{\phi}_{i}\left( \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x}+\sigma {\phi}_{j} \right){a}_{j}\bigg|_{1}^{} =0
\end{aligned}$$
לאחר אינטגרציה בחלקים נקבל את הנוסח החלש (וחלק מהאיברים יצטמצמו):
$$\boxed {
\left( \int_{0}^{1} \dfrac{\mathrm{d}{\phi}_{i}}{\mathrm{d}x} \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x} \, \mathrm{d}x +\alpha \int_{0}^{1} {\phi}_{i}{\phi}_{j} \, \mathrm{d}x +\sigma {\phi}_{i}(1){\phi}_{j}(1) \right){a}_{j}={\phi}_{i}(0)\bar{q}
 }$$
ניתן לרשום את ביטוי זה באופן מטריצה הבא:
$$(K^{k}_{ij}+K^{\alpha }_{ij}+\bar{K}_{ij}){a}_{j}=\bar{F}_{i}$$
כאשר:
$$\begin{aligned}
 & K^{k}_{ij}=\int_{0}^{1}  \dfrac{\mathrm{d}{\phi}_{i}}{\mathrm{d}x} \dfrac{\mathrm{d}{\phi}_{j}}{\mathrm{d}x} \, \mathrm{d}x  \\[1ex]
 & K^{\alpha }_{ij}=\alpha \int_{0}^{1} {\phi}_{i}{\phi}_{j} \, \mathrm{d}x  \\[1ex]
 & \bar{K}_{ij}=\sigma {\phi}_{i}(1){\phi}_{j}(1) \\[1ex]
 & \bar{F}_{i}={\phi}_{i}(0)\bar{q}
\end{aligned}$$

### סעיף ד'
מצאו ביטויים כלליים לאברי המטריצות והוקטורים המקומיים.

**פתרון**:
נבחר פונקציות בסיס לינאריות מקומיות:
$${\hat{\phi}}_{1}(\zeta)=\dfrac{1}{2}(1-\zeta),\qquad {\hat{\phi}}_{2}(\zeta)=\dfrac{1}{2}(1+\zeta)$$
נסמן:
$${B}_{i}=\dfrac{\mathrm{d}{\hat{\phi}}_{i}}{\mathrm{d}\zeta}$$
לפי [[#טרנספורמציה גלובלית/מקומית|משוואה]] $\text{(3.26)}$:
$$\begin{aligned}
 (K^{k}_{ij})^{e}  & =\int_{{x}_{e}}^{{x}_{e+1}}  \dfrac{\mathrm{d}\phi^{e}_{i}}{\mathrm{d}x} \dfrac{\mathrm{d}\phi^{e}_{j}}{\mathrm{d}x} \, \mathrm{d}x  \\[1ex]
   & =\int_{-1}^{1} \dfrac{1}{J^{e}}{B}_{i} \dfrac{1}{J^{e}}{B}_{j} J^{e} \, \mathrm{d}\zeta \\[1ex]
  & =\int_{-1}^{1} \dfrac{2}{h^{e}}{B}_{i} \dfrac{2}{h^{e}} \dfrac{h^{e}}{2} \, \mathrm{d}\zeta \\[1ex]
  & =\dfrac{2}{h^{e}}\int_{-1}^{1} {B}_{i}{B}_{j} \, \mathrm{d}\zeta  \\[1ex]
  & =\dfrac{1}{h^{e}}\begin{pmatrix}
1 & -1 \\
-1 & 1
\end{pmatrix} 
\end{aligned}$$
בנוסף:
$$\begin{aligned}
(K^{\alpha }_{ij})^{e} & =\alpha \int_{{x}_{e}}^{{x}_{e+1}} {\phi}_{i}{\phi}_{j}  \, \mathrm{d}x  \\[1ex]
 & =\alpha \int_{-1}^{1} {\phi}_{i}{\phi}_{j}\lvert J^{e} \rvert  \, \mathrm{d}\zeta \\[1ex]
 & =\alpha \int_{-1}^{1} {\phi}_{i}{\phi}_{j} \dfrac{h^{e}}{2} \, \mathrm{d}\zeta \\[1ex]
 & = \dfrac{h^{e}a}{4}\begin{pmatrix}
1 & 1 \\
1 & 1
\end{pmatrix}
\end{aligned}$$
לגבי $\bar{K}_{ij}$, וגם $\bar{F}_{i}$, לא צריך לפרק לאלמנטים:
$$\bar{\mathbf{K}}=\sigma \begin{pmatrix}
0 & \cdots  & 0 \\
\vdots  & \ddots  & \vdots  \\
0 & \cdots  & 1
\end{pmatrix},\qquad \bar{\mathbf{F}}=\bar{q}\begin{pmatrix}
1 \\
\vdots  \\
0
\end{pmatrix}$$
### סעיף ה'
פתרו את הבעיה עבור שני אלמנטים.

**פתרון**:
עבור שני אלמנטים מתקיים $h^{e}=1/2$. נקבל:
$$\left[ 2\begin{pmatrix}
1 & -1 & 0 \\
-1 & 2 & -1 \\
0 & -1 & 1
\end{pmatrix}+\dfrac{\alpha}{8}\begin{pmatrix}
1 & 1 & 0 \\
1 & 2 & 1 \\
0 & 1 & 1
\end{pmatrix} +\sigma \begin{pmatrix}
0 & 0 & 0 \\
0 & 0 & 0 \\
0 & 0 & 1
\end{pmatrix}\right]\begin{pmatrix}
{a}_{1} \\
{a}_{2} \\
{a}_{3}
\end{pmatrix}=\bar{q}\begin{pmatrix}
1 \\
0 \\
0
\end{pmatrix}$$

בהנחה ו- $\alpha=1,\,\sigma=0.05,\,\bar{q}=0.05$:
$$\mathbf{a}=\begin{pmatrix}
0.0633 \\
0.0451 \\
0.0388
\end{pmatrix}$$

![[fin-comparison.png|bookhue]]
>פתרון מדויק ופתרונות בשיטת אלמנטים סופיים עם מספר אלמנטים שונים.